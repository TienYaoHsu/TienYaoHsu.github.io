
[{"content":"","date":"28 February 2025","externalUrl":null,"permalink":"/tags/c++/","section":"Tags","summary":"","title":"C++","type":"tags"},{"content":"","date":"28 February 2025","externalUrl":null,"permalink":"/categories/","section":"Categories","summary":"","title":"Categories","type":"categories"},{"content":"","date":"28 February 2025","externalUrl":null,"permalink":"/posts/","section":"Posts","summary":"","title":"Posts","type":"posts"},{"content":"","date":"28 February 2025","externalUrl":null,"permalink":"/tags/ros/","section":"Tags","summary":"","title":"ROS","type":"tags"},{"content":"","date":"28 February 2025","externalUrl":null,"permalink":"/categories/ros/","section":"Categories","summary":"","title":"ROS","type":"categories"},{"content":"","date":"28 February 2025","externalUrl":null,"permalink":"/tags/","section":"Tags","summary":"","title":"Tags","type":"tags"},{"content":"","date":"28 February 2025","externalUrl":null,"permalink":"/","section":"TienYao@Tech","summary":"","title":"TienYao@Tech","type":"page"},{"content":"\r💻 ROS C++ 程式設計風格指南 #\r前言 #\r在 ROS2 開發中，良好的程式設計風格不僅能提高代碼的可讀性和可維護性，還能避免一些常見的錯誤和性能問題。本文將介紹 ROS2 中 C++ 程式設計的風格指南和最佳實踐，特別是關於節點創建的不同方式及其優缺點。\nROS2 節點創建的兩種方式 #\r在 ROS2 中，創建節點有兩種主要的方式：實例化節點對象和繼承節點類。讓我們來看看這兩種方式的具體實現和比較。\n1. 實例化節點對象 #\r這是最簡單直接的方式，直接創建一個 rclcpp::Node 的實例：\n#include \u0026#34;rclcpp/rclcpp.hpp\u0026#34; int main(int argc, char ** argv) { rclcpp::init(argc, argv); auto node = rclcpp::Node::make_shared(\u0026#34;helloworld_node\u0026#34;); RCLCPP_INFO(node-\u0026gt;get_logger(), \u0026#34;hello world!\u0026#34;); rclcpp::shutdown(); return 0; } 這種方式簡單明了，適合快速開發和簡單的應用場景。\n2. 繼承節點類 #\r這種方式通過創建一個繼承自 rclcpp::Node 的自定義類來實現：\n#include \u0026#34;rclcpp/rclcpp.hpp\u0026#34; class MyNode: public rclcpp::Node{ public: MyNode():Node(\u0026#34;node_name\u0026#34;){ RCLCPP_INFO(this-\u0026gt;get_logger(), \u0026#34;hello world!\u0026#34;); } }; int main(int argc, char *argv[]) { rclcpp::init(argc,argv); auto node = std::make_shared\u0026lt;MyNode\u0026gt;(); rclcpp::shutdown(); return 0; } 這種方式更加面向對象，適合複雜的應用場景和大型項目。\n兩種方式的比較 #\r實例化節點對象的優缺點 #\r優點：\n簡單直接，代碼量少 適合快速原型開發和簡單應用 學習曲線較低，適合初學者 缺點：\n不適合複雜功能的實現 代碼可能變得雜亂，難以維護 不符合 ROS2 的推薦風格 繼承節點類的優缺點 #\r優點：\n更加面向對象，符合 ROS2 的設計理念 更好的代碼組織和封裝 適合複雜功能和大型項目 更容易擴展和維護 這是 ROS2 官方推薦的方式 缺點：\n代碼量稍多 對初學者來說可能有一定的學習曲線 最佳實踐建議 #\r在 ROS2 中，更推薦使用繼承 Node 的方式來創建節點對象。這種方式雖然初看起來代碼量稍多，但它提供了更好的代碼組織和封裝，使得代碼更容易維護和擴展。\n以下是一些使用繼承方式的最佳實踐：\n明確的類結構：將節點的功能清晰地組織在類的成員函數和變量中 適當的封裝：使用 private 和 protected 成員來控制訪問權限 初始化列表：在構造函數中使用初始化列表來初始化基類 資源管理：使用智能指針管理資源，避免內存泄漏 範例：完整的繼承式節點 #\r下面是一個更完整的繼承式節點範例，包含了發布者、訂閱者和定時器：\n#include \u0026#34;rclcpp/rclcpp.hpp\u0026#34; #include \u0026#34;std_msgs/msg/string.hpp\u0026#34; class CompleteNode : public rclcpp::Node { private: rclcpp::Publisher\u0026lt;std_msgs::msg::String\u0026gt;::SharedPtr publisher_; rclcpp::Subscription\u0026lt;std_msgs::msg::String\u0026gt;::SharedPtr subscription_; rclcpp::TimerBase::SharedPtr timer_; size_t count_; public: CompleteNode() : Node(\u0026#34;complete_node\u0026#34;), count_(0) { // 創建發布者 publisher_ = this-\u0026gt;create_publisher\u0026lt;std_msgs::msg::String\u0026gt;(\u0026#34;topic\u0026#34;, 10); // 創建訂閱者 subscription_ = this-\u0026gt;create_subscription\u0026lt;std_msgs::msg::String\u0026gt;( \u0026#34;topic\u0026#34;, 10, [this](const std_msgs::msg::String::SharedPtr msg) { RCLCPP_INFO(this-\u0026gt;get_logger(), \u0026#34;Received: \u0026#39;%s\u0026#39;\u0026#34;, msg-\u0026gt;data.c_str()); }); // 創建定時器 timer_ = this-\u0026gt;create_wall_timer( std::chrono::seconds(1), [this]() { auto message = std_msgs::msg::String(); message.data = \u0026#34;Hello World: \u0026#34; + std::to_string(count_++); RCLCPP_INFO(this-\u0026gt;get_logger(), \u0026#34;Publishing: \u0026#39;%s\u0026#39;\u0026#34;, message.data.c_str()); publisher_-\u0026gt;publish(message); }); } }; int main(int argc, char * argv[]) { rclcpp::init(argc, argv); auto node = std::make_shared\u0026lt;CompleteNode\u0026gt;(); rclcpp::spin(node); rclcpp::shutdown(); return 0; } 結論 #\r在 ROS2 C++ 開發中，雖然實例化節點對象的方式簡單直接，但繼承節點類的方式更符合 ROS2 的設計理念和最佳實踐。對於任何超出簡單示例的實際應用，都建議使用繼承的方式來創建節點。這種方式提供了更好的代碼組織、封裝和可維護性，使得代碼更加健壯和易於擴展。\n隨著項目的複雜度增加，繼承方式的優勢會變得更加明顯。因此，即使對於初學者，也建議從一開始就養成使用繼承方式創建節點的習慣，這將有助於更好地理解和應用 ROS2 的設計理念。\n","date":"28 February 2025","externalUrl":null,"permalink":"/posts/ros_cpp_style_guide/","section":"Posts","summary":"\u003ch1 class=\"relative group\"\u003e💻 ROS C++ 程式設計風格指南 \r\n    \u003cdiv id=\"-ros-c-%E7%A8%8B%E5%BC%8F%E8%A8%AD%E8%A8%88%E9%A2%A8%E6%A0%BC%E6%8C%87%E5%8D%97\" class=\"anchor\"\u003e\u003c/div\u003e\r\n    \r\n    \u003cspan\r\n        class=\"absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100\"\u003e\r\n        \u003ca class=\"group-hover:text-primary-300 dark:group-hover:text-neutral-700\"\r\n            style=\"text-decoration-line: none !important;\" href=\"#-ros-c-%E7%A8%8B%E5%BC%8F%E8%A8%AD%E8%A8%88%E9%A2%A8%E6%A0%BC%E6%8C%87%E5%8D%97\" aria-label=\"Anchor\"\u003e#\u003c/a\u003e\r\n    \u003c/span\u003e        \r\n    \r\n\u003c/h1\u003e\r\n\r\n\r\n\u003ch2 class=\"relative group\"\u003e前言 \r\n    \u003cdiv id=\"%E5%89%8D%E8%A8%80\" class=\"anchor\"\u003e\u003c/div\u003e\r\n    \r\n    \u003cspan\r\n        class=\"absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100\"\u003e\r\n        \u003ca class=\"group-hover:text-primary-300 dark:group-hover:text-neutral-700\"\r\n            style=\"text-decoration-line: none !important;\" href=\"#%E5%89%8D%E8%A8%80\" aria-label=\"Anchor\"\u003e#\u003c/a\u003e\r\n    \u003c/span\u003e        \r\n    \r\n\u003c/h2\u003e\r\n\u003cp\u003e在 ROS2 開發中，良好的程式設計風格不僅能提高代碼的可讀性和可維護性，還能避免一些常見的錯誤和性能問題。本文將介紹 ROS2 中 C++ 程式設計的風格指南和最佳實踐，特別是關於節點創建的不同方式及其優缺點。\u003c/p\u003e","title":"🤖 ROS C++ 程式設計風格指南","type":"posts"},{"content":"\r🎯 C/C++ 指標完全指南：20個致命錯誤與解決方案 #\r1. 空指標解引用 #\r1.1 問題描述 #\r// ❌ 錯誤示範 int* p = NULL; *p = 1; // 程式崩潰 printf(\u0026#34;%d\u0026#34;, *p); // 非法記憶體存取 1.2 正確做法 #\rint* p = NULL; if (p != NULL) { *p = 1; printf(\u0026#34;%d\u0026#34;, *p); } 1.3 進階解決方案 #\r// 使用智慧指標 std::unique_ptr\u0026lt;int\u0026gt; p = std::make_unique\u0026lt;int\u0026gt;(1); if (p) { std::cout \u0026lt;\u0026lt; *p; } 2. 野指標使用 #\r2.1 問題描述 #\r// ❌ 錯誤示範 int* p; // 未初始化 printf(\u0026#34;%d\u0026#34;, *p); // 存取未知記憶體位置 2.2 正確做法 #\rint* p = nullptr; // C++11 建議使用 nullptr // 或 int value = 42; int* p = \u0026amp;value; // 指向有效變數 2.3 最佳實踐 #\rclass SafePointer { private: int* ptr; public: SafePointer() : ptr(nullptr) {} explicit SafePointer(int value) : ptr(new int(value)) {} ~SafePointer() { delete ptr; } bool isValid() const { return ptr != nullptr; } int getValue() const { if (!isValid()) throw std::runtime_error(\u0026#34;Null pointer\u0026#34;); return *ptr; } }; 3. 記憶體洩漏 #\r3.1 問題描述 #\r// ❌ 錯誤示範 void memoryLeak() { int* p = new int(42); // 忘記 delete } // 記憶體洩漏 3.2 正確做法 #\rvoid noLeak() { int* p = new int(42); // 使用 p delete p; p = nullptr; } 3.3 現代解決方案 #\rvoid modernWay() { // 使用智慧指標 std::unique_ptr\u0026lt;int\u0026gt; p = std::make_unique\u0026lt;int\u0026gt;(42); // 自動管理記憶體 } 4. 重複釋放 #\r4.1 問題描述 #\r// ❌ 錯誤示範 int* p = new int(42); delete p; delete p; // 重複釋放，未定義行為 4.2 正確做法 #\rint* p = new int(42); delete p; p = nullptr; // 設為 nullptr 避免重複釋放 4.3 智慧指標解決方案 #\rstd::shared_ptr\u0026lt;int\u0026gt; p = std::make_shared\u0026lt;int\u0026gt;(42); // 自動處理釋放，不需要手動管理 5. 指標越界 #\r5.1 陣列越界問題 #\r// ❌ 錯誤示範 int arr[5] = {1, 2, 3, 4, 5}; int* p = arr; p[5] = 6; // 越界寫入 printf(\u0026#34;%d\u0026#34;, p[10]); // 越界讀取 5.2 正確做法 #\r// 使用 STL 容器 std::vector\u0026lt;int\u0026gt; arr = {1, 2, 3, 4, 5}; if (arr.size() \u0026gt; 5) { arr[5] = 6; } // 或使用範圍檢查 template\u0026lt;size_t N\u0026gt; class SafeArray { int data[N]; public: int\u0026amp; operator[](size_t i) { if (i \u0026gt;= N) throw std::out_of_range(\u0026#34;Index out of bounds\u0026#34;); return data[i]; } }; 6. 懸掛指標 #\r6.1 問題描述 #\r// ❌ 錯誤示範 int* getDangling() { int local = 42; return \u0026amp;local; // 回傳區域變數位址 } // 或 int* p = new int(42); int* q = p; delete p; // p 被釋放 *q = 100; // q 成為懸掛指標 6.2 正確做法 #\r// 使用智慧指標 std::shared_ptr\u0026lt;int\u0026gt; getNumber() { return std::make_shared\u0026lt;int\u0026gt;(42); } // 或 std::shared_ptr\u0026lt;int\u0026gt; p = std::make_shared\u0026lt;int\u0026gt;(42); std::shared_ptr\u0026lt;int\u0026gt; q = p; // 共享所有權 7. 指標型別不匹配 #\r7.1 問題描述 #\r// ❌ 錯誤示範 int* intPtr = new int(42); char* charPtr = (char*)intPtr; // 危險的型別轉換 7.2 正確做法 #\r// 使用 static_cast 或 reinterpret_cast int* intPtr = new int(42); // 只在確實需要時使用 char* charPtr = reinterpret_cast\u0026lt;char*\u0026gt;(intPtr); // 更好的做法是避免型別轉換 template\u0026lt;typename T\u0026gt; class TypeSafePtr { T* ptr; public: explicit TypeSafePtr(T* p) : ptr(p) {} T\u0026amp; operator*() { return *ptr; } }; 8. 字串指標錯誤 #\r8.1 問題描述 #\r// ❌ 錯誤示範 char* str = \u0026#34;Hello\u0026#34;; // 字串常量不可修改 str[0] = \u0026#39;h\u0026#39;; // 未定義行為 // 或 char* str = new char[6]; strcpy(str, \u0026#34;Hello\u0026#34;); // 忘記釋放記憶體 8.2 正確做法 #\r// 使用字串陣列 char str[] = \u0026#34;Hello\u0026#34;; // 可修改的拷貝 // 或使用 string std::string str = \u0026#34;Hello\u0026#34;; str[0] = \u0026#39;h\u0026#39;; // 安全的修改 // 或使用智慧指標 std::unique_ptr\u0026lt;char[]\u0026gt; str(new char[6]); strcpy(str.get(), \u0026#34;Hello\u0026#34;); 9. 函式指標錯誤 #\r9.1 問題描述 #\r// ❌ 錯誤示範 void (*fp)(); fp(); // 呼叫未初始化的函式指標 9.2 正確做法 #\rvoid func() { std::cout \u0026lt;\u0026lt; \u0026#34;Hello\u0026#34;; } // 基本用法 void (*fp)() = func; if (fp) fp(); // 現代寫法 std::function\u0026lt;void()\u0026gt; fp = func; if (fp) fp(); // 或使用 std::bind auto fp = std::bind(\u0026amp;MyClass::method, \u0026amp;obj); 10. 多執行緒指標問題 #\r10.1 問題描述 #\r// ❌ 錯誤示範 class SharedResource { int* data; public: void update(int value) { *data = value; // 沒有同步機制 } }; 10.2 正確做法 #\rclass ThreadSafeResource { std::shared_ptr\u0026lt;int\u0026gt; data; mutable std::mutex mutex; public: void update(int value) { std::lock_guard\u0026lt;std::mutex\u0026gt; lock(mutex); if (data) *data = value; } int getValue() const { std::lock_guard\u0026lt;std::mutex\u0026gt; lock(mutex); return data ? *data : 0; } }; 11. 循環參考問題 #\r11.1 問題描述 #\r// ❌ 錯誤示範 struct Node { std::shared_ptr\u0026lt;Node\u0026gt; next; std::shared_ptr\u0026lt;Node\u0026gt; prev; }; void createNodes() { auto node1 = std::make_shared\u0026lt;Node\u0026gt;(); auto node2 = std::make_shared\u0026lt;Node\u0026gt;(); node1-\u0026gt;next = node2; node2-\u0026gt;prev = node1; // 造成循環參考 } 11.2 正確做法 #\rstruct Node { std::shared_ptr\u0026lt;Node\u0026gt; next; std::weak_ptr\u0026lt;Node\u0026gt; prev; // 使用 weak_ptr }; void createNodes() { auto node1 = std::make_shared\u0026lt;Node\u0026gt;(); auto node2 = std::make_shared\u0026lt;Node\u0026gt;(); node1-\u0026gt;next = node2; node2-\u0026gt;prev = node1; // 不會造成循環參考 } 12. 智慧指標誤用 #\r12.1 問題描述 #\r// ❌ 錯誤示範 void processData(std::unique_ptr\u0026lt;Data\u0026gt; data) { std::unique_ptr\u0026lt;Data\u0026gt; copy = data; // 編譯錯誤：unique_ptr 不能複製 } // 或 std::shared_ptr\u0026lt;int\u0026gt; ptr(new int[10]); // 錯誤：使用錯誤的刪除器 12.2 正確做法 #\r// 傳遞 unique_ptr void processData(std::unique_ptr\u0026lt;Data\u0026gt;\u0026amp;\u0026amp; data) { // 使用 std::move std::unique_ptr\u0026lt;Data\u0026gt; local = std::move(data); } // 正確管理陣列 std::shared_ptr\u0026lt;int[]\u0026gt; ptr(new int[10]); // 或 auto ptr = std::make_unique\u0026lt;int[]\u0026gt;(10); 13. 指標與繼承 #\r13.1 問題描述 #\r// ❌ 錯誤示範 class Base { public: virtual ~Base() = default; }; class Derived : public Base { int* data; public: Derived() : data(new int(42)) {} // 忘記實作解構子，造成記憶體洩漏 }; 13.2 正確做法 #\rclass Base { public: virtual ~Base() = default; }; class Derived : public Base { std::unique_ptr\u0026lt;int\u0026gt; data; public: Derived() : data(std::make_unique\u0026lt;int\u0026gt;(42)) {} // 不需要手動實作解構子 }; 14. 容器指標問題 #\r14.1 問題描述 #\r// ❌ 錯誤示範 std::vector\u0026lt;int*\u0026gt; vec; for (int i = 0; i \u0026lt; 5; ++i) { vec.push_back(new int(i)); // 手動管理記憶體 } // 忘記清理 14.2 正確做法 #\r// 使用智慧指標容器 std::vector\u0026lt;std::unique_ptr\u0026lt;int\u0026gt;\u0026gt; vec; for (int i = 0; i \u0026lt; 5; ++i) { vec.push_back(std::make_unique\u0026lt;int\u0026gt;(i)); } // 自動清理 // 或更好的做法 std::vector\u0026lt;int\u0026gt; vec; for (int i = 0; i \u0026lt; 5; ++i) { vec.push_back(i); } 15. 指標與例外處理 #\r15.1 問題描述 #\r// ❌ 錯誤示範 void riskyFunction() { int* p = new int(42); // 可能拋出例外 functionThatMightThrow(); delete p; // 如果發生例外，這行不會執行 } 15.2 正確做法 #\r// 使用 RAII void safeFunction() { std::unique_ptr\u0026lt;int\u0026gt; p = std::make_unique\u0026lt;int\u0026gt;(42); functionThatMightThrow(); // 即使拋出例外，p 也會被正確釋放 } // 或使用智慧資源管理 class ResourceGuard { FILE* file; public: ResourceGuard(const char* filename) { file = fopen(filename, \u0026#34;r\u0026#34;); if (!file) throw std::runtime_error(\u0026#34;Failed to open file\u0026#34;); } ~ResourceGuard() { if (file) fclose(file); } }; 16. 指標與 STL 容器 #\r16.1 問題描述 #\r// ❌ 錯誤示範 std::vector\u0026lt;int\u0026gt; vec = {1, 2, 3}; int* p = \u0026amp;vec[0]; vec.push_back(4); // 可能導致重新配置，p 變成懸掛指標 16.2 正確做法 #\rstd::vector\u0026lt;int\u0026gt; vec = {1, 2, 3}; // 使用迭代器 auto it = vec.begin(); // 或使用參考 int\u0026amp; ref = vec[0]; // 如果需要保持指標 vec.reserve(4); // 預先配置空間 int* p = \u0026amp;vec[0]; vec.push_back(4); // 不會重新配置 17. 自訂刪除器 #\r17.1 問題描述 #\r// ❌ 錯誤示範 struct CustomResource { void* data; CustomResource() : data(specialAlloc()) {} ~CustomResource() { free(data); // 使用錯誤的釋放函式 } }; 17.2 正確做法 #\r// 自訂刪除器 struct CustomDeleter { void operator()(void* p) const { specialFree(p); // 使用正確的釋放函式 } }; using CustomPtr = std::unique_ptr\u0026lt;void, CustomDeleter\u0026gt;; struct CustomResource { CustomPtr data; CustomResource() : data(specialAlloc(), CustomDeleter()) {} // 不需要解構子 }; 18. 指標與型別轉換 #\r18.1 問題描述 #\r// ❌ 錯誤示範 class Base {}; class Derived : public Base {}; Base* bp = new Derived; Derived* dp = (Derived*)bp; // 危險的 C 風格轉換 18.2 正確做法 #\r// 使用 C++ 風格轉換 Base* bp = new Derived; if (Derived* dp = dynamic_cast\u0026lt;Derived*\u0026gt;(bp)) { // 安全的轉換 } // 使用智慧指標 std::shared_ptr\u0026lt;Base\u0026gt; bp = std::make_shared\u0026lt;Derived\u0026gt;(); if (auto dp = std::dynamic_pointer_cast\u0026lt;Derived\u0026gt;(bp)) { // 安全的轉換 } 19. 指標與常數 #\r19.1 問題描述 #\r// ❌ 錯誤示範 const int constant = 42; int* ptr = (int*)\u0026amp;constant; // 移除 const 限定 *ptr = 43; // 未定義行為 19.2 正確做法 #\r// 保持 const 正確性 const int constant = 42; const int* ptr = \u0026amp;constant; // *ptr = 43; // 編譯錯誤 // 使用 const 智慧指標 std::shared_ptr\u0026lt;const int\u0026gt; ptr = std::make_shared\u0026lt;const int\u0026gt;(42); 20. 指標與移動語意 #\r20.1 問題描述 #\r// ❌ 錯誤示範 class Resource { int* data; public: Resource(int value) : data(new int(value)) {} ~Resource() { delete data; } // 缺少移動建構子和賦值運算子 Resource(const Resource\u0026amp; other) : data(new int(*other.data)) {} Resource\u0026amp; operator=(const Resource\u0026amp; other) { if (this != \u0026amp;other) { delete data; data = new int(*other.data); } return *this; } }; 20.2 正確做法 #\rclass Resource { std::unique_ptr\u0026lt;int\u0026gt; data; public: Resource(int value) : data(std::make_unique\u0026lt;int\u0026gt;(value)) {} // 移動建構子 Resource(Resource\u0026amp;\u0026amp; other) noexcept = default; // 移動賦值運算子 Resource\u0026amp; operator=(Resource\u0026amp;\u0026amp; other) noexcept = default; // 禁用拷貝 Resource(const Resource\u0026amp;) = delete; Resource\u0026amp; operator=(const Resource\u0026amp;) = delete; }; 🎯 最佳實踐總結 #\r1. 初始化 #\r// ✅ 永遠初始化指標 int* ptr = nullptr; std::unique_ptr\u0026lt;int\u0026gt; smartPtr; 2. 智慧指標使用原則 #\r// ✅ 優先使用 unique_ptr std::unique_ptr\u0026lt;Resource\u0026gt; single_owner(); // ✅ 需要共享時使用 shared_ptr std::shared_ptr\u0026lt;Resource\u0026gt; shared_resource(); // ✅ 避免循環參考時使用 weak_ptr std::weak_ptr\u0026lt;Resource\u0026gt; weak_resource; 3. RAII 原則 #\rclass RAIIWrapper { std::unique_ptr\u0026lt;Resource\u0026gt; resource; public: RAIIWrapper() : resource(std::make_unique\u0026lt;Resource\u0026gt;()) {} // 自動管理資源生命週期 }; 4. 容器使用 #\r// ✅ 使用 STL 容器 std::vector\u0026lt;int\u0026gt; vec; // 而不是 int* arr = new int[size]; std::array\u0026lt;int, 5\u0026gt; arr; // 而不是 int arr[5]; std::string str; // 而不是 char* str; 5. 線程安全 #\rclass ThreadSafe { mutable std::mutex mutex; std::shared_ptr\u0026lt;Resource\u0026gt; resource; public: void access() { std::lock_guard\u0026lt;std::mutex\u0026gt; lock(mutex); if (resource) { resource-\u0026gt;use(); } } }; 📝 檢查清單 #\r✅ 所有指標使用前都已初始化 ✅ 使用智慧指標管理資源 ✅ 實作 RAII 原則 ✅ 避免原始指標的手動記憶體管理 ✅ 使用 STL 容器代替原始陣列 ✅ 正確處理多執行緒情況 ✅ 注意例外安全 ✅ 使用現代 C++ 特性 ✅ 適當使用 const ✅ 實作移動語意 🔧 除錯工具建議 #\rValgrind\n記憶體洩漏檢測 未初始化記憶體使用檢測 記憶體存取錯誤檢測 AddressSanitizer (ASAN)\n即時記憶體錯誤檢測 效能開銷較小 Visual Studio 除錯器\n記憶體檢視 斷點除錯 記憶體洩漏檢測 Static Analysis Tools\nClang Static Analyzer Cppcheck PVS-Studio 💡 提示：\n定期使用記憶體檢查工具 開啟編譯器警告 (-Wall -Wextra) 使用靜態分析工具 進行單元測試 保持程式碼簡潔 ","date":"27 February 2025","externalUrl":null,"permalink":"/posts/cpp_pointer_guide/","section":"Posts","summary":"\u003ch1 class=\"relative group\"\u003e🎯 C/C++ 指標完全指南：20個致命錯誤與解決方案 \r\n    \u003cdiv id=\"-cc-%E6%8C%87%E6%A8%99%E5%AE%8C%E5%85%A8%E6%8C%87%E5%8D%9720%E5%80%8B%E8%87%B4%E5%91%BD%E9%8C%AF%E8%AA%A4%E8%88%87%E8%A7%A3%E6%B1%BA%E6%96%B9%E6%A1%88\" class=\"anchor\"\u003e\u003c/div\u003e\r\n    \r\n    \u003cspan\r\n        class=\"absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100\"\u003e\r\n        \u003ca class=\"group-hover:text-primary-300 dark:group-hover:text-neutral-700\"\r\n            style=\"text-decoration-line: none !important;\" href=\"#-cc-%E6%8C%87%E6%A8%99%E5%AE%8C%E5%85%A8%E6%8C%87%E5%8D%9720%E5%80%8B%E8%87%B4%E5%91%BD%E9%8C%AF%E8%AA%A4%E8%88%87%E8%A7%A3%E6%B1%BA%E6%96%B9%E6%A1%88\" aria-label=\"Anchor\"\u003e#\u003c/a\u003e\r\n    \u003c/span\u003e        \r\n    \r\n\u003c/h1\u003e\r\n\r\n\r\n\u003ch2 class=\"relative group\"\u003e1. 空指標解引用 \r\n    \u003cdiv id=\"1-%E7%A9%BA%E6%8C%87%E6%A8%99%E8%A7%A3%E5%BC%95%E7%94%A8\" class=\"anchor\"\u003e\u003c/div\u003e\r\n    \r\n    \u003cspan\r\n        class=\"absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100\"\u003e\r\n        \u003ca class=\"group-hover:text-primary-300 dark:group-hover:text-neutral-700\"\r\n            style=\"text-decoration-line: none !important;\" href=\"#1-%E7%A9%BA%E6%8C%87%E6%A8%99%E8%A7%A3%E5%BC%95%E7%94%A8\" aria-label=\"Anchor\"\u003e#\u003c/a\u003e\r\n    \u003c/span\u003e        \r\n    \r\n\u003c/h2\u003e\r\n\r\n\r\n\u003ch3 class=\"relative group\"\u003e1.1 問題描述 \r\n    \u003cdiv id=\"11-%E5%95%8F%E9%A1%8C%E6%8F%8F%E8%BF%B0\" class=\"anchor\"\u003e\u003c/div\u003e\r\n    \r\n    \u003cspan\r\n        class=\"absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100\"\u003e\r\n        \u003ca class=\"group-hover:text-primary-300 dark:group-hover:text-neutral-700\"\r\n            style=\"text-decoration-line: none !important;\" href=\"#11-%E5%95%8F%E9%A1%8C%E6%8F%8F%E8%BF%B0\" aria-label=\"Anchor\"\u003e#\u003c/a\u003e\r\n    \u003c/span\u003e        \r\n    \r\n\u003c/h3\u003e\r\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-cpp\" data-lang=\"cpp\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// ❌ 錯誤示範\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"kt\"\u003eint\u003c/span\u003e\u003cspan class=\"o\"\u003e*\u003c/span\u003e \u003cspan class=\"n\"\u003ep\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nb\"\u003eNULL\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"o\"\u003e*\u003c/span\u003e\u003cspan class=\"n\"\u003ep\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e    \u003cspan class=\"c1\"\u003e// 程式崩潰\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"n\"\u003eprintf\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;%d\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"o\"\u003e*\u003c/span\u003e\u003cspan class=\"n\"\u003ep\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e  \u003cspan class=\"c1\"\u003e// 非法記憶體存取\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n\r\n\u003ch3 class=\"relative group\"\u003e1.2 正確做法 \r\n    \u003cdiv id=\"12-%E6%AD%A3%E7%A2%BA%E5%81%9A%E6%B3%95\" class=\"anchor\"\u003e\u003c/div\u003e\r\n    \r\n    \u003cspan\r\n        class=\"absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100\"\u003e\r\n        \u003ca class=\"group-hover:text-primary-300 dark:group-hover:text-neutral-700\"\r\n            style=\"text-decoration-line: none !important;\" href=\"#12-%E6%AD%A3%E7%A2%BA%E5%81%9A%E6%B3%95\" aria-label=\"Anchor\"\u003e#\u003c/a\u003e\r\n    \u003c/span\u003e        \r\n    \r\n\u003c/h3\u003e\r\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-cpp\" data-lang=\"cpp\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kt\"\u003eint\u003c/span\u003e\u003cspan class=\"o\"\u003e*\u003c/span\u003e \u003cspan class=\"n\"\u003ep\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"nb\"\u003eNULL\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ep\u003c/span\u003e \u003cspan class=\"o\"\u003e!=\u003c/span\u003e \u003cspan class=\"nb\"\u003eNULL\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"o\"\u003e*\u003c/span\u003e\u003cspan class=\"n\"\u003ep\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003eprintf\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;%d\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"o\"\u003e*\u003c/span\u003e\u003cspan class=\"n\"\u003ep\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n\r\n\u003ch3 class=\"relative group\"\u003e1.3 進階解決方案 \r\n    \u003cdiv id=\"13-%E9%80%B2%E9%9A%8E%E8%A7%A3%E6%B1%BA%E6%96%B9%E6%A1%88\" class=\"anchor\"\u003e\u003c/div\u003e\r\n    \r\n    \u003cspan\r\n        class=\"absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100\"\u003e\r\n        \u003ca class=\"group-hover:text-primary-300 dark:group-hover:text-neutral-700\"\r\n            style=\"text-decoration-line: none !important;\" href=\"#13-%E9%80%B2%E9%9A%8E%E8%A7%A3%E6%B1%BA%E6%96%B9%E6%A1%88\" aria-label=\"Anchor\"\u003e#\u003c/a\u003e\r\n    \u003c/span\u003e        \r\n    \r\n\u003c/h3\u003e\r\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-cpp\" data-lang=\"cpp\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// 使用智慧指標\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"n\"\u003estd\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"n\"\u003eunique_ptr\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"kt\"\u003eint\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003ep\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003estd\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"n\"\u003emake_unique\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"kt\"\u003eint\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026gt;\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ep\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003estd\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"n\"\u003ecout\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026lt;\u0026lt;\u003c/span\u003e \u003cspan class=\"o\"\u003e*\u003c/span\u003e\u003cspan class=\"n\"\u003ep\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n\r\n\u003ch2 class=\"relative group\"\u003e2. 野指標使用 \r\n    \u003cdiv id=\"2-%E9%87%8E%E6%8C%87%E6%A8%99%E4%BD%BF%E7%94%A8\" class=\"anchor\"\u003e\u003c/div\u003e\r\n    \r\n    \u003cspan\r\n        class=\"absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100\"\u003e\r\n        \u003ca class=\"group-hover:text-primary-300 dark:group-hover:text-neutral-700\"\r\n            style=\"text-decoration-line: none !important;\" href=\"#2-%E9%87%8E%E6%8C%87%E6%A8%99%E4%BD%BF%E7%94%A8\" aria-label=\"Anchor\"\u003e#\u003c/a\u003e\r\n    \u003c/span\u003e        \r\n    \r\n\u003c/h2\u003e\r\n\r\n\r\n\u003ch3 class=\"relative group\"\u003e2.1 問題描述 \r\n    \u003cdiv id=\"21-%E5%95%8F%E9%A1%8C%E6%8F%8F%E8%BF%B0\" class=\"anchor\"\u003e\u003c/div\u003e\r\n    \r\n    \u003cspan\r\n        class=\"absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100\"\u003e\r\n        \u003ca class=\"group-hover:text-primary-300 dark:group-hover:text-neutral-700\"\r\n            style=\"text-decoration-line: none !important;\" href=\"#21-%E5%95%8F%E9%A1%8C%E6%8F%8F%E8%BF%B0\" aria-label=\"Anchor\"\u003e#\u003c/a\u003e\r\n    \u003c/span\u003e        \r\n    \r\n\u003c/h3\u003e\r\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-cpp\" data-lang=\"cpp\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// ❌ 錯誤示範\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"kt\"\u003eint\u003c/span\u003e\u003cspan class=\"o\"\u003e*\u003c/span\u003e \u003cspan class=\"n\"\u003ep\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e           \u003cspan class=\"c1\"\u003e// 未初始化\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"n\"\u003eprintf\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;%d\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"o\"\u003e*\u003c/span\u003e\u003cspan class=\"n\"\u003ep\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e \u003cspan class=\"c1\"\u003e// 存取未知記憶體位置\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n\r\n\u003ch3 class=\"relative group\"\u003e2.2 正確做法 \r\n    \u003cdiv id=\"22-%E6%AD%A3%E7%A2%BA%E5%81%9A%E6%B3%95\" class=\"anchor\"\u003e\u003c/div\u003e\r\n    \r\n    \u003cspan\r\n        class=\"absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100\"\u003e\r\n        \u003ca class=\"group-hover:text-primary-300 dark:group-hover:text-neutral-700\"\r\n            style=\"text-decoration-line: none !important;\" href=\"#22-%E6%AD%A3%E7%A2%BA%E5%81%9A%E6%B3%95\" aria-label=\"Anchor\"\u003e#\u003c/a\u003e\r\n    \u003c/span\u003e        \r\n    \r\n\u003c/h3\u003e\r\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-cpp\" data-lang=\"cpp\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kt\"\u003eint\u003c/span\u003e\u003cspan class=\"o\"\u003e*\u003c/span\u003e \u003cspan class=\"n\"\u003ep\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enullptr\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"c1\"\u003e// C++11 建議使用 nullptr\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// 或\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"kt\"\u003eint\u003c/span\u003e \u003cspan class=\"n\"\u003evalue\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"mi\"\u003e42\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kt\"\u003eint\u003c/span\u003e\u003cspan class=\"o\"\u003e*\u003c/span\u003e \u003cspan class=\"n\"\u003ep\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026amp;\u003c/span\u003e\u003cspan class=\"n\"\u003evalue\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e  \u003cspan class=\"c1\"\u003e// 指向有效變數\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n\r\n\u003ch3 class=\"relative group\"\u003e2.3 最佳實踐 \r\n    \u003cdiv id=\"23-%E6%9C%80%E4%BD%B3%E5%AF%A6%E8%B8%90\" class=\"anchor\"\u003e\u003c/div\u003e\r\n    \r\n    \u003cspan\r\n        class=\"absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100\"\u003e\r\n        \u003ca class=\"group-hover:text-primary-300 dark:group-hover:text-neutral-700\"\r\n            style=\"text-decoration-line: none !important;\" href=\"#23-%E6%9C%80%E4%BD%B3%E5%AF%A6%E8%B8%90\" aria-label=\"Anchor\"\u003e#\u003c/a\u003e\r\n    \u003c/span\u003e        \r\n    \r\n\u003c/h3\u003e\r\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-cpp\" data-lang=\"cpp\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eSafePointer\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003eprivate\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"kt\"\u003eint\u003c/span\u003e\u003cspan class=\"o\"\u003e*\u003c/span\u003e \u003cspan class=\"n\"\u003eptr\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003epublic\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003eSafePointer\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eptr\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003enullptr\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003eexplicit\u003c/span\u003e \u003cspan class=\"nf\"\u003eSafePointer\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003eint\u003c/span\u003e \u003cspan class=\"n\"\u003evalue\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eptr\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"kt\"\u003eint\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003evalue\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e \u003cspan class=\"p\"\u003e{}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"o\"\u003e~\u003c/span\u003e\u003cspan class=\"n\"\u003eSafePointer\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"k\"\u003edelete\u003c/span\u003e \u003cspan class=\"n\"\u003eptr\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"kt\"\u003ebool\u003c/span\u003e \u003cspan class=\"nf\"\u003eisValid\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"k\"\u003econst\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"n\"\u003eptr\u003c/span\u003e \u003cspan class=\"o\"\u003e!=\u003c/span\u003e \u003cspan class=\"k\"\u003enullptr\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"kt\"\u003eint\u003c/span\u003e \u003cspan class=\"nf\"\u003egetValue\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"k\"\u003econst\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"o\"\u003e!\u003c/span\u003e\u003cspan class=\"n\"\u003eisValid\u003c/span\u003e\u003cspan class=\"p\"\u003e())\u003c/span\u003e \u003cspan class=\"k\"\u003ethrow\u003c/span\u003e \u003cspan class=\"n\"\u003estd\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"n\"\u003eruntime_error\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;Null pointer\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"o\"\u003e*\u003c/span\u003e\u003cspan class=\"n\"\u003eptr\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e};\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n\r\n\u003ch2 class=\"relative group\"\u003e3. 記憶體洩漏 \r\n    \u003cdiv id=\"3-%E8%A8%98%E6%86%B6%E9%AB%94%E6%B4%A9%E6%BC%8F\" class=\"anchor\"\u003e\u003c/div\u003e\r\n    \r\n    \u003cspan\r\n        class=\"absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100\"\u003e\r\n        \u003ca class=\"group-hover:text-primary-300 dark:group-hover:text-neutral-700\"\r\n            style=\"text-decoration-line: none !important;\" href=\"#3-%E8%A8%98%E6%86%B6%E9%AB%94%E6%B4%A9%E6%BC%8F\" aria-label=\"Anchor\"\u003e#\u003c/a\u003e\r\n    \u003c/span\u003e        \r\n    \r\n\u003c/h2\u003e\r\n\r\n\r\n\u003ch3 class=\"relative group\"\u003e3.1 問題描述 \r\n    \u003cdiv id=\"31-%E5%95%8F%E9%A1%8C%E6%8F%8F%E8%BF%B0\" class=\"anchor\"\u003e\u003c/div\u003e\r\n    \r\n    \u003cspan\r\n        class=\"absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100\"\u003e\r\n        \u003ca class=\"group-hover:text-primary-300 dark:group-hover:text-neutral-700\"\r\n            style=\"text-decoration-line: none !important;\" href=\"#31-%E5%95%8F%E9%A1%8C%E6%8F%8F%E8%BF%B0\" aria-label=\"Anchor\"\u003e#\u003c/a\u003e\r\n    \u003c/span\u003e        \r\n    \r\n\u003c/h3\u003e\r\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-cpp\" data-lang=\"cpp\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// ❌ 錯誤示範\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"kt\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003ememoryLeak\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"kt\"\u003eint\u003c/span\u003e\u003cspan class=\"o\"\u003e*\u003c/span\u003e \u003cspan class=\"n\"\u003ep\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"kt\"\u003eint\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"mi\"\u003e42\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"c1\"\u003e// 忘記 delete\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e  \u003cspan class=\"c1\"\u003e// 記憶體洩漏\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n\r\n\u003ch3 class=\"relative group\"\u003e3.2 正確做法 \r\n    \u003cdiv id=\"32-%E6%AD%A3%E7%A2%BA%E5%81%9A%E6%B3%95\" class=\"anchor\"\u003e\u003c/div\u003e\r\n    \r\n    \u003cspan\r\n        class=\"absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100\"\u003e\r\n        \u003ca class=\"group-hover:text-primary-300 dark:group-hover:text-neutral-700\"\r\n            style=\"text-decoration-line: none !important;\" href=\"#32-%E6%AD%A3%E7%A2%BA%E5%81%9A%E6%B3%95\" aria-label=\"Anchor\"\u003e#\u003c/a\u003e\r\n    \u003c/span\u003e        \r\n    \r\n\u003c/h3\u003e\r\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-cpp\" data-lang=\"cpp\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kt\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003enoLeak\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"kt\"\u003eint\u003c/span\u003e\u003cspan class=\"o\"\u003e*\u003c/span\u003e \u003cspan class=\"n\"\u003ep\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"kt\"\u003eint\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"mi\"\u003e42\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"c1\"\u003e// 使用 p\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e    \u003cspan class=\"k\"\u003edelete\u003c/span\u003e \u003cspan class=\"n\"\u003ep\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003ep\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enullptr\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n\r\n\u003ch3 class=\"relative group\"\u003e3.3 現代解決方案 \r\n    \u003cdiv id=\"33-%E7%8F%BE%E4%BB%A3%E8%A7%A3%E6%B1%BA%E6%96%B9%E6%A1%88\" class=\"anchor\"\u003e\u003c/div\u003e\r\n    \r\n    \u003cspan\r\n        class=\"absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100\"\u003e\r\n        \u003ca class=\"group-hover:text-primary-300 dark:group-hover:text-neutral-700\"\r\n            style=\"text-decoration-line: none !important;\" href=\"#33-%E7%8F%BE%E4%BB%A3%E8%A7%A3%E6%B1%BA%E6%96%B9%E6%A1%88\" aria-label=\"Anchor\"\u003e#\u003c/a\u003e\r\n    \u003c/span\u003e        \r\n    \r\n\u003c/h3\u003e\r\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-cpp\" data-lang=\"cpp\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kt\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003emodernWay\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"c1\"\u003e// 使用智慧指標\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e    \u003cspan class=\"n\"\u003estd\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"n\"\u003eunique_ptr\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"kt\"\u003eint\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003ep\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003estd\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"n\"\u003emake_unique\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"kt\"\u003eint\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026gt;\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"mi\"\u003e42\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"c1\"\u003e// 自動管理記憶體\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n\r\n\u003ch2 class=\"relative group\"\u003e4. 重複釋放 \r\n    \u003cdiv id=\"4-%E9%87%8D%E8%A4%87%E9%87%8B%E6%94%BE\" class=\"anchor\"\u003e\u003c/div\u003e\r\n    \r\n    \u003cspan\r\n        class=\"absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100\"\u003e\r\n        \u003ca class=\"group-hover:text-primary-300 dark:group-hover:text-neutral-700\"\r\n            style=\"text-decoration-line: none !important;\" href=\"#4-%E9%87%8D%E8%A4%87%E9%87%8B%E6%94%BE\" aria-label=\"Anchor\"\u003e#\u003c/a\u003e\r\n    \u003c/span\u003e        \r\n    \r\n\u003c/h2\u003e\r\n\r\n\r\n\u003ch3 class=\"relative group\"\u003e4.1 問題描述 \r\n    \u003cdiv id=\"41-%E5%95%8F%E9%A1%8C%E6%8F%8F%E8%BF%B0\" class=\"anchor\"\u003e\u003c/div\u003e\r\n    \r\n    \u003cspan\r\n        class=\"absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100\"\u003e\r\n        \u003ca class=\"group-hover:text-primary-300 dark:group-hover:text-neutral-700\"\r\n            style=\"text-decoration-line: none !important;\" href=\"#41-%E5%95%8F%E9%A1%8C%E6%8F%8F%E8%BF%B0\" aria-label=\"Anchor\"\u003e#\u003c/a\u003e\r\n    \u003c/span\u003e        \r\n    \r\n\u003c/h3\u003e\r\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-cpp\" data-lang=\"cpp\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// ❌ 錯誤示範\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"kt\"\u003eint\u003c/span\u003e\u003cspan class=\"o\"\u003e*\u003c/span\u003e \u003cspan class=\"n\"\u003ep\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"kt\"\u003eint\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"mi\"\u003e42\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003edelete\u003c/span\u003e \u003cspan class=\"n\"\u003ep\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003edelete\u003c/span\u003e \u003cspan class=\"n\"\u003ep\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e  \u003cspan class=\"c1\"\u003e// 重複釋放，未定義行為\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n\r\n\u003ch3 class=\"relative group\"\u003e4.2 正確做法 \r\n    \u003cdiv id=\"42-%E6%AD%A3%E7%A2%BA%E5%81%9A%E6%B3%95\" class=\"anchor\"\u003e\u003c/div\u003e\r\n    \r\n    \u003cspan\r\n        class=\"absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100\"\u003e\r\n        \u003ca class=\"group-hover:text-primary-300 dark:group-hover:text-neutral-700\"\r\n            style=\"text-decoration-line: none !important;\" href=\"#42-%E6%AD%A3%E7%A2%BA%E5%81%9A%E6%B3%95\" aria-label=\"Anchor\"\u003e#\u003c/a\u003e\r\n    \u003c/span\u003e        \r\n    \r\n\u003c/h3\u003e\r\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-cpp\" data-lang=\"cpp\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kt\"\u003eint\u003c/span\u003e\u003cspan class=\"o\"\u003e*\u003c/span\u003e \u003cspan class=\"n\"\u003ep\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"kt\"\u003eint\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"mi\"\u003e42\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003edelete\u003c/span\u003e \u003cspan class=\"n\"\u003ep\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"n\"\u003ep\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enullptr\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e  \u003cspan class=\"c1\"\u003e// 設為 nullptr 避免重複釋放\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n\r\n\u003ch3 class=\"relative group\"\u003e4.3 智慧指標解決方案 \r\n    \u003cdiv id=\"43-%E6%99%BA%E6%85%A7%E6%8C%87%E6%A8%99%E8%A7%A3%E6%B1%BA%E6%96%B9%E6%A1%88\" class=\"anchor\"\u003e\u003c/div\u003e\r\n    \r\n    \u003cspan\r\n        class=\"absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100\"\u003e\r\n        \u003ca class=\"group-hover:text-primary-300 dark:group-hover:text-neutral-700\"\r\n            style=\"text-decoration-line: none !important;\" href=\"#43-%E6%99%BA%E6%85%A7%E6%8C%87%E6%A8%99%E8%A7%A3%E6%B1%BA%E6%96%B9%E6%A1%88\" aria-label=\"Anchor\"\u003e#\u003c/a\u003e\r\n    \u003c/span\u003e        \r\n    \r\n\u003c/h3\u003e\r\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-cpp\" data-lang=\"cpp\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"n\"\u003estd\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"n\"\u003eshared_ptr\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"kt\"\u003eint\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003ep\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003estd\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"n\"\u003emake_shared\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"kt\"\u003eint\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026gt;\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"mi\"\u003e42\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// 自動處理釋放，不需要手動管理\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n\r\n\u003ch2 class=\"relative group\"\u003e5. 指標越界 \r\n    \u003cdiv id=\"5-%E6%8C%87%E6%A8%99%E8%B6%8A%E7%95%8C\" class=\"anchor\"\u003e\u003c/div\u003e\r\n    \r\n    \u003cspan\r\n        class=\"absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100\"\u003e\r\n        \u003ca class=\"group-hover:text-primary-300 dark:group-hover:text-neutral-700\"\r\n            style=\"text-decoration-line: none !important;\" href=\"#5-%E6%8C%87%E6%A8%99%E8%B6%8A%E7%95%8C\" aria-label=\"Anchor\"\u003e#\u003c/a\u003e\r\n    \u003c/span\u003e        \r\n    \r\n\u003c/h2\u003e\r\n\r\n\r\n\u003ch3 class=\"relative group\"\u003e5.1 陣列越界問題 \r\n    \u003cdiv id=\"51-%E9%99%A3%E5%88%97%E8%B6%8A%E7%95%8C%E5%95%8F%E9%A1%8C\" class=\"anchor\"\u003e\u003c/div\u003e\r\n    \r\n    \u003cspan\r\n        class=\"absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100\"\u003e\r\n        \u003ca class=\"group-hover:text-primary-300 dark:group-hover:text-neutral-700\"\r\n            style=\"text-decoration-line: none !important;\" href=\"#51-%E9%99%A3%E5%88%97%E8%B6%8A%E7%95%8C%E5%95%8F%E9%A1%8C\" aria-label=\"Anchor\"\u003e#\u003c/a\u003e\r\n    \u003c/span\u003e        \r\n    \r\n\u003c/h3\u003e\r\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-cpp\" data-lang=\"cpp\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// ❌ 錯誤示範\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"kt\"\u003eint\u003c/span\u003e \u003cspan class=\"n\"\u003earr\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"mi\"\u003e5\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"mi\"\u003e2\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"mi\"\u003e3\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"mi\"\u003e4\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"mi\"\u003e5\u003c/span\u003e\u003cspan class=\"p\"\u003e};\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kt\"\u003eint\u003c/span\u003e\u003cspan class=\"o\"\u003e*\u003c/span\u003e \u003cspan class=\"n\"\u003ep\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003earr\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"n\"\u003ep\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"mi\"\u003e5\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"mi\"\u003e6\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e    \u003cspan class=\"c1\"\u003e// 越界寫入\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"n\"\u003eprintf\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;%d\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003ep\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"mi\"\u003e10\u003c/span\u003e\u003cspan class=\"p\"\u003e]);\u003c/span\u003e  \u003cspan class=\"c1\"\u003e// 越界讀取\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n\r\n\u003ch3 class=\"relative group\"\u003e5.2 正確做法 \r\n    \u003cdiv id=\"52-%E6%AD%A3%E7%A2%BA%E5%81%9A%E6%B3%95\" class=\"anchor\"\u003e\u003c/div\u003e\r\n    \r\n    \u003cspan\r\n        class=\"absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100\"\u003e\r\n        \u003ca class=\"group-hover:text-primary-300 dark:group-hover:text-neutral-700\"\r\n            style=\"text-decoration-line: none !important;\" href=\"#52-%E6%AD%A3%E7%A2%BA%E5%81%9A%E6%B3%95\" aria-label=\"Anchor\"\u003e#\u003c/a\u003e\r\n    \u003c/span\u003e        \r\n    \r\n\u003c/h3\u003e\r\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-cpp\" data-lang=\"cpp\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// 使用 STL 容器\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"n\"\u003estd\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"n\"\u003evector\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"kt\"\u003eint\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003earr\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"mi\"\u003e2\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"mi\"\u003e3\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"mi\"\u003e4\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"mi\"\u003e5\u003c/span\u003e\u003cspan class=\"p\"\u003e};\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003earr\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003esize\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"mi\"\u003e5\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003earr\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"mi\"\u003e5\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"mi\"\u003e6\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// 或使用範圍檢查\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"k\"\u003etemplate\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003esize_t\u003c/span\u003e \u003cspan class=\"n\"\u003eN\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eSafeArray\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"kt\"\u003eint\u003c/span\u003e \u003cspan class=\"n\"\u003edata\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003eN\u003c/span\u003e\u003cspan class=\"p\"\u003e];\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003epublic\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"kt\"\u003eint\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026amp;\u003c/span\u003e \u003cspan class=\"k\"\u003eoperator\u003c/span\u003e\u003cspan class=\"p\"\u003e[](\u003c/span\u003e\u003cspan class=\"n\"\u003esize_t\u003c/span\u003e \u003cspan class=\"n\"\u003ei\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ei\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026gt;=\u003c/span\u003e \u003cspan class=\"n\"\u003eN\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"k\"\u003ethrow\u003c/span\u003e \u003cspan class=\"n\"\u003estd\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"n\"\u003eout_of_range\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;Index out of bounds\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"n\"\u003edata\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"n\"\u003ei\u003c/span\u003e\u003cspan class=\"p\"\u003e];\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e};\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n\r\n\u003ch2 class=\"relative group\"\u003e6. 懸掛指標 \r\n    \u003cdiv id=\"6-%E6%87%B8%E6%8E%9B%E6%8C%87%E6%A8%99\" class=\"anchor\"\u003e\u003c/div\u003e\r\n    \r\n    \u003cspan\r\n        class=\"absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100\"\u003e\r\n        \u003ca class=\"group-hover:text-primary-300 dark:group-hover:text-neutral-700\"\r\n            style=\"text-decoration-line: none !important;\" href=\"#6-%E6%87%B8%E6%8E%9B%E6%8C%87%E6%A8%99\" aria-label=\"Anchor\"\u003e#\u003c/a\u003e\r\n    \u003c/span\u003e        \r\n    \r\n\u003c/h2\u003e\r\n\r\n\r\n\u003ch3 class=\"relative group\"\u003e6.1 問題描述 \r\n    \u003cdiv id=\"61-%E5%95%8F%E9%A1%8C%E6%8F%8F%E8%BF%B0\" class=\"anchor\"\u003e\u003c/div\u003e\r\n    \r\n    \u003cspan\r\n        class=\"absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100\"\u003e\r\n        \u003ca class=\"group-hover:text-primary-300 dark:group-hover:text-neutral-700\"\r\n            style=\"text-decoration-line: none !important;\" href=\"#61-%E5%95%8F%E9%A1%8C%E6%8F%8F%E8%BF%B0\" aria-label=\"Anchor\"\u003e#\u003c/a\u003e\r\n    \u003c/span\u003e        \r\n    \r\n\u003c/h3\u003e\r\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-cpp\" data-lang=\"cpp\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// ❌ 錯誤示範\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"kt\"\u003eint\u003c/span\u003e\u003cspan class=\"o\"\u003e*\u003c/span\u003e \u003cspan class=\"nf\"\u003egetDangling\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"kt\"\u003eint\u003c/span\u003e \u003cspan class=\"n\"\u003elocal\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"mi\"\u003e42\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026amp;\u003c/span\u003e\u003cspan class=\"n\"\u003elocal\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e  \u003cspan class=\"c1\"\u003e// 回傳區域變數位址\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// 或\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"kt\"\u003eint\u003c/span\u003e\u003cspan class=\"o\"\u003e*\u003c/span\u003e \u003cspan class=\"n\"\u003ep\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"kt\"\u003eint\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"mi\"\u003e42\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kt\"\u003eint\u003c/span\u003e\u003cspan class=\"o\"\u003e*\u003c/span\u003e \u003cspan class=\"n\"\u003eq\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003ep\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003edelete\u003c/span\u003e \u003cspan class=\"n\"\u003ep\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e    \u003cspan class=\"c1\"\u003e// p 被釋放\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"o\"\u003e*\u003c/span\u003e\u003cspan class=\"n\"\u003eq\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"mi\"\u003e100\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e    \u003cspan class=\"c1\"\u003e// q 成為懸掛指標\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n\r\n\u003ch3 class=\"relative group\"\u003e6.2 正確做法 \r\n    \u003cdiv id=\"62-%E6%AD%A3%E7%A2%BA%E5%81%9A%E6%B3%95\" class=\"anchor\"\u003e\u003c/div\u003e\r\n    \r\n    \u003cspan\r\n        class=\"absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100\"\u003e\r\n        \u003ca class=\"group-hover:text-primary-300 dark:group-hover:text-neutral-700\"\r\n            style=\"text-decoration-line: none !important;\" href=\"#62-%E6%AD%A3%E7%A2%BA%E5%81%9A%E6%B3%95\" aria-label=\"Anchor\"\u003e#\u003c/a\u003e\r\n    \u003c/span\u003e        \r\n    \r\n\u003c/h3\u003e\r\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-cpp\" data-lang=\"cpp\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// 使用智慧指標\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"n\"\u003estd\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"n\"\u003eshared_ptr\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"kt\"\u003eint\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003egetNumber\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"n\"\u003estd\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"n\"\u003emake_shared\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"kt\"\u003eint\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026gt;\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"mi\"\u003e42\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// 或\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"n\"\u003estd\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"n\"\u003eshared_ptr\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"kt\"\u003eint\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003ep\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003estd\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"n\"\u003emake_shared\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"kt\"\u003eint\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026gt;\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"mi\"\u003e42\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"n\"\u003estd\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"n\"\u003eshared_ptr\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"kt\"\u003eint\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003eq\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003ep\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e  \u003cspan class=\"c1\"\u003e// 共享所有權\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n\r\n\u003ch2 class=\"relative group\"\u003e7. 指標型別不匹配 \r\n    \u003cdiv id=\"7-%E6%8C%87%E6%A8%99%E5%9E%8B%E5%88%A5%E4%B8%8D%E5%8C%B9%E9%85%8D\" class=\"anchor\"\u003e\u003c/div\u003e\r\n    \r\n    \u003cspan\r\n        class=\"absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100\"\u003e\r\n        \u003ca class=\"group-hover:text-primary-300 dark:group-hover:text-neutral-700\"\r\n            style=\"text-decoration-line: none !important;\" href=\"#7-%E6%8C%87%E6%A8%99%E5%9E%8B%E5%88%A5%E4%B8%8D%E5%8C%B9%E9%85%8D\" aria-label=\"Anchor\"\u003e#\u003c/a\u003e\r\n    \u003c/span\u003e        \r\n    \r\n\u003c/h2\u003e\r\n\r\n\r\n\u003ch3 class=\"relative group\"\u003e7.1 問題描述 \r\n    \u003cdiv id=\"71-%E5%95%8F%E9%A1%8C%E6%8F%8F%E8%BF%B0\" class=\"anchor\"\u003e\u003c/div\u003e\r\n    \r\n    \u003cspan\r\n        class=\"absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100\"\u003e\r\n        \u003ca class=\"group-hover:text-primary-300 dark:group-hover:text-neutral-700\"\r\n            style=\"text-decoration-line: none !important;\" href=\"#71-%E5%95%8F%E9%A1%8C%E6%8F%8F%E8%BF%B0\" aria-label=\"Anchor\"\u003e#\u003c/a\u003e\r\n    \u003c/span\u003e        \r\n    \r\n\u003c/h3\u003e\r\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-cpp\" data-lang=\"cpp\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// ❌ 錯誤示範\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"kt\"\u003eint\u003c/span\u003e\u003cspan class=\"o\"\u003e*\u003c/span\u003e \u003cspan class=\"n\"\u003eintPtr\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"kt\"\u003eint\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"mi\"\u003e42\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kt\"\u003echar\u003c/span\u003e\u003cspan class=\"o\"\u003e*\u003c/span\u003e \u003cspan class=\"n\"\u003echarPtr\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003echar\u003c/span\u003e\u003cspan class=\"o\"\u003e*\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"n\"\u003eintPtr\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e  \u003cspan class=\"c1\"\u003e// 危險的型別轉換\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n\r\n\u003ch3 class=\"relative group\"\u003e7.2 正確做法 \r\n    \u003cdiv id=\"72-%E6%AD%A3%E7%A2%BA%E5%81%9A%E6%B3%95\" class=\"anchor\"\u003e\u003c/div\u003e\r\n    \r\n    \u003cspan\r\n        class=\"absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100\"\u003e\r\n        \u003ca class=\"group-hover:text-primary-300 dark:group-hover:text-neutral-700\"\r\n            style=\"text-decoration-line: none !important;\" href=\"#72-%E6%AD%A3%E7%A2%BA%E5%81%9A%E6%B3%95\" aria-label=\"Anchor\"\u003e#\u003c/a\u003e\r\n    \u003c/span\u003e        \r\n    \r\n\u003c/h3\u003e\r\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-cpp\" data-lang=\"cpp\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// 使用 static_cast 或 reinterpret_cast\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"kt\"\u003eint\u003c/span\u003e\u003cspan class=\"o\"\u003e*\u003c/span\u003e \u003cspan class=\"n\"\u003eintPtr\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"kt\"\u003eint\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"mi\"\u003e42\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// 只在確實需要時使用\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"kt\"\u003echar\u003c/span\u003e\u003cspan class=\"o\"\u003e*\u003c/span\u003e \u003cspan class=\"n\"\u003echarPtr\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003ereinterpret_cast\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"kt\"\u003echar\u003c/span\u003e\u003cspan class=\"o\"\u003e*\u0026gt;\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eintPtr\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// 更好的做法是避免型別轉換\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"k\"\u003etemplate\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"k\"\u003etypename\u003c/span\u003e \u003cspan class=\"n\"\u003eT\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026gt;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eTypeSafePtr\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003eT\u003c/span\u003e\u003cspan class=\"o\"\u003e*\u003c/span\u003e \u003cspan class=\"n\"\u003eptr\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003epublic\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003eexplicit\u003c/span\u003e \u003cspan class=\"n\"\u003eTypeSafePtr\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eT\u003c/span\u003e\u003cspan class=\"o\"\u003e*\u003c/span\u003e \u003cspan class=\"n\"\u003ep\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eptr\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ep\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003eT\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026amp;\u003c/span\u003e \u003cspan class=\"k\"\u003eoperator\u003c/span\u003e\u003cspan class=\"o\"\u003e*\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"o\"\u003e*\u003c/span\u003e\u003cspan class=\"n\"\u003eptr\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e};\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n\r\n\u003ch2 class=\"relative group\"\u003e8. 字串指標錯誤 \r\n    \u003cdiv id=\"8-%E5%AD%97%E4%B8%B2%E6%8C%87%E6%A8%99%E9%8C%AF%E8%AA%A4\" class=\"anchor\"\u003e\u003c/div\u003e\r\n    \r\n    \u003cspan\r\n        class=\"absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100\"\u003e\r\n        \u003ca class=\"group-hover:text-primary-300 dark:group-hover:text-neutral-700\"\r\n            style=\"text-decoration-line: none !important;\" href=\"#8-%E5%AD%97%E4%B8%B2%E6%8C%87%E6%A8%99%E9%8C%AF%E8%AA%A4\" aria-label=\"Anchor\"\u003e#\u003c/a\u003e\r\n    \u003c/span\u003e        \r\n    \r\n\u003c/h2\u003e\r\n\r\n\r\n\u003ch3 class=\"relative group\"\u003e8.1 問題描述 \r\n    \u003cdiv id=\"81-%E5%95%8F%E9%A1%8C%E6%8F%8F%E8%BF%B0\" class=\"anchor\"\u003e\u003c/div\u003e\r\n    \r\n    \u003cspan\r\n        class=\"absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100\"\u003e\r\n        \u003ca class=\"group-hover:text-primary-300 dark:group-hover:text-neutral-700\"\r\n            style=\"text-decoration-line: none !important;\" href=\"#81-%E5%95%8F%E9%A1%8C%E6%8F%8F%E8%BF%B0\" aria-label=\"Anchor\"\u003e#\u003c/a\u003e\r\n    \u003c/span\u003e        \r\n    \r\n\u003c/h3\u003e\r\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-cpp\" data-lang=\"cpp\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// ❌ 錯誤示範\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"kt\"\u003echar\u003c/span\u003e\u003cspan class=\"o\"\u003e*\u003c/span\u003e \u003cspan class=\"n\"\u003estr\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026#34;Hello\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e  \u003cspan class=\"c1\"\u003e// 字串常量不可修改\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"n\"\u003estr\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"sc\"\u003e\u0026#39;h\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e        \u003cspan class=\"c1\"\u003e// 未定義行為\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// 或\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"kt\"\u003echar\u003c/span\u003e\u003cspan class=\"o\"\u003e*\u003c/span\u003e \u003cspan class=\"n\"\u003estr\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"kt\"\u003echar\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"mi\"\u003e6\u003c/span\u003e\u003cspan class=\"p\"\u003e];\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"n\"\u003estrcpy\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003estr\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026#34;Hello\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// 忘記釋放記憶體\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n\r\n\u003ch3 class=\"relative group\"\u003e8.2 正確做法 \r\n    \u003cdiv id=\"82-%E6%AD%A3%E7%A2%BA%E5%81%9A%E6%B3%95\" class=\"anchor\"\u003e\u003c/div\u003e\r\n    \r\n    \u003cspan\r\n        class=\"absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100\"\u003e\r\n        \u003ca class=\"group-hover:text-primary-300 dark:group-hover:text-neutral-700\"\r\n            style=\"text-decoration-line: none !important;\" href=\"#82-%E6%AD%A3%E7%A2%BA%E5%81%9A%E6%B3%95\" aria-label=\"Anchor\"\u003e#\u003c/a\u003e\r\n    \u003c/span\u003e        \r\n    \r\n\u003c/h3\u003e\r\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-cpp\" data-lang=\"cpp\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// 使用字串陣列\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"kt\"\u003echar\u003c/span\u003e \u003cspan class=\"n\"\u003estr\u003c/span\u003e\u003cspan class=\"p\"\u003e[]\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026#34;Hello\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e  \u003cspan class=\"c1\"\u003e// 可修改的拷貝\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// 或使用 string\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"n\"\u003estd\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"n\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003estr\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026#34;Hello\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"n\"\u003estr\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e]\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"sc\"\u003e\u0026#39;h\u0026#39;\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e  \u003cspan class=\"c1\"\u003e// 安全的修改\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// 或使用智慧指標\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"n\"\u003estd\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"n\"\u003eunique_ptr\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"kt\"\u003echar\u003c/span\u003e\u003cspan class=\"p\"\u003e[]\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003estr\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"kt\"\u003echar\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"mi\"\u003e6\u003c/span\u003e\u003cspan class=\"p\"\u003e]);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"n\"\u003estrcpy\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003estr\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003eget\u003c/span\u003e\u003cspan class=\"p\"\u003e(),\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026#34;Hello\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n\r\n\u003ch2 class=\"relative group\"\u003e9. 函式指標錯誤 \r\n    \u003cdiv id=\"9-%E5%87%BD%E5%BC%8F%E6%8C%87%E6%A8%99%E9%8C%AF%E8%AA%A4\" class=\"anchor\"\u003e\u003c/div\u003e\r\n    \r\n    \u003cspan\r\n        class=\"absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100\"\u003e\r\n        \u003ca class=\"group-hover:text-primary-300 dark:group-hover:text-neutral-700\"\r\n            style=\"text-decoration-line: none !important;\" href=\"#9-%E5%87%BD%E5%BC%8F%E6%8C%87%E6%A8%99%E9%8C%AF%E8%AA%A4\" aria-label=\"Anchor\"\u003e#\u003c/a\u003e\r\n    \u003c/span\u003e        \r\n    \r\n\u003c/h2\u003e\r\n\r\n\r\n\u003ch3 class=\"relative group\"\u003e9.1 問題描述 \r\n    \u003cdiv id=\"91-%E5%95%8F%E9%A1%8C%E6%8F%8F%E8%BF%B0\" class=\"anchor\"\u003e\u003c/div\u003e\r\n    \r\n    \u003cspan\r\n        class=\"absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100\"\u003e\r\n        \u003ca class=\"group-hover:text-primary-300 dark:group-hover:text-neutral-700\"\r\n            style=\"text-decoration-line: none !important;\" href=\"#91-%E5%95%8F%E9%A1%8C%E6%8F%8F%E8%BF%B0\" aria-label=\"Anchor\"\u003e#\u003c/a\u003e\r\n    \u003c/span\u003e        \r\n    \r\n\u003c/h3\u003e\r\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-cpp\" data-lang=\"cpp\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// ❌ 錯誤示範\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"kt\"\u003evoid\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"o\"\u003e*\u003c/span\u003e\u003cspan class=\"n\"\u003efp\u003c/span\u003e\u003cspan class=\"p\"\u003e)();\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"n\"\u003efp\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e  \u003cspan class=\"c1\"\u003e// 呼叫未初始化的函式指標\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n\r\n\u003ch3 class=\"relative group\"\u003e9.2 正確做法 \r\n    \u003cdiv id=\"92-%E6%AD%A3%E7%A2%BA%E5%81%9A%E6%B3%95\" class=\"anchor\"\u003e\u003c/div\u003e\r\n    \r\n    \u003cspan\r\n        class=\"absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100\"\u003e\r\n        \u003ca class=\"group-hover:text-primary-300 dark:group-hover:text-neutral-700\"\r\n            style=\"text-decoration-line: none !important;\" href=\"#92-%E6%AD%A3%E7%A2%BA%E5%81%9A%E6%B3%95\" aria-label=\"Anchor\"\u003e#\u003c/a\u003e\r\n    \u003c/span\u003e        \r\n    \r\n\u003c/h3\u003e\r\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-cpp\" data-lang=\"cpp\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kt\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003efunc\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"n\"\u003estd\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"n\"\u003ecout\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026lt;\u0026lt;\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026#34;Hello\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// 基本用法\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"kt\"\u003evoid\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"o\"\u003e*\u003c/span\u003e\u003cspan class=\"n\"\u003efp\u003c/span\u003e\u003cspan class=\"p\"\u003e)()\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003efunc\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003efp\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"n\"\u003efp\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// 現代寫法\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"n\"\u003estd\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"n\"\u003efunction\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"kt\"\u003evoid\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003efp\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003efunc\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003efp\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"n\"\u003efp\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// 或使用 std::bind\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"k\"\u003eauto\u003c/span\u003e \u003cspan class=\"n\"\u003efp\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003estd\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"n\"\u003ebind\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026amp;\u003c/span\u003e\u003cspan class=\"n\"\u003eMyClass\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"n\"\u003emethod\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026amp;\u003c/span\u003e\u003cspan class=\"n\"\u003eobj\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n\r\n\u003ch2 class=\"relative group\"\u003e10. 多執行緒指標問題 \r\n    \u003cdiv id=\"10-%E5%A4%9A%E5%9F%B7%E8%A1%8C%E7%B7%92%E6%8C%87%E6%A8%99%E5%95%8F%E9%A1%8C\" class=\"anchor\"\u003e\u003c/div\u003e\r\n    \r\n    \u003cspan\r\n        class=\"absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100\"\u003e\r\n        \u003ca class=\"group-hover:text-primary-300 dark:group-hover:text-neutral-700\"\r\n            style=\"text-decoration-line: none !important;\" href=\"#10-%E5%A4%9A%E5%9F%B7%E8%A1%8C%E7%B7%92%E6%8C%87%E6%A8%99%E5%95%8F%E9%A1%8C\" aria-label=\"Anchor\"\u003e#\u003c/a\u003e\r\n    \u003c/span\u003e        \r\n    \r\n\u003c/h2\u003e\r\n\r\n\r\n\u003ch3 class=\"relative group\"\u003e10.1 問題描述 \r\n    \u003cdiv id=\"101-%E5%95%8F%E9%A1%8C%E6%8F%8F%E8%BF%B0\" class=\"anchor\"\u003e\u003c/div\u003e\r\n    \r\n    \u003cspan\r\n        class=\"absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100\"\u003e\r\n        \u003ca class=\"group-hover:text-primary-300 dark:group-hover:text-neutral-700\"\r\n            style=\"text-decoration-line: none !important;\" href=\"#101-%E5%95%8F%E9%A1%8C%E6%8F%8F%E8%BF%B0\" aria-label=\"Anchor\"\u003e#\u003c/a\u003e\r\n    \u003c/span\u003e        \r\n    \r\n\u003c/h3\u003e\r\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-cpp\" data-lang=\"cpp\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// ❌ 錯誤示範\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eSharedResource\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"kt\"\u003eint\u003c/span\u003e\u003cspan class=\"o\"\u003e*\u003c/span\u003e \u003cspan class=\"n\"\u003edata\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003epublic\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"kt\"\u003evoid\u003c/span\u003e \u003cspan class=\"n\"\u003eupdate\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003eint\u003c/span\u003e \u003cspan class=\"n\"\u003evalue\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"o\"\u003e*\u003c/span\u003e\u003cspan class=\"n\"\u003edata\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003evalue\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e  \u003cspan class=\"c1\"\u003e// 沒有同步機制\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e};\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n\r\n\u003ch3 class=\"relative group\"\u003e10.2 正確做法 \r\n    \u003cdiv id=\"102-%E6%AD%A3%E7%A2%BA%E5%81%9A%E6%B3%95\" class=\"anchor\"\u003e\u003c/div\u003e\r\n    \r\n    \u003cspan\r\n        class=\"absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100\"\u003e\r\n        \u003ca class=\"group-hover:text-primary-300 dark:group-hover:text-neutral-700\"\r\n            style=\"text-decoration-line: none !important;\" href=\"#102-%E6%AD%A3%E7%A2%BA%E5%81%9A%E6%B3%95\" aria-label=\"Anchor\"\u003e#\u003c/a\u003e\r\n    \u003c/span\u003e        \r\n    \r\n\u003c/h3\u003e\r\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-cpp\" data-lang=\"cpp\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eThreadSafeResource\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003estd\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"n\"\u003eshared_ptr\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"kt\"\u003eint\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003edata\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003emutable\u003c/span\u003e \u003cspan class=\"n\"\u003estd\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"n\"\u003emutex\u003c/span\u003e \u003cspan class=\"n\"\u003emutex\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003epublic\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"kt\"\u003evoid\u003c/span\u003e \u003cspan class=\"n\"\u003eupdate\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003eint\u003c/span\u003e \u003cspan class=\"n\"\u003evalue\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"n\"\u003estd\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"n\"\u003elock_guard\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003estd\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"n\"\u003emutex\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003elock\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003emutex\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003edata\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e*\u003c/span\u003e\u003cspan class=\"n\"\u003edata\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003evalue\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"kt\"\u003eint\u003c/span\u003e \u003cspan class=\"nf\"\u003egetValue\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"k\"\u003econst\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"n\"\u003estd\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"n\"\u003elock_guard\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003estd\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"n\"\u003emutex\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003elock\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003emutex\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"n\"\u003edata\u003c/span\u003e \u003cspan class=\"o\"\u003e?\u003c/span\u003e \u003cspan class=\"o\"\u003e*\u003c/span\u003e\u003cspan class=\"nl\"\u003edata\u003c/span\u003e \u003cspan class=\"p\"\u003e:\u003c/span\u003e \u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e};\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n\r\n\u003ch2 class=\"relative group\"\u003e11. 循環參考問題 \r\n    \u003cdiv id=\"11-%E5%BE%AA%E7%92%B0%E5%8F%83%E8%80%83%E5%95%8F%E9%A1%8C\" class=\"anchor\"\u003e\u003c/div\u003e\r\n    \r\n    \u003cspan\r\n        class=\"absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100\"\u003e\r\n        \u003ca class=\"group-hover:text-primary-300 dark:group-hover:text-neutral-700\"\r\n            style=\"text-decoration-line: none !important;\" href=\"#11-%E5%BE%AA%E7%92%B0%E5%8F%83%E8%80%83%E5%95%8F%E9%A1%8C\" aria-label=\"Anchor\"\u003e#\u003c/a\u003e\r\n    \u003c/span\u003e        \r\n    \r\n\u003c/h2\u003e\r\n\r\n\r\n\u003ch3 class=\"relative group\"\u003e11.1 問題描述 \r\n    \u003cdiv id=\"111-%E5%95%8F%E9%A1%8C%E6%8F%8F%E8%BF%B0\" class=\"anchor\"\u003e\u003c/div\u003e\r\n    \r\n    \u003cspan\r\n        class=\"absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100\"\u003e\r\n        \u003ca class=\"group-hover:text-primary-300 dark:group-hover:text-neutral-700\"\r\n            style=\"text-decoration-line: none !important;\" href=\"#111-%E5%95%8F%E9%A1%8C%E6%8F%8F%E8%BF%B0\" aria-label=\"Anchor\"\u003e#\u003c/a\u003e\r\n    \u003c/span\u003e        \r\n    \r\n\u003c/h3\u003e\r\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-cpp\" data-lang=\"cpp\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// ❌ 錯誤示範\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"k\"\u003estruct\u003c/span\u003e \u003cspan class=\"nc\"\u003eNode\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003estd\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"n\"\u003eshared_ptr\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eNode\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003enext\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003estd\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"n\"\u003eshared_ptr\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eNode\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003eprev\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e};\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kt\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003ecreateNodes\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003eauto\u003c/span\u003e \u003cspan class=\"n\"\u003enode1\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003estd\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"n\"\u003emake_shared\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eNode\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026gt;\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003eauto\u003c/span\u003e \u003cspan class=\"n\"\u003enode2\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003estd\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"n\"\u003emake_shared\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eNode\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026gt;\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003enode1\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u0026gt;\u003c/span\u003e\u003cspan class=\"n\"\u003enext\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003enode2\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003enode2\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u0026gt;\u003c/span\u003e\u003cspan class=\"n\"\u003eprev\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003enode1\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e  \u003cspan class=\"c1\"\u003e// 造成循環參考\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n\r\n\u003ch3 class=\"relative group\"\u003e11.2 正確做法 \r\n    \u003cdiv id=\"112-%E6%AD%A3%E7%A2%BA%E5%81%9A%E6%B3%95\" class=\"anchor\"\u003e\u003c/div\u003e\r\n    \r\n    \u003cspan\r\n        class=\"absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100\"\u003e\r\n        \u003ca class=\"group-hover:text-primary-300 dark:group-hover:text-neutral-700\"\r\n            style=\"text-decoration-line: none !important;\" href=\"#112-%E6%AD%A3%E7%A2%BA%E5%81%9A%E6%B3%95\" aria-label=\"Anchor\"\u003e#\u003c/a\u003e\r\n    \u003c/span\u003e        \r\n    \r\n\u003c/h3\u003e\r\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-cpp\" data-lang=\"cpp\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003estruct\u003c/span\u003e \u003cspan class=\"nc\"\u003eNode\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003estd\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"n\"\u003eshared_ptr\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eNode\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003enext\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003estd\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"n\"\u003eweak_ptr\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eNode\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003eprev\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e  \u003cspan class=\"c1\"\u003e// 使用 weak_ptr\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"p\"\u003e};\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kt\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003ecreateNodes\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003eauto\u003c/span\u003e \u003cspan class=\"n\"\u003enode1\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003estd\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"n\"\u003emake_shared\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eNode\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026gt;\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003eauto\u003c/span\u003e \u003cspan class=\"n\"\u003enode2\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003estd\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"n\"\u003emake_shared\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eNode\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026gt;\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003enode1\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u0026gt;\u003c/span\u003e\u003cspan class=\"n\"\u003enext\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003enode2\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003enode2\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u0026gt;\u003c/span\u003e\u003cspan class=\"n\"\u003eprev\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003enode1\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e  \u003cspan class=\"c1\"\u003e// 不會造成循環參考\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n\r\n\u003ch2 class=\"relative group\"\u003e12. 智慧指標誤用 \r\n    \u003cdiv id=\"12-%E6%99%BA%E6%85%A7%E6%8C%87%E6%A8%99%E8%AA%A4%E7%94%A8\" class=\"anchor\"\u003e\u003c/div\u003e\r\n    \r\n    \u003cspan\r\n        class=\"absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100\"\u003e\r\n        \u003ca class=\"group-hover:text-primary-300 dark:group-hover:text-neutral-700\"\r\n            style=\"text-decoration-line: none !important;\" href=\"#12-%E6%99%BA%E6%85%A7%E6%8C%87%E6%A8%99%E8%AA%A4%E7%94%A8\" aria-label=\"Anchor\"\u003e#\u003c/a\u003e\r\n    \u003c/span\u003e        \r\n    \r\n\u003c/h2\u003e\r\n\r\n\r\n\u003ch3 class=\"relative group\"\u003e12.1 問題描述 \r\n    \u003cdiv id=\"121-%E5%95%8F%E9%A1%8C%E6%8F%8F%E8%BF%B0\" class=\"anchor\"\u003e\u003c/div\u003e\r\n    \r\n    \u003cspan\r\n        class=\"absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100\"\u003e\r\n        \u003ca class=\"group-hover:text-primary-300 dark:group-hover:text-neutral-700\"\r\n            style=\"text-decoration-line: none !important;\" href=\"#121-%E5%95%8F%E9%A1%8C%E6%8F%8F%E8%BF%B0\" aria-label=\"Anchor\"\u003e#\u003c/a\u003e\r\n    \u003c/span\u003e        \r\n    \r\n\u003c/h3\u003e\r\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-cpp\" data-lang=\"cpp\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// ❌ 錯誤示範\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"kt\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003eprocessData\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003estd\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"n\"\u003eunique_ptr\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eData\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003edata\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003estd\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"n\"\u003eunique_ptr\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eData\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003ecopy\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003edata\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e  \u003cspan class=\"c1\"\u003e// 編譯錯誤：unique_ptr 不能複製\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// 或\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"n\"\u003estd\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"n\"\u003eshared_ptr\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"kt\"\u003eint\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003eptr\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"kt\"\u003eint\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"mi\"\u003e10\u003c/span\u003e\u003cspan class=\"p\"\u003e]);\u003c/span\u003e  \u003cspan class=\"c1\"\u003e// 錯誤：使用錯誤的刪除器\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n\r\n\u003ch3 class=\"relative group\"\u003e12.2 正確做法 \r\n    \u003cdiv id=\"122-%E6%AD%A3%E7%A2%BA%E5%81%9A%E6%B3%95\" class=\"anchor\"\u003e\u003c/div\u003e\r\n    \r\n    \u003cspan\r\n        class=\"absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100\"\u003e\r\n        \u003ca class=\"group-hover:text-primary-300 dark:group-hover:text-neutral-700\"\r\n            style=\"text-decoration-line: none !important;\" href=\"#122-%E6%AD%A3%E7%A2%BA%E5%81%9A%E6%B3%95\" aria-label=\"Anchor\"\u003e#\u003c/a\u003e\r\n    \u003c/span\u003e        \r\n    \r\n\u003c/h3\u003e\r\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-cpp\" data-lang=\"cpp\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// 傳遞 unique_ptr\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"kt\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003eprocessData\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003estd\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"n\"\u003eunique_ptr\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eData\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026gt;\u0026amp;\u0026amp;\u003c/span\u003e \u003cspan class=\"n\"\u003edata\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"c1\"\u003e// 使用 std::move\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e    \u003cspan class=\"n\"\u003estd\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"n\"\u003eunique_ptr\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eData\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003elocal\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003estd\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"n\"\u003emove\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003edata\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// 正確管理陣列\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"n\"\u003estd\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"n\"\u003eshared_ptr\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"kt\"\u003eint\u003c/span\u003e\u003cspan class=\"p\"\u003e[]\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003eptr\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"kt\"\u003eint\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"mi\"\u003e10\u003c/span\u003e\u003cspan class=\"p\"\u003e]);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// 或\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"k\"\u003eauto\u003c/span\u003e \u003cspan class=\"n\"\u003eptr\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003estd\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"n\"\u003emake_unique\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"kt\"\u003eint\u003c/span\u003e\u003cspan class=\"p\"\u003e[]\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026gt;\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"mi\"\u003e10\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n\r\n\u003ch2 class=\"relative group\"\u003e13. 指標與繼承 \r\n    \u003cdiv id=\"13-%E6%8C%87%E6%A8%99%E8%88%87%E7%B9%BC%E6%89%BF\" class=\"anchor\"\u003e\u003c/div\u003e\r\n    \r\n    \u003cspan\r\n        class=\"absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100\"\u003e\r\n        \u003ca class=\"group-hover:text-primary-300 dark:group-hover:text-neutral-700\"\r\n            style=\"text-decoration-line: none !important;\" href=\"#13-%E6%8C%87%E6%A8%99%E8%88%87%E7%B9%BC%E6%89%BF\" aria-label=\"Anchor\"\u003e#\u003c/a\u003e\r\n    \u003c/span\u003e        \r\n    \r\n\u003c/h2\u003e\r\n\r\n\r\n\u003ch3 class=\"relative group\"\u003e13.1 問題描述 \r\n    \u003cdiv id=\"131-%E5%95%8F%E9%A1%8C%E6%8F%8F%E8%BF%B0\" class=\"anchor\"\u003e\u003c/div\u003e\r\n    \r\n    \u003cspan\r\n        class=\"absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100\"\u003e\r\n        \u003ca class=\"group-hover:text-primary-300 dark:group-hover:text-neutral-700\"\r\n            style=\"text-decoration-line: none !important;\" href=\"#131-%E5%95%8F%E9%A1%8C%E6%8F%8F%E8%BF%B0\" aria-label=\"Anchor\"\u003e#\u003c/a\u003e\r\n    \u003c/span\u003e        \r\n    \r\n\u003c/h3\u003e\r\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-cpp\" data-lang=\"cpp\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// ❌ 錯誤示範\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eBase\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003epublic\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003evirtual\u003c/span\u003e \u003cspan class=\"o\"\u003e~\u003c/span\u003e\u003cspan class=\"n\"\u003eBase\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003edefault\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e};\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eDerived\u003c/span\u003e \u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"n\"\u003eBase\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"kt\"\u003eint\u003c/span\u003e\u003cspan class=\"o\"\u003e*\u003c/span\u003e \u003cspan class=\"n\"\u003edata\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003epublic\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003eDerived\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003edata\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"kt\"\u003eint\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"mi\"\u003e42\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e \u003cspan class=\"p\"\u003e{}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"c1\"\u003e// 忘記實作解構子，造成記憶體洩漏\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"p\"\u003e};\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n\r\n\u003ch3 class=\"relative group\"\u003e13.2 正確做法 \r\n    \u003cdiv id=\"132-%E6%AD%A3%E7%A2%BA%E5%81%9A%E6%B3%95\" class=\"anchor\"\u003e\u003c/div\u003e\r\n    \r\n    \u003cspan\r\n        class=\"absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100\"\u003e\r\n        \u003ca class=\"group-hover:text-primary-300 dark:group-hover:text-neutral-700\"\r\n            style=\"text-decoration-line: none !important;\" href=\"#132-%E6%AD%A3%E7%A2%BA%E5%81%9A%E6%B3%95\" aria-label=\"Anchor\"\u003e#\u003c/a\u003e\r\n    \u003c/span\u003e        \r\n    \r\n\u003c/h3\u003e\r\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-cpp\" data-lang=\"cpp\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eBase\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003epublic\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003evirtual\u003c/span\u003e \u003cspan class=\"o\"\u003e~\u003c/span\u003e\u003cspan class=\"n\"\u003eBase\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003edefault\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e};\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eDerived\u003c/span\u003e \u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"n\"\u003eBase\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003estd\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"n\"\u003eunique_ptr\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"kt\"\u003eint\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003edata\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003epublic\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003eDerived\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003edata\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003estd\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"n\"\u003emake_unique\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"kt\"\u003eint\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026gt;\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"mi\"\u003e42\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e \u003cspan class=\"p\"\u003e{}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"c1\"\u003e// 不需要手動實作解構子\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"p\"\u003e};\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n\r\n\u003ch2 class=\"relative group\"\u003e14. 容器指標問題 \r\n    \u003cdiv id=\"14-%E5%AE%B9%E5%99%A8%E6%8C%87%E6%A8%99%E5%95%8F%E9%A1%8C\" class=\"anchor\"\u003e\u003c/div\u003e\r\n    \r\n    \u003cspan\r\n        class=\"absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100\"\u003e\r\n        \u003ca class=\"group-hover:text-primary-300 dark:group-hover:text-neutral-700\"\r\n            style=\"text-decoration-line: none !important;\" href=\"#14-%E5%AE%B9%E5%99%A8%E6%8C%87%E6%A8%99%E5%95%8F%E9%A1%8C\" aria-label=\"Anchor\"\u003e#\u003c/a\u003e\r\n    \u003c/span\u003e        \r\n    \r\n\u003c/h2\u003e\r\n\r\n\r\n\u003ch3 class=\"relative group\"\u003e14.1 問題描述 \r\n    \u003cdiv id=\"141-%E5%95%8F%E9%A1%8C%E6%8F%8F%E8%BF%B0\" class=\"anchor\"\u003e\u003c/div\u003e\r\n    \r\n    \u003cspan\r\n        class=\"absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100\"\u003e\r\n        \u003ca class=\"group-hover:text-primary-300 dark:group-hover:text-neutral-700\"\r\n            style=\"text-decoration-line: none !important;\" href=\"#141-%E5%95%8F%E9%A1%8C%E6%8F%8F%E8%BF%B0\" aria-label=\"Anchor\"\u003e#\u003c/a\u003e\r\n    \u003c/span\u003e        \r\n    \r\n\u003c/h3\u003e\r\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-cpp\" data-lang=\"cpp\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// ❌ 錯誤示範\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"n\"\u003estd\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"n\"\u003evector\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"kt\"\u003eint\u003c/span\u003e\u003cspan class=\"o\"\u003e*\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003evec\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003efor\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003eint\u003c/span\u003e \u003cspan class=\"n\"\u003ei\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"n\"\u003ei\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026lt;\u003c/span\u003e \u003cspan class=\"mi\"\u003e5\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"o\"\u003e++\u003c/span\u003e\u003cspan class=\"n\"\u003ei\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003evec\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003epush_back\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"kt\"\u003eint\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ei\u003c/span\u003e\u003cspan class=\"p\"\u003e));\u003c/span\u003e  \u003cspan class=\"c1\"\u003e// 手動管理記憶體\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// 忘記清理\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n\r\n\u003ch3 class=\"relative group\"\u003e14.2 正確做法 \r\n    \u003cdiv id=\"142-%E6%AD%A3%E7%A2%BA%E5%81%9A%E6%B3%95\" class=\"anchor\"\u003e\u003c/div\u003e\r\n    \r\n    \u003cspan\r\n        class=\"absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100\"\u003e\r\n        \u003ca class=\"group-hover:text-primary-300 dark:group-hover:text-neutral-700\"\r\n            style=\"text-decoration-line: none !important;\" href=\"#142-%E6%AD%A3%E7%A2%BA%E5%81%9A%E6%B3%95\" aria-label=\"Anchor\"\u003e#\u003c/a\u003e\r\n    \u003c/span\u003e        \r\n    \r\n\u003c/h3\u003e\r\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-cpp\" data-lang=\"cpp\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// 使用智慧指標容器\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"n\"\u003estd\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"n\"\u003evector\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003estd\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"n\"\u003eunique_ptr\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"kt\"\u003eint\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026gt;\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003evec\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003efor\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003eint\u003c/span\u003e \u003cspan class=\"n\"\u003ei\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"n\"\u003ei\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026lt;\u003c/span\u003e \u003cspan class=\"mi\"\u003e5\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"o\"\u003e++\u003c/span\u003e\u003cspan class=\"n\"\u003ei\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003evec\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003epush_back\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003estd\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"n\"\u003emake_unique\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"kt\"\u003eint\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026gt;\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ei\u003c/span\u003e\u003cspan class=\"p\"\u003e));\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// 自動清理\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// 或更好的做法\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"n\"\u003estd\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"n\"\u003evector\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"kt\"\u003eint\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003evec\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003efor\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003eint\u003c/span\u003e \u003cspan class=\"n\"\u003ei\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"n\"\u003ei\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026lt;\u003c/span\u003e \u003cspan class=\"mi\"\u003e5\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"o\"\u003e++\u003c/span\u003e\u003cspan class=\"n\"\u003ei\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003evec\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003epush_back\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ei\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n\r\n\u003ch2 class=\"relative group\"\u003e15. 指標與例外處理 \r\n    \u003cdiv id=\"15-%E6%8C%87%E6%A8%99%E8%88%87%E4%BE%8B%E5%A4%96%E8%99%95%E7%90%86\" class=\"anchor\"\u003e\u003c/div\u003e\r\n    \r\n    \u003cspan\r\n        class=\"absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100\"\u003e\r\n        \u003ca class=\"group-hover:text-primary-300 dark:group-hover:text-neutral-700\"\r\n            style=\"text-decoration-line: none !important;\" href=\"#15-%E6%8C%87%E6%A8%99%E8%88%87%E4%BE%8B%E5%A4%96%E8%99%95%E7%90%86\" aria-label=\"Anchor\"\u003e#\u003c/a\u003e\r\n    \u003c/span\u003e        \r\n    \r\n\u003c/h2\u003e\r\n\r\n\r\n\u003ch3 class=\"relative group\"\u003e15.1 問題描述 \r\n    \u003cdiv id=\"151-%E5%95%8F%E9%A1%8C%E6%8F%8F%E8%BF%B0\" class=\"anchor\"\u003e\u003c/div\u003e\r\n    \r\n    \u003cspan\r\n        class=\"absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100\"\u003e\r\n        \u003ca class=\"group-hover:text-primary-300 dark:group-hover:text-neutral-700\"\r\n            style=\"text-decoration-line: none !important;\" href=\"#151-%E5%95%8F%E9%A1%8C%E6%8F%8F%E8%BF%B0\" aria-label=\"Anchor\"\u003e#\u003c/a\u003e\r\n    \u003c/span\u003e        \r\n    \r\n\u003c/h3\u003e\r\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-cpp\" data-lang=\"cpp\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// ❌ 錯誤示範\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"kt\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003eriskyFunction\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"kt\"\u003eint\u003c/span\u003e\u003cspan class=\"o\"\u003e*\u003c/span\u003e \u003cspan class=\"n\"\u003ep\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"kt\"\u003eint\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"mi\"\u003e42\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"c1\"\u003e// 可能拋出例外\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e    \u003cspan class=\"n\"\u003efunctionThatMightThrow\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003edelete\u003c/span\u003e \u003cspan class=\"n\"\u003ep\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e  \u003cspan class=\"c1\"\u003e// 如果發生例外，這行不會執行\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n\r\n\u003ch3 class=\"relative group\"\u003e15.2 正確做法 \r\n    \u003cdiv id=\"152-%E6%AD%A3%E7%A2%BA%E5%81%9A%E6%B3%95\" class=\"anchor\"\u003e\u003c/div\u003e\r\n    \r\n    \u003cspan\r\n        class=\"absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100\"\u003e\r\n        \u003ca class=\"group-hover:text-primary-300 dark:group-hover:text-neutral-700\"\r\n            style=\"text-decoration-line: none !important;\" href=\"#152-%E6%AD%A3%E7%A2%BA%E5%81%9A%E6%B3%95\" aria-label=\"Anchor\"\u003e#\u003c/a\u003e\r\n    \u003c/span\u003e        \r\n    \r\n\u003c/h3\u003e\r\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-cpp\" data-lang=\"cpp\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// 使用 RAII\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"kt\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003esafeFunction\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003estd\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"n\"\u003eunique_ptr\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"kt\"\u003eint\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003ep\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003estd\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"n\"\u003emake_unique\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"kt\"\u003eint\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026gt;\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"mi\"\u003e42\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003efunctionThatMightThrow\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e  \u003cspan class=\"c1\"\u003e// 即使拋出例外，p 也會被正確釋放\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// 或使用智慧資源管理\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eResourceGuard\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003eFILE\u003c/span\u003e\u003cspan class=\"o\"\u003e*\u003c/span\u003e \u003cspan class=\"n\"\u003efile\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003epublic\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003eResourceGuard\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003econst\u003c/span\u003e \u003cspan class=\"kt\"\u003echar\u003c/span\u003e\u003cspan class=\"o\"\u003e*\u003c/span\u003e \u003cspan class=\"n\"\u003efilename\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"n\"\u003efile\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003efopen\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003efilename\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"s\"\u003e\u0026#34;r\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"o\"\u003e!\u003c/span\u003e\u003cspan class=\"n\"\u003efile\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"k\"\u003ethrow\u003c/span\u003e \u003cspan class=\"n\"\u003estd\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"n\"\u003eruntime_error\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"s\"\u003e\u0026#34;Failed to open file\u0026#34;\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"o\"\u003e~\u003c/span\u003e\u003cspan class=\"n\"\u003eResourceGuard\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003efile\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"n\"\u003efclose\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003efile\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e};\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n\r\n\u003ch2 class=\"relative group\"\u003e16. 指標與 STL 容器 \r\n    \u003cdiv id=\"16-%E6%8C%87%E6%A8%99%E8%88%87-stl-%E5%AE%B9%E5%99%A8\" class=\"anchor\"\u003e\u003c/div\u003e\r\n    \r\n    \u003cspan\r\n        class=\"absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100\"\u003e\r\n        \u003ca class=\"group-hover:text-primary-300 dark:group-hover:text-neutral-700\"\r\n            style=\"text-decoration-line: none !important;\" href=\"#16-%E6%8C%87%E6%A8%99%E8%88%87-stl-%E5%AE%B9%E5%99%A8\" aria-label=\"Anchor\"\u003e#\u003c/a\u003e\r\n    \u003c/span\u003e        \r\n    \r\n\u003c/h2\u003e\r\n\r\n\r\n\u003ch3 class=\"relative group\"\u003e16.1 問題描述 \r\n    \u003cdiv id=\"161-%E5%95%8F%E9%A1%8C%E6%8F%8F%E8%BF%B0\" class=\"anchor\"\u003e\u003c/div\u003e\r\n    \r\n    \u003cspan\r\n        class=\"absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100\"\u003e\r\n        \u003ca class=\"group-hover:text-primary-300 dark:group-hover:text-neutral-700\"\r\n            style=\"text-decoration-line: none !important;\" href=\"#161-%E5%95%8F%E9%A1%8C%E6%8F%8F%E8%BF%B0\" aria-label=\"Anchor\"\u003e#\u003c/a\u003e\r\n    \u003c/span\u003e        \r\n    \r\n\u003c/h3\u003e\r\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-cpp\" data-lang=\"cpp\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// ❌ 錯誤示範\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"n\"\u003estd\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"n\"\u003evector\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"kt\"\u003eint\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003evec\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"mi\"\u003e2\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"mi\"\u003e3\u003c/span\u003e\u003cspan class=\"p\"\u003e};\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kt\"\u003eint\u003c/span\u003e\u003cspan class=\"o\"\u003e*\u003c/span\u003e \u003cspan class=\"n\"\u003ep\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026amp;\u003c/span\u003e\u003cspan class=\"n\"\u003evec\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e];\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"n\"\u003evec\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003epush_back\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"mi\"\u003e4\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e  \u003cspan class=\"c1\"\u003e// 可能導致重新配置，p 變成懸掛指標\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n\r\n\u003ch3 class=\"relative group\"\u003e16.2 正確做法 \r\n    \u003cdiv id=\"162-%E6%AD%A3%E7%A2%BA%E5%81%9A%E6%B3%95\" class=\"anchor\"\u003e\u003c/div\u003e\r\n    \r\n    \u003cspan\r\n        class=\"absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100\"\u003e\r\n        \u003ca class=\"group-hover:text-primary-300 dark:group-hover:text-neutral-700\"\r\n            style=\"text-decoration-line: none !important;\" href=\"#162-%E6%AD%A3%E7%A2%BA%E5%81%9A%E6%B3%95\" aria-label=\"Anchor\"\u003e#\u003c/a\u003e\r\n    \u003c/span\u003e        \r\n    \r\n\u003c/h3\u003e\r\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-cpp\" data-lang=\"cpp\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"n\"\u003estd\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"n\"\u003evector\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"kt\"\u003eint\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003evec\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\u003cspan class=\"mi\"\u003e1\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"mi\"\u003e2\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"mi\"\u003e3\u003c/span\u003e\u003cspan class=\"p\"\u003e};\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// 使用迭代器\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"k\"\u003eauto\u003c/span\u003e \u003cspan class=\"n\"\u003eit\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003evec\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ebegin\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// 或使用參考\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"kt\"\u003eint\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026amp;\u003c/span\u003e \u003cspan class=\"n\"\u003eref\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003evec\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e];\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// 如果需要保持指標\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"n\"\u003evec\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003ereserve\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"mi\"\u003e4\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e  \u003cspan class=\"c1\"\u003e// 預先配置空間\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"kt\"\u003eint\u003c/span\u003e\u003cspan class=\"o\"\u003e*\u003c/span\u003e \u003cspan class=\"n\"\u003ep\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026amp;\u003c/span\u003e\u003cspan class=\"n\"\u003evec\u003c/span\u003e\u003cspan class=\"p\"\u003e[\u003c/span\u003e\u003cspan class=\"mi\"\u003e0\u003c/span\u003e\u003cspan class=\"p\"\u003e];\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"n\"\u003evec\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003epush_back\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"mi\"\u003e4\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e  \u003cspan class=\"c1\"\u003e// 不會重新配置\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n\r\n\u003ch2 class=\"relative group\"\u003e17. 自訂刪除器 \r\n    \u003cdiv id=\"17-%E8%87%AA%E8%A8%82%E5%88%AA%E9%99%A4%E5%99%A8\" class=\"anchor\"\u003e\u003c/div\u003e\r\n    \r\n    \u003cspan\r\n        class=\"absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100\"\u003e\r\n        \u003ca class=\"group-hover:text-primary-300 dark:group-hover:text-neutral-700\"\r\n            style=\"text-decoration-line: none !important;\" href=\"#17-%E8%87%AA%E8%A8%82%E5%88%AA%E9%99%A4%E5%99%A8\" aria-label=\"Anchor\"\u003e#\u003c/a\u003e\r\n    \u003c/span\u003e        \r\n    \r\n\u003c/h2\u003e\r\n\r\n\r\n\u003ch3 class=\"relative group\"\u003e17.1 問題描述 \r\n    \u003cdiv id=\"171-%E5%95%8F%E9%A1%8C%E6%8F%8F%E8%BF%B0\" class=\"anchor\"\u003e\u003c/div\u003e\r\n    \r\n    \u003cspan\r\n        class=\"absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100\"\u003e\r\n        \u003ca class=\"group-hover:text-primary-300 dark:group-hover:text-neutral-700\"\r\n            style=\"text-decoration-line: none !important;\" href=\"#171-%E5%95%8F%E9%A1%8C%E6%8F%8F%E8%BF%B0\" aria-label=\"Anchor\"\u003e#\u003c/a\u003e\r\n    \u003c/span\u003e        \r\n    \r\n\u003c/h3\u003e\r\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-cpp\" data-lang=\"cpp\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// ❌ 錯誤示範\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"k\"\u003estruct\u003c/span\u003e \u003cspan class=\"nc\"\u003eCustomResource\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"kt\"\u003evoid\u003c/span\u003e\u003cspan class=\"o\"\u003e*\u003c/span\u003e \u003cspan class=\"n\"\u003edata\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003eCustomResource\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003edata\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003especialAlloc\u003c/span\u003e\u003cspan class=\"p\"\u003e())\u003c/span\u003e \u003cspan class=\"p\"\u003e{}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"o\"\u003e~\u003c/span\u003e\u003cspan class=\"n\"\u003eCustomResource\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"n\"\u003efree\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003edata\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e  \u003cspan class=\"c1\"\u003e// 使用錯誤的釋放函式\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e};\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n\r\n\u003ch3 class=\"relative group\"\u003e17.2 正確做法 \r\n    \u003cdiv id=\"172-%E6%AD%A3%E7%A2%BA%E5%81%9A%E6%B3%95\" class=\"anchor\"\u003e\u003c/div\u003e\r\n    \r\n    \u003cspan\r\n        class=\"absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100\"\u003e\r\n        \u003ca class=\"group-hover:text-primary-300 dark:group-hover:text-neutral-700\"\r\n            style=\"text-decoration-line: none !important;\" href=\"#172-%E6%AD%A3%E7%A2%BA%E5%81%9A%E6%B3%95\" aria-label=\"Anchor\"\u003e#\u003c/a\u003e\r\n    \u003c/span\u003e        \r\n    \r\n\u003c/h3\u003e\r\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-cpp\" data-lang=\"cpp\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// 自訂刪除器\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"k\"\u003estruct\u003c/span\u003e \u003cspan class=\"nc\"\u003eCustomDeleter\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"kt\"\u003evoid\u003c/span\u003e \u003cspan class=\"nf\"\u003eoperator\u003c/span\u003e\u003cspan class=\"p\"\u003e()(\u003c/span\u003e\u003cspan class=\"kt\"\u003evoid\u003c/span\u003e\u003cspan class=\"o\"\u003e*\u003c/span\u003e \u003cspan class=\"n\"\u003ep\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"k\"\u003econst\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"n\"\u003especialFree\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ep\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e  \u003cspan class=\"c1\"\u003e// 使用正確的釋放函式\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e};\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003eusing\u003c/span\u003e \u003cspan class=\"n\"\u003eCustomPtr\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003estd\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"n\"\u003eunique_ptr\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"kt\"\u003evoid\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"n\"\u003eCustomDeleter\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026gt;\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003estruct\u003c/span\u003e \u003cspan class=\"nc\"\u003eCustomResource\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003eCustomPtr\u003c/span\u003e \u003cspan class=\"n\"\u003edata\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003eCustomResource\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003edata\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003especialAlloc\u003c/span\u003e\u003cspan class=\"p\"\u003e(),\u003c/span\u003e \u003cspan class=\"n\"\u003eCustomDeleter\u003c/span\u003e\u003cspan class=\"p\"\u003e())\u003c/span\u003e \u003cspan class=\"p\"\u003e{}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"c1\"\u003e// 不需要解構子\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"p\"\u003e};\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n\r\n\u003ch2 class=\"relative group\"\u003e18. 指標與型別轉換 \r\n    \u003cdiv id=\"18-%E6%8C%87%E6%A8%99%E8%88%87%E5%9E%8B%E5%88%A5%E8%BD%89%E6%8F%9B\" class=\"anchor\"\u003e\u003c/div\u003e\r\n    \r\n    \u003cspan\r\n        class=\"absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100\"\u003e\r\n        \u003ca class=\"group-hover:text-primary-300 dark:group-hover:text-neutral-700\"\r\n            style=\"text-decoration-line: none !important;\" href=\"#18-%E6%8C%87%E6%A8%99%E8%88%87%E5%9E%8B%E5%88%A5%E8%BD%89%E6%8F%9B\" aria-label=\"Anchor\"\u003e#\u003c/a\u003e\r\n    \u003c/span\u003e        \r\n    \r\n\u003c/h2\u003e\r\n\r\n\r\n\u003ch3 class=\"relative group\"\u003e18.1 問題描述 \r\n    \u003cdiv id=\"181-%E5%95%8F%E9%A1%8C%E6%8F%8F%E8%BF%B0\" class=\"anchor\"\u003e\u003c/div\u003e\r\n    \r\n    \u003cspan\r\n        class=\"absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100\"\u003e\r\n        \u003ca class=\"group-hover:text-primary-300 dark:group-hover:text-neutral-700\"\r\n            style=\"text-decoration-line: none !important;\" href=\"#181-%E5%95%8F%E9%A1%8C%E6%8F%8F%E8%BF%B0\" aria-label=\"Anchor\"\u003e#\u003c/a\u003e\r\n    \u003c/span\u003e        \r\n    \r\n\u003c/h3\u003e\r\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-cpp\" data-lang=\"cpp\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// ❌ 錯誤示範\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eBase\u003c/span\u003e \u003cspan class=\"p\"\u003e{};\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eDerived\u003c/span\u003e \u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"k\"\u003epublic\u003c/span\u003e \u003cspan class=\"n\"\u003eBase\u003c/span\u003e \u003cspan class=\"p\"\u003e{};\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"n\"\u003eBase\u003c/span\u003e\u003cspan class=\"o\"\u003e*\u003c/span\u003e \u003cspan class=\"n\"\u003ebp\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"n\"\u003eDerived\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"n\"\u003eDerived\u003c/span\u003e\u003cspan class=\"o\"\u003e*\u003c/span\u003e \u003cspan class=\"n\"\u003edp\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eDerived\u003c/span\u003e\u003cspan class=\"o\"\u003e*\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"n\"\u003ebp\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e  \u003cspan class=\"c1\"\u003e// 危險的 C 風格轉換\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n\r\n\u003ch3 class=\"relative group\"\u003e18.2 正確做法 \r\n    \u003cdiv id=\"182-%E6%AD%A3%E7%A2%BA%E5%81%9A%E6%B3%95\" class=\"anchor\"\u003e\u003c/div\u003e\r\n    \r\n    \u003cspan\r\n        class=\"absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100\"\u003e\r\n        \u003ca class=\"group-hover:text-primary-300 dark:group-hover:text-neutral-700\"\r\n            style=\"text-decoration-line: none !important;\" href=\"#182-%E6%AD%A3%E7%A2%BA%E5%81%9A%E6%B3%95\" aria-label=\"Anchor\"\u003e#\u003c/a\u003e\r\n    \u003c/span\u003e        \r\n    \r\n\u003c/h3\u003e\r\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-cpp\" data-lang=\"cpp\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// 使用 C++ 風格轉換\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"n\"\u003eBase\u003c/span\u003e\u003cspan class=\"o\"\u003e*\u003c/span\u003e \u003cspan class=\"n\"\u003ebp\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"n\"\u003eDerived\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eDerived\u003c/span\u003e\u003cspan class=\"o\"\u003e*\u003c/span\u003e \u003cspan class=\"n\"\u003edp\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003edynamic_cast\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eDerived\u003c/span\u003e\u003cspan class=\"o\"\u003e*\u0026gt;\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ebp\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"c1\"\u003e// 安全的轉換\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// 使用智慧指標\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"n\"\u003estd\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"n\"\u003eshared_ptr\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eBase\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003ebp\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003estd\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"n\"\u003emake_shared\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eDerived\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026gt;\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003eauto\u003c/span\u003e \u003cspan class=\"n\"\u003edp\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003estd\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"n\"\u003edynamic_pointer_cast\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eDerived\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026gt;\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003ebp\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"c1\"\u003e// 安全的轉換\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n\r\n\u003ch2 class=\"relative group\"\u003e19. 指標與常數 \r\n    \u003cdiv id=\"19-%E6%8C%87%E6%A8%99%E8%88%87%E5%B8%B8%E6%95%B8\" class=\"anchor\"\u003e\u003c/div\u003e\r\n    \r\n    \u003cspan\r\n        class=\"absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100\"\u003e\r\n        \u003ca class=\"group-hover:text-primary-300 dark:group-hover:text-neutral-700\"\r\n            style=\"text-decoration-line: none !important;\" href=\"#19-%E6%8C%87%E6%A8%99%E8%88%87%E5%B8%B8%E6%95%B8\" aria-label=\"Anchor\"\u003e#\u003c/a\u003e\r\n    \u003c/span\u003e        \r\n    \r\n\u003c/h2\u003e\r\n\r\n\r\n\u003ch3 class=\"relative group\"\u003e19.1 問題描述 \r\n    \u003cdiv id=\"191-%E5%95%8F%E9%A1%8C%E6%8F%8F%E8%BF%B0\" class=\"anchor\"\u003e\u003c/div\u003e\r\n    \r\n    \u003cspan\r\n        class=\"absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100\"\u003e\r\n        \u003ca class=\"group-hover:text-primary-300 dark:group-hover:text-neutral-700\"\r\n            style=\"text-decoration-line: none !important;\" href=\"#191-%E5%95%8F%E9%A1%8C%E6%8F%8F%E8%BF%B0\" aria-label=\"Anchor\"\u003e#\u003c/a\u003e\r\n    \u003c/span\u003e        \r\n    \r\n\u003c/h3\u003e\r\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-cpp\" data-lang=\"cpp\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// ❌ 錯誤示範\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"k\"\u003econst\u003c/span\u003e \u003cspan class=\"kt\"\u003eint\u003c/span\u003e \u003cspan class=\"n\"\u003econstant\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"mi\"\u003e42\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"kt\"\u003eint\u003c/span\u003e\u003cspan class=\"o\"\u003e*\u003c/span\u003e \u003cspan class=\"n\"\u003eptr\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003eint\u003c/span\u003e\u003cspan class=\"o\"\u003e*\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026amp;\u003c/span\u003e\u003cspan class=\"n\"\u003econstant\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e  \u003cspan class=\"c1\"\u003e// 移除 const 限定\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"o\"\u003e*\u003c/span\u003e\u003cspan class=\"n\"\u003eptr\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"mi\"\u003e43\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e  \u003cspan class=\"c1\"\u003e// 未定義行為\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n\r\n\u003ch3 class=\"relative group\"\u003e19.2 正確做法 \r\n    \u003cdiv id=\"192-%E6%AD%A3%E7%A2%BA%E5%81%9A%E6%B3%95\" class=\"anchor\"\u003e\u003c/div\u003e\r\n    \r\n    \u003cspan\r\n        class=\"absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100\"\u003e\r\n        \u003ca class=\"group-hover:text-primary-300 dark:group-hover:text-neutral-700\"\r\n            style=\"text-decoration-line: none !important;\" href=\"#192-%E6%AD%A3%E7%A2%BA%E5%81%9A%E6%B3%95\" aria-label=\"Anchor\"\u003e#\u003c/a\u003e\r\n    \u003c/span\u003e        \r\n    \r\n\u003c/h3\u003e\r\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-cpp\" data-lang=\"cpp\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// 保持 const 正確性\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"k\"\u003econst\u003c/span\u003e \u003cspan class=\"kt\"\u003eint\u003c/span\u003e \u003cspan class=\"n\"\u003econstant\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"mi\"\u003e42\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003econst\u003c/span\u003e \u003cspan class=\"kt\"\u003eint\u003c/span\u003e\u003cspan class=\"o\"\u003e*\u003c/span\u003e \u003cspan class=\"n\"\u003eptr\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026amp;\u003c/span\u003e\u003cspan class=\"n\"\u003econstant\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// *ptr = 43;  // 編譯錯誤\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// 使用 const 智慧指標\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"n\"\u003estd\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"n\"\u003eshared_ptr\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"k\"\u003econst\u003c/span\u003e \u003cspan class=\"kt\"\u003eint\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003eptr\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"n\"\u003estd\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"n\"\u003emake_shared\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"k\"\u003econst\u003c/span\u003e \u003cspan class=\"kt\"\u003eint\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026gt;\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"mi\"\u003e42\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n\r\n\u003ch2 class=\"relative group\"\u003e20. 指標與移動語意 \r\n    \u003cdiv id=\"20-%E6%8C%87%E6%A8%99%E8%88%87%E7%A7%BB%E5%8B%95%E8%AA%9E%E6%84%8F\" class=\"anchor\"\u003e\u003c/div\u003e\r\n    \r\n    \u003cspan\r\n        class=\"absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100\"\u003e\r\n        \u003ca class=\"group-hover:text-primary-300 dark:group-hover:text-neutral-700\"\r\n            style=\"text-decoration-line: none !important;\" href=\"#20-%E6%8C%87%E6%A8%99%E8%88%87%E7%A7%BB%E5%8B%95%E8%AA%9E%E6%84%8F\" aria-label=\"Anchor\"\u003e#\u003c/a\u003e\r\n    \u003c/span\u003e        \r\n    \r\n\u003c/h2\u003e\r\n\r\n\r\n\u003ch3 class=\"relative group\"\u003e20.1 問題描述 \r\n    \u003cdiv id=\"201-%E5%95%8F%E9%A1%8C%E6%8F%8F%E8%BF%B0\" class=\"anchor\"\u003e\u003c/div\u003e\r\n    \r\n    \u003cspan\r\n        class=\"absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100\"\u003e\r\n        \u003ca class=\"group-hover:text-primary-300 dark:group-hover:text-neutral-700\"\r\n            style=\"text-decoration-line: none !important;\" href=\"#201-%E5%95%8F%E9%A1%8C%E6%8F%8F%E8%BF%B0\" aria-label=\"Anchor\"\u003e#\u003c/a\u003e\r\n    \u003c/span\u003e        \r\n    \r\n\u003c/h3\u003e\r\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-cpp\" data-lang=\"cpp\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// ❌ 錯誤示範\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eResource\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"kt\"\u003eint\u003c/span\u003e\u003cspan class=\"o\"\u003e*\u003c/span\u003e \u003cspan class=\"n\"\u003edata\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003epublic\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003eResource\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003eint\u003c/span\u003e \u003cspan class=\"n\"\u003evalue\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003edata\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"kt\"\u003eint\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003evalue\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e \u003cspan class=\"p\"\u003e{}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"o\"\u003e~\u003c/span\u003e\u003cspan class=\"n\"\u003eResource\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e \u003cspan class=\"k\"\u003edelete\u003c/span\u003e \u003cspan class=\"n\"\u003edata\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"c1\"\u003e// 缺少移動建構子和賦值運算子\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e    \u003cspan class=\"n\"\u003eResource\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003econst\u003c/span\u003e \u003cspan class=\"n\"\u003eResource\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026amp;\u003c/span\u003e \u003cspan class=\"n\"\u003eother\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003edata\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"kt\"\u003eint\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"o\"\u003e*\u003c/span\u003e\u003cspan class=\"n\"\u003eother\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003edata\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e \u003cspan class=\"p\"\u003e{}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003eResource\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026amp;\u003c/span\u003e \u003cspan class=\"k\"\u003eoperator\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003econst\u003c/span\u003e \u003cspan class=\"n\"\u003eResource\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026amp;\u003c/span\u003e \u003cspan class=\"n\"\u003eother\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003ethis\u003c/span\u003e \u003cspan class=\"o\"\u003e!=\u003c/span\u003e \u003cspan class=\"o\"\u003e\u0026amp;\u003c/span\u003e\u003cspan class=\"n\"\u003eother\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e            \u003cspan class=\"k\"\u003edelete\u003c/span\u003e \u003cspan class=\"n\"\u003edata\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e            \u003cspan class=\"n\"\u003edata\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enew\u003c/span\u003e \u003cspan class=\"kt\"\u003eint\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"o\"\u003e*\u003c/span\u003e\u003cspan class=\"n\"\u003eother\u003c/span\u003e\u003cspan class=\"p\"\u003e.\u003c/span\u003e\u003cspan class=\"n\"\u003edata\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"k\"\u003ereturn\u003c/span\u003e \u003cspan class=\"o\"\u003e*\u003c/span\u003e\u003cspan class=\"k\"\u003ethis\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e};\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n\r\n\u003ch3 class=\"relative group\"\u003e20.2 正確做法 \r\n    \u003cdiv id=\"202-%E6%AD%A3%E7%A2%BA%E5%81%9A%E6%B3%95\" class=\"anchor\"\u003e\u003c/div\u003e\r\n    \r\n    \u003cspan\r\n        class=\"absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100\"\u003e\r\n        \u003ca class=\"group-hover:text-primary-300 dark:group-hover:text-neutral-700\"\r\n            style=\"text-decoration-line: none !important;\" href=\"#202-%E6%AD%A3%E7%A2%BA%E5%81%9A%E6%B3%95\" aria-label=\"Anchor\"\u003e#\u003c/a\u003e\r\n    \u003c/span\u003e        \r\n    \r\n\u003c/h3\u003e\r\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-cpp\" data-lang=\"cpp\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eResource\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003estd\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"n\"\u003eunique_ptr\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"kt\"\u003eint\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003edata\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003epublic\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003eResource\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"kt\"\u003eint\u003c/span\u003e \u003cspan class=\"n\"\u003evalue\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003edata\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003estd\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"n\"\u003emake_unique\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"kt\"\u003eint\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026gt;\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003evalue\u003c/span\u003e\u003cspan class=\"p\"\u003e))\u003c/span\u003e \u003cspan class=\"p\"\u003e{}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"c1\"\u003e// 移動建構子\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e    \u003cspan class=\"n\"\u003eResource\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eResource\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e \u003cspan class=\"n\"\u003eother\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"k\"\u003enoexcept\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003edefault\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"c1\"\u003e// 移動賦值運算子\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e    \u003cspan class=\"n\"\u003eResource\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026amp;\u003c/span\u003e \u003cspan class=\"k\"\u003eoperator\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eResource\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026amp;\u0026amp;\u003c/span\u003e \u003cspan class=\"n\"\u003eother\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"k\"\u003enoexcept\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003edefault\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"c1\"\u003e// 禁用拷貝\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e    \u003cspan class=\"n\"\u003eResource\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003econst\u003c/span\u003e \u003cspan class=\"n\"\u003eResource\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026amp;\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003edelete\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003eResource\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026amp;\u003c/span\u003e \u003cspan class=\"k\"\u003eoperator\u003c/span\u003e\u003cspan class=\"o\"\u003e=\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"k\"\u003econst\u003c/span\u003e \u003cspan class=\"n\"\u003eResource\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026amp;\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003edelete\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e};\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n\r\n\u003ch2 class=\"relative group\"\u003e🎯 最佳實踐總結 \r\n    \u003cdiv id=\"-%E6%9C%80%E4%BD%B3%E5%AF%A6%E8%B8%90%E7%B8%BD%E7%B5%90\" class=\"anchor\"\u003e\u003c/div\u003e\r\n    \r\n    \u003cspan\r\n        class=\"absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100\"\u003e\r\n        \u003ca class=\"group-hover:text-primary-300 dark:group-hover:text-neutral-700\"\r\n            style=\"text-decoration-line: none !important;\" href=\"#-%E6%9C%80%E4%BD%B3%E5%AF%A6%E8%B8%90%E7%B8%BD%E7%B5%90\" aria-label=\"Anchor\"\u003e#\u003c/a\u003e\r\n    \u003c/span\u003e        \r\n    \r\n\u003c/h2\u003e\r\n\r\n\r\n\u003ch3 class=\"relative group\"\u003e1. 初始化 \r\n    \u003cdiv id=\"1-%E5%88%9D%E5%A7%8B%E5%8C%96\" class=\"anchor\"\u003e\u003c/div\u003e\r\n    \r\n    \u003cspan\r\n        class=\"absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100\"\u003e\r\n        \u003ca class=\"group-hover:text-primary-300 dark:group-hover:text-neutral-700\"\r\n            style=\"text-decoration-line: none !important;\" href=\"#1-%E5%88%9D%E5%A7%8B%E5%8C%96\" aria-label=\"Anchor\"\u003e#\u003c/a\u003e\r\n    \u003c/span\u003e        \r\n    \r\n\u003c/h3\u003e\r\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-cpp\" data-lang=\"cpp\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// ✅ 永遠初始化指標\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"kt\"\u003eint\u003c/span\u003e\u003cspan class=\"o\"\u003e*\u003c/span\u003e \u003cspan class=\"n\"\u003eptr\u003c/span\u003e \u003cspan class=\"o\"\u003e=\u003c/span\u003e \u003cspan class=\"k\"\u003enullptr\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"n\"\u003estd\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"n\"\u003eunique_ptr\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"kt\"\u003eint\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003esmartPtr\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n\r\n\u003ch3 class=\"relative group\"\u003e2. 智慧指標使用原則 \r\n    \u003cdiv id=\"2-%E6%99%BA%E6%85%A7%E6%8C%87%E6%A8%99%E4%BD%BF%E7%94%A8%E5%8E%9F%E5%89%87\" class=\"anchor\"\u003e\u003c/div\u003e\r\n    \r\n    \u003cspan\r\n        class=\"absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100\"\u003e\r\n        \u003ca class=\"group-hover:text-primary-300 dark:group-hover:text-neutral-700\"\r\n            style=\"text-decoration-line: none !important;\" href=\"#2-%E6%99%BA%E6%85%A7%E6%8C%87%E6%A8%99%E4%BD%BF%E7%94%A8%E5%8E%9F%E5%89%87\" aria-label=\"Anchor\"\u003e#\u003c/a\u003e\r\n    \u003c/span\u003e        \r\n    \r\n\u003c/h3\u003e\r\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-cpp\" data-lang=\"cpp\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// ✅ 優先使用 unique_ptr\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"n\"\u003estd\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"n\"\u003eunique_ptr\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eResource\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003esingle_owner\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// ✅ 需要共享時使用 shared_ptr\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"n\"\u003estd\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"n\"\u003eshared_ptr\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eResource\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003eshared_resource\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// ✅ 避免循環參考時使用 weak_ptr\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"n\"\u003estd\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"n\"\u003eweak_ptr\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eResource\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003eweak_resource\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n\r\n\u003ch3 class=\"relative group\"\u003e3. RAII 原則 \r\n    \u003cdiv id=\"3-raii-%E5%8E%9F%E5%89%87\" class=\"anchor\"\u003e\u003c/div\u003e\r\n    \r\n    \u003cspan\r\n        class=\"absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100\"\u003e\r\n        \u003ca class=\"group-hover:text-primary-300 dark:group-hover:text-neutral-700\"\r\n            style=\"text-decoration-line: none !important;\" href=\"#3-raii-%E5%8E%9F%E5%89%87\" aria-label=\"Anchor\"\u003e#\u003c/a\u003e\r\n    \u003c/span\u003e        \r\n    \r\n\u003c/h3\u003e\r\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-cpp\" data-lang=\"cpp\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eRAIIWrapper\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003estd\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"n\"\u003eunique_ptr\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eResource\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003eresource\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003epublic\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003eRAIIWrapper\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"o\"\u003e:\u003c/span\u003e \u003cspan class=\"n\"\u003eresource\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003estd\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"n\"\u003emake_unique\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eResource\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026gt;\u003c/span\u003e\u003cspan class=\"p\"\u003e())\u003c/span\u003e \u003cspan class=\"p\"\u003e{}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"c1\"\u003e// 自動管理資源生命週期\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"p\"\u003e};\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n\r\n\u003ch3 class=\"relative group\"\u003e4. 容器使用 \r\n    \u003cdiv id=\"4-%E5%AE%B9%E5%99%A8%E4%BD%BF%E7%94%A8\" class=\"anchor\"\u003e\u003c/div\u003e\r\n    \r\n    \u003cspan\r\n        class=\"absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100\"\u003e\r\n        \u003ca class=\"group-hover:text-primary-300 dark:group-hover:text-neutral-700\"\r\n            style=\"text-decoration-line: none !important;\" href=\"#4-%E5%AE%B9%E5%99%A8%E4%BD%BF%E7%94%A8\" aria-label=\"Anchor\"\u003e#\u003c/a\u003e\r\n    \u003c/span\u003e        \r\n    \r\n\u003c/h3\u003e\r\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-cpp\" data-lang=\"cpp\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e// ✅ 使用 STL 容器\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"n\"\u003estd\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"n\"\u003evector\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"kt\"\u003eint\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003evec\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e                    \u003cspan class=\"c1\"\u003e// 而不是 int* arr = new int[size];\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"n\"\u003estd\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"n\"\u003earray\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"kt\"\u003eint\u003c/span\u003e\u003cspan class=\"p\"\u003e,\u003c/span\u003e \u003cspan class=\"mi\"\u003e5\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003earr\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e                  \u003cspan class=\"c1\"\u003e// 而不是 int arr[5];\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"c1\"\u003e\u003c/span\u003e\u003cspan class=\"n\"\u003estd\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"n\"\u003estring\u003c/span\u003e \u003cspan class=\"n\"\u003estr\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e                         \u003cspan class=\"c1\"\u003e// 而不是 char* str;\n\u003c/span\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n\r\n\u003ch3 class=\"relative group\"\u003e5. 線程安全 \r\n    \u003cdiv id=\"5-%E7%B7%9A%E7%A8%8B%E5%AE%89%E5%85%A8\" class=\"anchor\"\u003e\u003c/div\u003e\r\n    \r\n    \u003cspan\r\n        class=\"absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100\"\u003e\r\n        \u003ca class=\"group-hover:text-primary-300 dark:group-hover:text-neutral-700\"\r\n            style=\"text-decoration-line: none !important;\" href=\"#5-%E7%B7%9A%E7%A8%8B%E5%AE%89%E5%85%A8\" aria-label=\"Anchor\"\u003e#\u003c/a\u003e\r\n    \u003c/span\u003e        \r\n    \r\n\u003c/h3\u003e\r\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-cpp\" data-lang=\"cpp\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003eclass\u003c/span\u003e \u003cspan class=\"nc\"\u003eThreadSafe\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"k\"\u003emutable\u003c/span\u003e \u003cspan class=\"n\"\u003estd\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"n\"\u003emutex\u003c/span\u003e \u003cspan class=\"n\"\u003emutex\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"n\"\u003estd\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"n\"\u003eshared_ptr\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003eResource\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003eresource\u003c/span\u003e\u003cspan class=\"p\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"k\"\u003epublic\u003c/span\u003e\u003cspan class=\"o\"\u003e:\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"kt\"\u003evoid\u003c/span\u003e \u003cspan class=\"n\"\u003eaccess\u003c/span\u003e\u003cspan class=\"p\"\u003e()\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"n\"\u003estd\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"n\"\u003elock_guard\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026lt;\u003c/span\u003e\u003cspan class=\"n\"\u003estd\u003c/span\u003e\u003cspan class=\"o\"\u003e::\u003c/span\u003e\u003cspan class=\"n\"\u003emutex\u003c/span\u003e\u003cspan class=\"o\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"n\"\u003elock\u003c/span\u003e\u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003emutex\u003c/span\u003e\u003cspan class=\"p\"\u003e);\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"k\"\u003eif\u003c/span\u003e \u003cspan class=\"p\"\u003e(\u003c/span\u003e\u003cspan class=\"n\"\u003eresource\u003c/span\u003e\u003cspan class=\"p\"\u003e)\u003c/span\u003e \u003cspan class=\"p\"\u003e{\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e            \u003cspan class=\"n\"\u003eresource\u003c/span\u003e\u003cspan class=\"o\"\u003e-\u0026gt;\u003c/span\u003e\u003cspan class=\"n\"\u003euse\u003c/span\u003e\u003cspan class=\"p\"\u003e();\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e        \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e    \u003cspan class=\"p\"\u003e}\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"p\"\u003e};\u003c/span\u003e\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n\r\n\u003ch2 class=\"relative group\"\u003e📝 檢查清單 \r\n    \u003cdiv id=\"-%E6%AA%A2%E6%9F%A5%E6%B8%85%E5%96%AE\" class=\"anchor\"\u003e\u003c/div\u003e\r\n    \r\n    \u003cspan\r\n        class=\"absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100\"\u003e\r\n        \u003ca class=\"group-hover:text-primary-300 dark:group-hover:text-neutral-700\"\r\n            style=\"text-decoration-line: none !important;\" href=\"#-%E6%AA%A2%E6%9F%A5%E6%B8%85%E5%96%AE\" aria-label=\"Anchor\"\u003e#\u003c/a\u003e\r\n    \u003c/span\u003e        \r\n    \r\n\u003c/h2\u003e\r\n\u003col\u003e\n\u003cli\u003e✅ 所有指標使用前都已初始化\u003c/li\u003e\n\u003cli\u003e✅ 使用智慧指標管理資源\u003c/li\u003e\n\u003cli\u003e✅ 實作 RAII 原則\u003c/li\u003e\n\u003cli\u003e✅ 避免原始指標的手動記憶體管理\u003c/li\u003e\n\u003cli\u003e✅ 使用 STL 容器代替原始陣列\u003c/li\u003e\n\u003cli\u003e✅ 正確處理多執行緒情況\u003c/li\u003e\n\u003cli\u003e✅ 注意例外安全\u003c/li\u003e\n\u003cli\u003e✅ 使用現代 C++ 特性\u003c/li\u003e\n\u003cli\u003e✅ 適當使用 const\u003c/li\u003e\n\u003cli\u003e✅ 實作移動語意\u003c/li\u003e\n\u003c/ol\u003e\n\r\n\r\n\u003ch2 class=\"relative group\"\u003e🔧 除錯工具建議 \r\n    \u003cdiv id=\"-%E9%99%A4%E9%8C%AF%E5%B7%A5%E5%85%B7%E5%BB%BA%E8%AD%B0\" class=\"anchor\"\u003e\u003c/div\u003e\r\n    \r\n    \u003cspan\r\n        class=\"absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100\"\u003e\r\n        \u003ca class=\"group-hover:text-primary-300 dark:group-hover:text-neutral-700\"\r\n            style=\"text-decoration-line: none !important;\" href=\"#-%E9%99%A4%E9%8C%AF%E5%B7%A5%E5%85%B7%E5%BB%BA%E8%AD%B0\" aria-label=\"Anchor\"\u003e#\u003c/a\u003e\r\n    \u003c/span\u003e        \r\n    \r\n\u003c/h2\u003e\r\n\u003col\u003e\n\u003cli\u003e\n\u003cp\u003eValgrind\u003c/p\u003e","title":"💻 C++ 指標指南","type":"posts"},{"content":"","date":"27 February 2025","externalUrl":null,"permalink":"/categories/c++/","section":"Categories","summary":"","title":"C++","type":"categories"},{"content":"","date":"27 February 2025","externalUrl":null,"permalink":"/tags/pointer/","section":"Tags","summary":"","title":"Pointer","type":"tags"},{"content":"\r🐢 ROS2 TF2 座標轉換基礎教學 #\r前言 #\r在 ROS2 機器人系統中，TF2 (Transform Framework 2) 是一個非常重要的功能，它用於管理和追蹤機器人系統中不同座標系統之間的關係。本文將詳細介紹 TF2 的基本概念和使用方法，包括如何發布座標轉換、查詢座標關係等。\nTF2 座標轉換基礎 #\r1. 座標系統樹狀結構 #\r在 ROS2 中，所有的座標系統都組織成一個樹狀結構。例如：\nworld └── map └── odom └── base_link ├── base_laser └── camera_link 每個座標系統都有一個父座標系統（除了根節點），並且可以有多個子座標系統。\n2. 座標轉換範例 #\r2.1 靜態轉換範例 #\r假設我們有一個雷射感測器安裝在機器人上，其相對於機器人基座的位置如下：\nx 方向偏移：0.1 公尺 y 方向偏移：0.0 公尺 z 方向偏移：0.2 公尺 繞 z 軸旋轉：45 度 我們可以使用以下指令發布這個靜態轉換：\nros2 run tf2_ros static_transform_publisher --x 0.1 --y 0.0 --z 0.2 --yaw 0.785 --pitch 0.0 --roll 0.0 --frame-id base_link --child-frame-id base_laser 2.2 動態轉換範例 #\r以下是一個動態發布機器人位置的範例：\n#include \u0026lt;rclcpp/rclcpp.hpp\u0026gt; #include \u0026lt;tf2_ros/transform_broadcaster.h\u0026gt; #include \u0026lt;geometry_msgs/msg/transform_stamped.hpp\u0026gt; #include \u0026lt;tf2/LinearMath/Quaternion.h\u0026gt; class DynamicTFPublisher : public rclcpp::Node { private: std::unique_ptr\u0026lt;tf2_ros::TransformBroadcaster\u0026gt; tf_broadcaster_; rclcpp::TimerBase::SharedPtr timer_; double robot_x_ = 0.0; double robot_y_ = 0.0; double robot_theta_ = 0.0; public: DynamicTFPublisher() : Node(\u0026#34;dynamic_tf_publisher\u0026#34;) { tf_broadcaster_ = std::make_unique\u0026lt;tf2_ros::TransformBroadcaster\u0026gt;(this); timer_ = this-\u0026gt;create_wall_timer( std::chrono::milliseconds(100), std::bind(\u0026amp;DynamicTFPublisher::broadcast_transform, this)); } void broadcast_transform() { // 更新機器人位置（這裡用簡單的圓周運動作為示例） robot_x_ = 2.0 * cos(robot_theta_); robot_y_ = 2.0 * sin(robot_theta_); robot_theta_ += 0.1; geometry_msgs::msg::TransformStamped transform; transform.header.stamp = this-\u0026gt;get_clock()-\u0026gt;now(); transform.header.frame_id = \u0026#34;odom\u0026#34;; transform.child_frame_id = \u0026#34;base_link\u0026#34;; // 設置平移 transform.transform.translation.x = robot_x_; transform.transform.translation.y = robot_y_; transform.transform.translation.z = 0.0; // 設置旋轉 tf2::Quaternion q; q.setRPY(0, 0, robot_theta_); transform.transform.rotation.x = q.x(); transform.transform.rotation.y = q.y(); transform.transform.rotation.z = q.z(); transform.transform.rotation.w = q.w(); // 發布轉換 tf_broadcaster_-\u0026gt;sendTransform(transform); } }; int main(int argc, char** argv) { rclcpp::init(argc, argv); auto node = std::make_shared\u0026lt;DynamicTFPublisher\u0026gt;(); rclcpp::spin(node); rclcpp::shutdown(); return 0; } 3. 座標轉換查詢範例 #\r以下是一個查詢兩個座標系統之間轉換的完整範例：\n#include \u0026lt;rclcpp/rclcpp.hpp\u0026gt; #include \u0026lt;tf2_ros/transform_listener.h\u0026gt; #include \u0026lt;tf2_ros/buffer.h\u0026gt; #include \u0026lt;tf2_geometry_msgs/tf2_geometry_msgs.hpp\u0026gt; #include \u0026lt;geometry_msgs/msg/point_stamped.hpp\u0026gt; class TFQueryExample : public rclcpp::Node { private: std::unique_ptr\u0026lt;tf2_ros::Buffer\u0026gt; tf_buffer_; std::shared_ptr\u0026lt;tf2_ros::TransformListener\u0026gt; tf_listener_; rclcpp::TimerBase::SharedPtr timer_; public: TFQueryExample() : Node(\u0026#34;tf_query_example\u0026#34;) { tf_buffer_ = std::make_unique\u0026lt;tf2_ros::Buffer\u0026gt;(this-\u0026gt;get_clock()); tf_listener_ = std::make_shared\u0026lt;tf2_ros::TransformListener\u0026gt;(*tf_buffer_); timer_ = this-\u0026gt;create_wall_timer( std::chrono::seconds(1), std::bind(\u0026amp;TFQueryExample::query_point_transform, this)); } void query_point_transform() { // 創建一個在雷射座標系中的點 geometry_msgs::msg::PointStamped point_in_laser; point_in_laser.header.frame_id = \u0026#34;base_laser\u0026#34;; point_in_laser.header.stamp = this-\u0026gt;get_clock()-\u0026gt;now(); point_in_laser.point.x = 1.0; // 1米前方 point_in_laser.point.y = 0.0; point_in_laser.point.z = 0.0; try { // 將點從雷射座標系轉換到機器人基座座標系 geometry_msgs::msg::PointStamped point_in_base; point_in_base = tf_buffer_-\u0026gt;transform(point_in_laser, \u0026#34;base_link\u0026#34;); RCLCPP_INFO(this-\u0026gt;get_logger(), \u0026#34;Point in base_link frame: [%f, %f, %f]\u0026#34;, point_in_base.point.x, point_in_base.point.y, point_in_base.point.z); } catch (const tf2::TransformException \u0026amp; ex) { RCLCPP_ERROR(this-\u0026gt;get_logger(), \u0026#34;Transform failed: %s\u0026#34;, ex.what()); } } }; int main(int argc, char** argv) { rclcpp::init(argc, argv); auto node = std::make_shared\u0026lt;TFQueryExample\u0026gt;(); rclcpp::spin(node); rclcpp::shutdown(); return 0; } 4. 實際應用場景 #\r4.1 機器人導航 #\r在機器人導航中，我們需要維護多個座標系統：\nmap: 全局地圖座標系 odom: 里程計座標系 base_link: 機器人基座座標系 base_laser: 雷射感測器座標系 這些座標系統的關係如下：\nmap └── odom └── base_link └── base_laser 使用 TF2 可以：\n將雷射掃描數據從 base_laser 轉換到 map 座標系 追蹤機器人在地圖中的位置 進行路徑規劃和避障 4.2 機器手臂控制 #\r對於機器手臂，座標系統可能如下：\nworld └── base_link └── shoulder └── elbow └── wrist └── gripper 使用 TF2 可以：\n計算末端執行器的位置和姿態 進行運動學和逆運動學計算 實現精確的抓取和放置任務 專案架構 #\r1. 檔案結構 #\rtf2_tutorial/ ├── CMakeLists.txt # 構建配置文件 ├── package.xml # 包配置文件 └── src/ ├── tf_publisher.cpp # TF2 發布者節點實現 └── tf_listener.cpp # TF2 監聽者節點實現 2. 完整程式碼實現 #\r2.1 TF2 發布者程式碼 (tf_publisher.cpp) #\r#include \u0026lt;rclcpp/rclcpp.hpp\u0026gt; #include \u0026lt;tf2_ros/static_transform_broadcaster.h\u0026gt; #include \u0026lt;geometry_msgs/msg/transform_stamped.hpp\u0026gt; #include \u0026lt;tf2/LinearMath/Quaternion.h\u0026gt; class TFPublisher : public rclcpp::Node { private: std::shared_ptr\u0026lt;tf2_ros::StaticTransformBroadcaster\u0026gt; tf_broadcaster_; public: TFPublisher() : Node(\u0026#34;tf_publisher\u0026#34;) { // 創建 TF2 廣播器 tf_broadcaster_ = std::make_shared\u0026lt;tf2_ros::StaticTransformBroadcaster\u0026gt;(this); // 創建轉換訊息 geometry_msgs::msg::TransformStamped transform; transform.header.stamp = this-\u0026gt;get_clock()-\u0026gt;now(); transform.header.frame_id = \u0026#34;base_link\u0026#34;; transform.child_frame_id = \u0026#34;base_laser\u0026#34;; // 設置平移 transform.transform.translation.x = 0.1; transform.transform.translation.y = 0.0; transform.transform.translation.z = 0.2; // 設置旋轉（使用四元數） tf2::Quaternion q; q.setRPY(0.0, 0.0, 0.0); // Roll, Pitch, Yaw transform.transform.rotation.x = q.x(); transform.transform.rotation.y = q.y(); transform.transform.rotation.z = q.z(); transform.transform.rotation.w = q.w(); // 發布轉換 tf_broadcaster_-\u0026gt;sendTransform(transform); RCLCPP_INFO(this-\u0026gt;get_logger(), \u0026#34;Publishing static transform from %s to %s\u0026#34;, transform.header.frame_id.c_str(), transform.child_frame_id.c_str()); } }; int main(int argc, char **argv) { rclcpp::init(argc, argv); auto node = std::make_shared\u0026lt;TFPublisher\u0026gt;(); rclcpp::spin(node); rclcpp::shutdown(); return 0; } 2.2 TF2 監聽者程式碼 (tf_listener.cpp) #\r#include \u0026lt;rclcpp/rclcpp.hpp\u0026gt; #include \u0026lt;tf2_ros/transform_listener.h\u0026gt; #include \u0026lt;tf2_ros/buffer.h\u0026gt; #include \u0026lt;geometry_msgs/msg/transform_stamped.hpp\u0026gt; #include \u0026lt;tf2/exceptions.h\u0026gt; class TFListener : public rclcpp::Node { private: std::unique_ptr\u0026lt;tf2_ros::Buffer\u0026gt; tf_buffer_; std::shared_ptr\u0026lt;tf2_ros::TransformListener\u0026gt; tf_listener_; rclcpp::TimerBase::SharedPtr timer_; void timer_callback() { try { geometry_msgs::msg::TransformStamped transform = tf_buffer_-\u0026gt;lookupTransform(\u0026#34;base_link\u0026#34;, \u0026#34;base_laser\u0026#34;, tf2::TimePointZero); RCLCPP_INFO(this-\u0026gt;get_logger(), \u0026#34;Transform from %s to %s: Translation [%f, %f, %f], Rotation [%f, %f, %f, %f]\u0026#34;, transform.header.frame_id.c_str(), transform.child_frame_id.c_str(), transform.transform.translation.x, transform.transform.translation.y, transform.transform.translation.z, transform.transform.rotation.x, transform.transform.rotation.y, transform.transform.rotation.z, transform.transform.rotation.w); } catch (const tf2::TransformException \u0026amp; ex) { RCLCPP_ERROR(this-\u0026gt;get_logger(), \u0026#34;Could not transform: %s\u0026#34;, ex.what()); } } public: TFListener() : Node(\u0026#34;tf_listener\u0026#34;) { // 創建 TF2 緩衝區和監聽器 tf_buffer_ = std::make_unique\u0026lt;tf2_ros::Buffer\u0026gt;(this-\u0026gt;get_clock()); tf_listener_ = std::make_shared\u0026lt;tf2_ros::TransformListener\u0026gt;(*tf_buffer_); // 創建定時器，每秒查詢一次轉換 timer_ = this-\u0026gt;create_wall_timer( std::chrono::seconds(1), std::bind(\u0026amp;TFListener::timer_callback, this)); } }; int main(int argc, char **argv) { rclcpp::init(argc, argv); auto node = std::make_shared\u0026lt;TFListener\u0026gt;(); rclcpp::spin(node); rclcpp::shutdown(); return 0; } 3. 配置文件說明 #\r3.1 CMakeLists.txt #\rcmake_minimum_required(VERSION 3.8) project(tf2_tutorial) if(CMAKE_COMPILER_IS_GNUCXX OR CMAKE_CXX_COMPILER_ID MATCHES \u0026#34;Clang\u0026#34;) add_compile_options(-Wall -Wextra -Wpedantic) endif() find_package(ament_cmake REQUIRED) find_package(rclcpp REQUIRED) find_package(tf2 REQUIRED) find_package(tf2_ros REQUIRED) find_package(geometry_msgs REQUIRED) # 添加發布者節點 add_executable(tf_publisher src/tf_publisher.cpp) ament_target_dependencies(tf_publisher rclcpp tf2 tf2_ros geometry_msgs ) # 添加監聽者節點 add_executable(tf_listener src/tf_listener.cpp) ament_target_dependencies(tf_listener rclcpp tf2 tf2_ros geometry_msgs ) install(TARGETS tf_publisher tf_listener DESTINATION lib/${PROJECT_NAME} ) ament_package() 3.2 package.xml #\r\u0026lt;?xml version=\u0026#34;1.0\u0026#34;?\u0026gt; \u0026lt;?xml-model href=\u0026#34;http://download.ros.org/schema/package_format3.xsd\u0026#34; schematypens=\u0026#34;http://www.w3.org/2001/XMLSchema\u0026#34;?\u0026gt; \u0026lt;package format=\u0026#34;3\u0026#34;\u0026gt; \u0026lt;name\u0026gt;tf2_tutorial\u0026lt;/name\u0026gt; \u0026lt;version\u0026gt;0.0.1\u0026lt;/version\u0026gt; \u0026lt;description\u0026gt;ROS2 TF2 教學範例\u0026lt;/description\u0026gt; \u0026lt;maintainer email=\u0026#34;your@email.com\u0026#34;\u0026gt;Your Name\u0026lt;/maintainer\u0026gt; \u0026lt;license\u0026gt;Apache License 2.0\u0026lt;/license\u0026gt; \u0026lt;buildtool_depend\u0026gt;ament_cmake\u0026lt;/buildtool_depend\u0026gt; \u0026lt;depend\u0026gt;rclcpp\u0026lt;/depend\u0026gt; \u0026lt;depend\u0026gt;tf2\u0026lt;/depend\u0026gt; \u0026lt;depend\u0026gt;tf2_ros\u0026lt;/depend\u0026gt; \u0026lt;depend\u0026gt;geometry_msgs\u0026lt;/depend\u0026gt; \u0026lt;test_depend\u0026gt;ament_lint_auto\u0026lt;/test_depend\u0026gt; \u0026lt;test_depend\u0026gt;ament_lint_common\u0026lt;/test_depend\u0026gt; \u0026lt;export\u0026gt; \u0026lt;build_type\u0026gt;ament_cmake\u0026lt;/build_type\u0026gt; \u0026lt;/export\u0026gt; \u0026lt;/package\u0026gt; 執行方式 #\r編譯專案 cd ros2_ws colcon build --packages-select tf2_tutorial 執行節點 # 終端機 1：執行發布者節點 ros2 run tf2_tutorial tf_publisher # 終端機 2：執行監聽者節點 ros2 run tf2_tutorial tf_listener TF2 常用指令 #\r查看當前的轉換關係 ros2 run tf2_ros tf2_echo [source_frame] [target_frame] 發布靜態轉換 ros2 run tf2_ros static_transform_publisher x y z yaw pitch roll frame_id child_frame_id 查看座標系統樹 ros2 run tf2_tools view_frames 技術要點說明 #\r1. TF2 基本概念 #\r座標系統 (Frames)：每個座標系統都有唯一的名稱 轉換 (Transforms)：定義座標系統之間的相對關係 廣播器 (Broadcaster)：發布座標轉換信息 監聽器 (Listener)：接收和查詢座標轉換 2. 座標轉換表示 #\r平移 (Translation)：x, y, z 三維位置 旋轉 (Rotation)： 四元數 (Quaternion)：x, y, z, w 歐拉角 (Euler Angles)：roll, pitch, yaw 3. 重要功能 #\r靜態轉換：固定不變的座標關係 動態轉換：隨時間變化的座標關係 轉換查詢：獲取任意兩個座標系統間的關係 時間戳記：確保轉換的時效性 常見問題解決 #\r找不到轉換關係 檢查座標系統名稱是否正確 確認轉換是否已被發布 檢查時間戳記是否有效 轉換延遲問題 調整緩衝區大小 檢查系統時間同步 使用最新的轉換數據 座標系統命名衝突 使用明確的命名規範 避免重複的座標系統名稱 檢查命名空間設置 參考資源 #\rROS2 TF2 官方文檔 TF2 API 文檔 ROS2 座標轉換最佳實踐 結語 #\rTF2 是 ROS2 中非常重要的一個功能，它提供了靈活且強大的座標轉換管理系統。通過本教學，我們學習了如何發布和監聽座標轉換，以及如何在程式中使用 TF2 的各種功能。這些知識對於開發機器人應用是非常重要的基礎。希望這篇教學能幫助您更好地理解和使用 ROS2 的 TF2 系統。\n","date":"23 February 2025","externalUrl":null,"permalink":"/posts/tf_basics/","section":"Posts","summary":"\u003ch1 class=\"relative group\"\u003e🐢 ROS2 TF2 座標轉換基礎教學 \r\n    \u003cdiv id=\"-ros2-tf2-%E5%BA%A7%E6%A8%99%E8%BD%89%E6%8F%9B%E5%9F%BA%E7%A4%8E%E6%95%99%E5%AD%B8\" class=\"anchor\"\u003e\u003c/div\u003e\r\n    \r\n    \u003cspan\r\n        class=\"absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100\"\u003e\r\n        \u003ca class=\"group-hover:text-primary-300 dark:group-hover:text-neutral-700\"\r\n            style=\"text-decoration-line: none !important;\" href=\"#-ros2-tf2-%E5%BA%A7%E6%A8%99%E8%BD%89%E6%8F%9B%E5%9F%BA%E7%A4%8E%E6%95%99%E5%AD%B8\" aria-label=\"Anchor\"\u003e#\u003c/a\u003e\r\n    \u003c/span\u003e        \r\n    \r\n\u003c/h1\u003e\r\n\r\n\r\n\u003ch2 class=\"relative group\"\u003e前言 \r\n    \u003cdiv id=\"%E5%89%8D%E8%A8%80\" class=\"anchor\"\u003e\u003c/div\u003e\r\n    \r\n    \u003cspan\r\n        class=\"absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100\"\u003e\r\n        \u003ca class=\"group-hover:text-primary-300 dark:group-hover:text-neutral-700\"\r\n            style=\"text-decoration-line: none !important;\" href=\"#%E5%89%8D%E8%A8%80\" aria-label=\"Anchor\"\u003e#\u003c/a\u003e\r\n    \u003c/span\u003e        \r\n    \r\n\u003c/h2\u003e\r\n\u003cp\u003e在 ROS2 機器人系統中，TF2 (Transform Framework 2) 是一個非常重要的功能，它用於管理和追蹤機器人系統中不同座標系統之間的關係。本文將詳細介紹 TF2 的基本概念和使用方法，包括如何發布座標轉換、查詢座標關係等。\u003c/p\u003e","title":"🐢 ROS2 TF2 座標轉換基礎教學","type":"posts"},{"content":"","date":"23 February 2025","externalUrl":null,"permalink":"/tags/ros2/","section":"Tags","summary":"","title":"ROS2","type":"tags"},{"content":"","date":"23 February 2025","externalUrl":null,"permalink":"/categories/ros2/","section":"Categories","summary":"","title":"ROS2","type":"categories"},{"content":"","date":"23 February 2025","externalUrl":null,"permalink":"/tags/tf2/","section":"Tags","summary":"","title":"TF2","type":"tags"},{"content":"🚧 有一些想法，但還沒有實作，細節也未完善。\n計畫 #\r實作 #\r","date":"18 February 2025","externalUrl":null,"permalink":"/projects/","section":"TienYao@Tech","summary":"\u003cp\u003e🚧 有一些想法，但還沒有實作，細節也未完善。\u003c/p\u003e\n\r\n\r\n\u003ch2 class=\"relative group\"\u003e計畫 \r\n    \u003cdiv id=\"%E8%A8%88%E7%95%AB\" class=\"anchor\"\u003e\u003c/div\u003e\r\n    \r\n    \u003cspan\r\n        class=\"absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100\"\u003e\r\n        \u003ca class=\"group-hover:text-primary-300 dark:group-hover:text-neutral-700\"\r\n            style=\"text-decoration-line: none !important;\" href=\"#%E8%A8%88%E7%95%AB\" aria-label=\"Anchor\"\u003e#\u003c/a\u003e\r\n    \u003c/span\u003e        \r\n    \r\n\u003c/h2\u003e\r\n\u003cul\u003e\n\u003cli\u003e\u003cinput disabled=\"\" type=\"checkbox\"\u003e \u003c/li\u003e\n\u003c/ul\u003e\n\r\n\r\n\u003ch2 class=\"relative group\"\u003e實作 \r\n    \u003cdiv id=\"%E5%AF%A6%E4%BD%9C\" class=\"anchor\"\u003e\u003c/div\u003e\r\n    \r\n    \u003cspan\r\n        class=\"absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100\"\u003e\r\n        \u003ca class=\"group-hover:text-primary-300 dark:group-hover:text-neutral-700\"\r\n            style=\"text-decoration-line: none !important;\" href=\"#%E5%AF%A6%E4%BD%9C\" aria-label=\"Anchor\"\u003e#\u003c/a\u003e\r\n    \u003c/span\u003e        \r\n    \r\n\u003c/h2\u003e\r\n\u003cul\u003e\n\u003cli\u003e\u003cinput disabled=\"\" type=\"checkbox\"\u003e \u003c/li\u003e\n\u003c/ul\u003e","title":"Projects","type":"page"},{"content":"","date":"18 February 2025","externalUrl":null,"permalink":"/tags/freertos/","section":"Tags","summary":"","title":"FreeRTOS","type":"tags"},{"content":"","date":"18 February 2025","externalUrl":null,"permalink":"/tags/rtos/","section":"Tags","summary":"","title":"RTOS","type":"tags"},{"content":"","date":"18 February 2025","externalUrl":null,"permalink":"/tags/zynq/","section":"Tags","summary":"","title":"ZYNQ","type":"tags"},{"content":"","date":"18 February 2025","externalUrl":null,"permalink":"/categories/zynq/","section":"Categories","summary":"","title":"ZYNQ","type":"categories"},{"content":"\r🤝 FreeRTOS Task 通訊方法 #\r1. Queue 通訊機制 #\r1.1 基本概念 #\rQueue 是 FreeRTOS 中最常用的通訊機制，適合用於傳送資料。\n1.2 程式範例 #\r#include \u0026#34;FreeRTOS.h\u0026#34; #include \u0026#34;task.h\u0026#34; #include \u0026#34;queue.h\u0026#34; #include \u0026#34;xil_printf.h\u0026#34; // For xil_printf QueueHandle_t dataQueue; void vSenderTask(void *pvParameters) { int32_t valueToSend = 0; while(1) { xQueueSend(dataQueue, \u0026amp;valueToSend, portMAX_DELAY); valueToSend++; vTaskDelay(pdMS_TO_TICKS(1000)); } } void vReceiverTask(void *pvParameters) { int32_t receivedValue; while(1) { if(xQueueReceive(dataQueue, \u0026amp;receivedValue, portMAX_DELAY) == pdPASS) { xil_printf(\u0026#34;接收到的值: %d\\r\\n\u0026#34;, receivedValue); } } } int main(void) { dataQueue = xQueueCreate(10, sizeof(int32_t)); if(dataQueue != NULL) { xTaskCreate(vSenderTask, \u0026#34;Sender\u0026#34;, configMINIMAL_STACK_SIZE, NULL, 1, NULL); xTaskCreate(vReceiverTask, \u0026#34;Receiver\u0026#34;, configMINIMAL_STACK_SIZE, NULL, 1, NULL); vTaskStartScheduler(); } while(1); } 2. Semaphore 通訊機制 #\r2.1 Binary Semaphore #\r適用於簡單的同步和事件通知。\n#include \u0026#34;FreeRTOS.h\u0026#34; #include \u0026#34;task.h\u0026#34; #include \u0026#34;semphr.h\u0026#34; #include \u0026#34;xil_printf.h\u0026#34; // For xil_printf SemaphoreHandle_t binarySemaphore; void vTask1(void *pvParameters) { while(1) { xil_printf(\u0026#34;Task1 完成操作\\r\\n\u0026#34;); xSemaphoreGive(binarySemaphore); vTaskDelay(pdMS_TO_TICKS(1000)); } } void vTask2(void *pvParameters) { while(1) { if(xSemaphoreTake(binarySemaphore, portMAX_DELAY) == pdTRUE) { xil_printf(\u0026#34;Task2 收到通知並執行\\r\\n\u0026#34;); } } } int main(void) { binarySemaphore = xSemaphoreCreateBinary(); if(binarySemaphore != NULL) { xTaskCreate(vTask1, \u0026#34;Task1\u0026#34;, configMINIMAL_STACK_SIZE, NULL, 1, NULL); xTaskCreate(vTask2, \u0026#34;Task2\u0026#34;, configMINIMAL_STACK_SIZE, NULL, 1, NULL); vTaskStartScheduler(); } while(1); } 3. Mutex 互斥機制 #\r3.1 保護共享資源 #\rMutex 主要用於保護共享資源，避免多個 task 同時存取。\n#include \u0026#34;FreeRTOS.h\u0026#34; #include \u0026#34;task.h\u0026#34; #include \u0026#34;semphr.h\u0026#34; #include \u0026#34;xil_printf.h\u0026#34; // For xil_printf SemaphoreHandle_t mutexHandle; int shared_resource = 0; void vTask1(void *pvParameters) { while(1) { if(xSemaphoreTake(mutexHandle, portMAX_DELAY) == pdTRUE) { shared_resource++; xil_printf(\u0026#34;Task1: shared_resource = %d\\r\\n\u0026#34;, shared_resource); xSemaphoreGive(mutexHandle); } vTaskDelay(pdMS_TO_TICKS(1000)); } } int main(void) { mutexHandle = xSemaphoreCreateMutex(); if(mutexHandle != NULL) { xTaskCreate(vTask1, \u0026#34;Task1\u0026#34;, configMINIMAL_STACK_SIZE, NULL, 1, NULL); vTaskStartScheduler(); } while(1); } 4. Event Groups 事件組 #\r4.1 多事件同步 #\r適合需要等待多個條件同時成立的場景。\n#include \u0026#34;FreeRTOS.h\u0026#34; #include \u0026#34;task.h\u0026#34; #include \u0026#34;event_groups.h\u0026#34; #include \u0026#34;xil_printf.h\u0026#34; // For xil_printf #define EVENT_BIT_0 (1 \u0026lt;\u0026lt; 0) #define EVENT_BIT_1 (1 \u0026lt;\u0026lt; 1) #define ALL_EVENTS (EVENT_BIT_0 | EVENT_BIT_1) EventGroupHandle_t eventGroup; void vTask3(void *pvParameters) { EventBits_t bits; while(1) { bits = xEventGroupWaitBits(eventGroup, ALL_EVENTS, pdTRUE, pdTRUE, portMAX_DELAY); if((bits \u0026amp; ALL_EVENTS) == ALL_EVENTS) { xil_printf(\u0026#34;Task3 收到所有事件\\r\\n\u0026#34;); } } } int main(void) { eventGroup = xEventGroupCreate(); if(eventGroup != NULL) { xTaskCreate(vTask3, \u0026#34;Task3\u0026#34;, configMINIMAL_STACK_SIZE, NULL, 1, NULL); vTaskStartScheduler(); } while(1); } 5. Task Notification #\r5.1 輕量級通訊 #\r最新且效能最佳的通訊方式。\n#include \u0026#34;FreeRTOS.h\u0026#34; #include \u0026#34;task.h\u0026#34; #include \u0026#34;xil_printf.h\u0026#34; // For xil_printf TaskHandle_t xTask2Handle = NULL; void vTask1(void *pvParameters) { while(1) { xTaskNotify(xTask2Handle, 0x01, eSetBits); xil_printf(\u0026#34;Task1 發送通知\\r\\n\u0026#34;); vTaskDelay(pdMS_TO_TICKS(1000)); } } void vTask2(void *pvParameters) { uint32_t ulNotificationValue; while(1) { if(xTaskNotifyWait(0x00, 0xFFFFFFFF, \u0026amp;ulNotificationValue, portMAX_DELAY) == pdTRUE) { xil_printf(\u0026#34;Task2 收到通知\\r\\n\u0026#34;); } } } int main(void) { xTaskCreate(vTask1, \u0026#34;Task1\u0026#34;, configMINIMAL_STACK_SIZE, NULL, 1, NULL); xTaskCreate(vTask2, \u0026#34;Task2\u0026#34;, configMINIMAL_STACK_SIZE, NULL, 1, \u0026amp;xTask2Handle); vTaskStartScheduler(); while(1); } 6. 使用建議 #\r6.1 選擇合適的通訊方式 #\r簡單通訊：優先使用 Task Notification 資料傳輸：使用 Queue 資源保護：使用 Mutex 多事件同步：使用 Event Groups 6.2 效能考量 #\rTask Notification 效能最好 Queue 適合資料傳輸但開銷較大 Semaphore 和 Mutex 適合同步場景 💡 提示：\n在使用這些機制時，要注意避免死鎖 正確設定任務優先級 謹慎使用阻塞時間 建議在開發初期就規劃好通訊架構 ","date":"18 February 2025","externalUrl":null,"permalink":"/posts/freertos_task_communication/","section":"Posts","summary":"\u003ch1 class=\"relative group\"\u003e🤝 FreeRTOS Task 通訊方法 \r\n    \u003cdiv id=\"-freertos-task-%E9%80%9A%E8%A8%8A%E6%96%B9%E6%B3%95\" class=\"anchor\"\u003e\u003c/div\u003e\r\n    \r\n    \u003cspan\r\n        class=\"absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100\"\u003e\r\n        \u003ca class=\"group-hover:text-primary-300 dark:group-hover:text-neutral-700\"\r\n            style=\"text-decoration-line: none !important;\" href=\"#-freertos-task-%E9%80%9A%E8%A8%8A%E6%96%B9%E6%B3%95\" aria-label=\"Anchor\"\u003e#\u003c/a\u003e\r\n    \u003c/span\u003e        \r\n    \r\n\u003c/h1\u003e\r\n\r\n\r\n\u003ch2 class=\"relative group\"\u003e1. Queue 通訊機制 \r\n    \u003cdiv id=\"1-queue-%E9%80%9A%E8%A8%8A%E6%A9%9F%E5%88%B6\" class=\"anchor\"\u003e\u003c/div\u003e\r\n    \r\n    \u003cspan\r\n        class=\"absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100\"\u003e\r\n        \u003ca class=\"group-hover:text-primary-300 dark:group-hover:text-neutral-700\"\r\n            style=\"text-decoration-line: none !important;\" href=\"#1-queue-%E9%80%9A%E8%A8%8A%E6%A9%9F%E5%88%B6\" aria-label=\"Anchor\"\u003e#\u003c/a\u003e\r\n    \u003c/span\u003e        \r\n    \r\n\u003c/h2\u003e\r\n\r\n\r\n\u003ch3 class=\"relative group\"\u003e1.1 基本概念 \r\n    \u003cdiv id=\"11-%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5\" class=\"anchor\"\u003e\u003c/div\u003e\r\n    \r\n    \u003cspan\r\n        class=\"absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100\"\u003e\r\n        \u003ca class=\"group-hover:text-primary-300 dark:group-hover:text-neutral-700\"\r\n            style=\"text-decoration-line: none !important;\" href=\"#11-%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5\" aria-label=\"Anchor\"\u003e#\u003c/a\u003e\r\n    \u003c/span\u003e        \r\n    \r\n\u003c/h3\u003e\r\n\u003cp\u003eQueue 是 FreeRTOS 中最常用的通訊機制，適合用於傳送資料。\u003c/p\u003e","title":"🤝 FreeRTOS Task 通訊方法","type":"posts"},{"content":"\r🛠️ 在 Xilinx SDK 2018.3 中使用 FreeRTOS 開發多工系統 💻 #\r專案簡介 #\r這篇文章要跟大家分享如何在 Xilinx Software Development Kit (SDK) 2018.3 版本中，使用 FreeRTOS 來開發一個多工系統。我們會實作任務管理、UART 中斷處理以及任務間的通訊機制。\n開發環境 #\rXilinx SDK 2018.3 FreeRTOS 即時作業系統 開發板：Xilinx Zynq-7000 系列 系統架構 #\r程式處理流程 #\rgraph TD\rA[系統開機] --\u0026gt; B[初始化階段]\rB --\u0026gt; C1[建立UART佇列]\rB --\u0026gt; C2[建立UART號誌]\rB --\u0026gt; C3[初始化UART裝置]\rC1 --\u0026gt; D[建立起始任務]\rC2 --\u0026gt; D\rC3 --\u0026gt; D\rD --\u0026gt; E[啟動FreeRTOS排程器]\rE --\u0026gt; F[起始任務執行]\rF --\u0026gt; G1[設定UART中斷]\rF --\u0026gt; G2[建立UART中斷處理任務]\rF --\u0026gt; G3[建立Hi列印任務]\rF --\u0026gt; G4[建立Hello列印任務]\rG1 --\u0026gt; H[刪除起始任務]\rG2 --\u0026gt; H\rG3 --\u0026gt; H\rG4 --\u0026gt; H\rH --\u0026gt; I[多工任務並行執行]\rI --\u0026gt; J1[UART中斷處理]\rI --\u0026gt; J2[Hi任務執行]\rI --\u0026gt; J3[Hello任務執行]\rJ1 --\u0026gt; K[接收指令處理]\rK --\u0026gt; L1[任務控制指令]\rK --\u0026gt; L2[計數器重置指令]\rL1 --\u0026gt; I\rL2 --\u0026gt; I 任務架構 #\r系統包含以下幾個主要任務：\n起始任務（優先權：1） UART中斷處理任務（優先權：2） Hi列印任務（優先權：2） Hello列印任務（優先權：2） 通訊機制 #\r使用佇列（Queue）處理 UART 接收的資料 使用號誌（Semaphore）處理 UART 傳送同步 任務優先權管理 處理流程說明 #\r初始化階段\n建立 UART 通訊用的佇列（32 位元組）和號誌 初始化 UART 裝置（鮑率 115200） 建立起始任務（優先權 1） 任務建立階段\n起始任務負責建立其他任務 設定 UART 中斷處理機制 建立三個工作任務（優先權 2） 完成後自行刪除 執行階段\nUART 中斷處理任務等待接收指令 Hi 任務每 500ms 執行一次 Hello 任務每 1200ms 執行一次 透過 UART 指令可動態控制任務 指令處理流程\n接收字元存入指令緩衝區 遇到換行字元就解析執行指令 支援任務暫停/繼續/計數器重置等操作 完整程式碼實現 #\r1. 主程式 (main_cpu0.c) #\r/******************************************************************************* * 檔案名稱: main_cpu0.c * 說明: 主程式進入點，負責初始化UART及建立FreeRTOS工作任務 * 作者: TienYao *******************************************************************************/ #include \u0026lt;stdio.h\u0026gt; /* FreeRTOS相關標頭檔 */ #include \u0026#34;FreeRTOS.h\u0026#34; #include \u0026#34;task.h\u0026#34; #include \u0026#34;queue.h\u0026#34; #include \u0026#34;semphr.h\u0026#34; /* Xilinx相關標頭檔 */ #include \u0026#34;xparameters.h\u0026#34; #include \u0026#34;xuartps.h\u0026#34; #include \u0026#34;xscugic.h\u0026#34; /* 使用者自訂標頭檔 */ #include \u0026#34;user_task.h\u0026#34; #include \u0026#34;uart_intr.h\u0026#34; int main() { /* 變數宣告 */ int status; XUartPs_Config *uartPsConfig; /* 建立UART通訊用的佇列和號誌 */ xUartRxQueue = xQueueCreate(32, sizeof(uint8_t)); xUartTxSemaphore = xSemaphoreCreateBinary(); /* 檢查佇列和號誌是否建立成功 */ if (xUartRxQueue == NULL || xUartTxSemaphore == NULL) { return XST_FAILURE; } /* 初始化UART */ status = uart_init(uartPsConfig); if(status != XST_SUCCESS) { printf(\u0026#34;UART初始化失敗\\n\u0026#34;); return XST_FAILURE; } /* 建立起始任務 */ xTaskCreate( (TaskFunction_t)start_task, (const char*)\u0026#34;start_task\u0026#34;, (uint16_t)START_STK_SIZE, (void*)NULL, (UBaseType_t)START_TASK_PRIO, (TaskHandle_t*)\u0026amp;StartTask_Handler ); /* 啟動FreeRTOS排程器 */ vTaskStartScheduler(); /* 永久迴圈 */ while(1); return 0; } 2. UART中斷處理 (uart_intr.h) #\r/******************************************************************************* * 檔案名稱: uart_intr.h * 說明: UART中斷相關定義與函式宣告 * 作者: TienYao *******************************************************************************/ #ifndef SRC_UART_INTR_H_ #define SRC_UART_INTR_H_ #include \u0026#34;xparameters.h\u0026#34; #include \u0026#34;xuartps.h\u0026#34; #include \u0026#34;xscugic.h\u0026#34; /* UART與中斷控制器裝置ID定義 */ #define UART_0_DEVICE_ID XPAR_PS7_UART_0_DEVICE_ID #define SCUGIC_0_DEVICE_ID XPAR_PS7_SCUGIC_0_DEVICE_ID #define XUARTPS_0_INTR XPAR_XUARTPS_0_INTR /* UART裝置實體 */ XUartPs uartPs; /* 函式原型宣告 */ int uart_init(XUartPs_Config *); #endif /* SRC_UART_INTR_H_ */ 3. UART中斷處理實作 (uart_intr.c) #\r/******************************************************************************* * 檔案名稱: uart_intr.c * 說明: UART中斷初始化與設定 * 作者: TienYao *******************************************************************************/ #include \u0026#34;uart_intr.h\u0026#34; int uart_init(XUartPs_Config *uartPsConfig) { int status; /* 查找並取得UART裝置設定 */ uartPsConfig = XUartPs_LookupConfig(UART_0_DEVICE_ID); if(uartPsConfig == NULL) { return XST_FAILURE; } /* 初始化UART裝置 */ status = XUartPs_CfgInitialize(\u0026amp;uartPs, uartPsConfig, uartPsConfig-\u0026gt;BaseAddress); if(status != XST_SUCCESS) { return XST_FAILURE; } /* 設定UART運作模式、鮑率及FIFO臨界值 */ XUartPs_SetOptions(\u0026amp;uartPs, XUARTPS_OPER_MODE_NORMAL); XUartPs_SetBaudRate(\u0026amp;uartPs, 115200); XUartPs_SetFifoThreshold(\u0026amp;uartPs, 1); return XST_SUCCESS; } 4. 使用者任務定義 (user_task.h) #\r/******************************************************************************* * 檔案名稱: user_task.h * 說明: FreeRTOS任務相關定義與函式宣告 * 作者: TienYao *******************************************************************************/ #ifndef SRC_USER_TASK_H_ #define SRC_USER_TASK_H_ #include \u0026#34;FreeRTOS.h\u0026#34; #include \u0026#34;task.h\u0026#34; #include \u0026#34;queue.h\u0026#34; #include \u0026#34;semphr.h\u0026#34; #include \u0026#34;xscugic.h\u0026#34; /* 中斷控制器實體 * 此變數為Xilinx通用中斷控制器(GIC)的實體 * extern關鍵字表示此變數在其他檔案中定義 * 用於處理所有系統中斷，包含UART中斷 */ extern XScuGic xInterruptController; /* UART通訊用佇列和號誌 */ QueueHandle_t xUartRxQueue; SemaphoreHandle_t xUartTxSemaphore; /* 起始任務相關定義 */ #define START_TASK_PRIO 1 #define START_STK_SIZE 128 TaskHandle_t StartTask_Handler; void start_task(); /* UART中斷處理任務相關定義 */ #define UART_INT_TASK_PRIO 2 #define UART_INT_STK_SIZE 250 TaskHandle_t uart_int_task_handler; void uart_int_task(); /* Hi列印任務相關定義 */ #define PRINT_HI_TASK_PRIO 2 #define PRINT_HI_STK_SIZE 250 TaskHandle_t print_hi_Task_handler; void print_hi_task(); /* Hello列印任務相關定義 */ #define PRINT_HELLO_TASK_PRIO 2 #define PRINT_HELLO_STK_SIZE 250 TaskHandle_t print_hello_Task_handler; void print_hello_task(); /* UART中斷處理函式 */ void uart_intr_handler(void *); #endif /* SRC_USER_TASK_H_ */ 5. 使用者任務實作 (user_task.c) #\r/******************************************************************************* * 檔案名稱: user_task.c * 說明: FreeRTOS任務實作，包含UART中斷處理、Hi/Hello列印任務等 * 作者: TienYao *******************************************************************************/ #include \u0026#34;user_task.h\u0026#34; #include \u0026#34;uart_intr.h\u0026#34; #include \u0026lt;stdio.h\u0026gt; /* Hi和Hello任務的計數器 */ unsigned hiLoop = 0; /* Hi任務的列印次數計數器 */ unsigned helloLoop = 0; /* Hello任務的列印次數計數器 */ /** * @brief UART中斷處理函式 * @param call_back_ref: UART裝置指標 * @note 處理UART接收和傳送中斷 */ void uart_intr_handler(void *call_back_ref) { XUartPs *UartPs = (XUartPs *)call_back_ref; uint32_t IsrStatus = XUartPs_ReadReg(UartPs-\u0026gt;Config.BaseAddress, XUARTPS_ISR_OFFSET); BaseType_t xHigherPriorityTaskWoken = pdFALSE; /* 處理接收中斷 */ if (IsrStatus \u0026amp; XUARTPS_IXR_RXOVR) { uint8_t ReceivedChar = XUartPs_ReadReg(UartPs-\u0026gt;Config.BaseAddress, XUARTPS_FIFO_OFFSET); xQueueSendFromISR(xUartRxQueue, \u0026amp;ReceivedChar, \u0026amp;xHigherPriorityTaskWoken); } /* 處理傳送中斷 */ if (IsrStatus \u0026amp; XUARTPS_IXR_TXEMPTY) { xSemaphoreGiveFromISR(xUartTxSemaphore, \u0026amp;xHigherPriorityTaskWoken); } /* 清除中斷狀態並檢查是否需要切換任務 */ XUartPs_WriteReg(UartPs-\u0026gt;Config.BaseAddress, XUARTPS_ISR_OFFSET, IsrStatus); portYIELD_FROM_ISR(xHigherPriorityTaskWoken); } /** * @brief UART中斷處理任務 * @param pvParameters: 任務參數（未使用） * @note 處理UART接收到的指令 */ void uart_int_task(void *pvParameters) { uint8_t ReceivedChar; char cmd[16]; u8 cnt = 0; while (1) { /* 等待接收字元 */ if (xQueueReceive(xUartRxQueue, \u0026amp;ReceivedChar, portMAX_DELAY) == pdTRUE) { if(ReceivedChar == \u0026#39;\\r\u0026#39;) { /* 收到換行字元，表示指令結束 */ xil_printf(\u0026#34;%s\\n\u0026#34;, cmd); /* 解析並執行指令 */ if(!strcmp(\u0026#34;stop_hi\u0026#34;, cmd)) { vTaskSuspend(print_hi_Task_handler); /* 暫停Hi任務 */ } else if(!strcmp(\u0026#34;go_hi\u0026#34;, cmd)) { vTaskResume(print_hi_Task_handler); /* 繼續Hi任務 */ } else if(!strcmp(\u0026#34;clear_go_loop\u0026#34;, cmd)) { hiLoop = 0; /* 重置Hi計數器 */ } else if (!strcmp(\u0026#34;stop_hello\u0026#34;, cmd)) { vTaskSuspend(print_hi_Task_handler); /* 暫停Hello任務 */ } else if(!strcmp(\u0026#34;go_hello\u0026#34;, cmd)) { vTaskResume(print_hi_Task_handler); /* 繼續Hello任務 */ } else if(!strcmp(\u0026#34;clear_hello_loop\u0026#34;, cmd)) { helloLoop = 0; /* 重置Hello計數器 */ } else { printf(\u0026#34;未知指令\\n\u0026#34;); /* 未知指令 */ } cnt = 0; } else { cmd[cnt] = ReceivedChar; /* 儲存指令字元 */ cnt++; cmd[cnt] = \u0026#39;\\0\u0026#39;; /* 字串結尾 */ } } } } /** * @brief Hi列印任務 * @note 每500毫秒列印一次Hi */ void print_hi_task() { while(1) { vTaskDelay(500); /* 延遲500毫秒 */ printf(\u0026#34;Hi 次數 %d\\n\u0026#34;, hiLoop++); /* 列印Hi和計數 */ } } /** * @brief Hello列印任務 * @note 每1200毫秒列印一次Hello */ void print_hello_task() { while(1) { vTaskDelay(1200); /* 延遲1200毫秒 */ printf(\u0026#34;Hello 次數 %d\\n\u0026#34;, helloLoop++); /* 列印Hello和計數 */ } } /** * @brief 起始任務 * @note 初始化系統並建立其他任務 */ void start_task() { taskENTER_CRITICAL(); /* 進入臨界區 */ /* 設定UART中斷 */ XScuGic_Connect(\u0026amp;xInterruptController, XUARTPS_0_INTR, (Xil_InterruptHandler) uart_intr_handler, (void *)\u0026amp;uartPs); XUartPs_SetInterruptMask(\u0026amp;uartPs, XUARTPS_IXR_RXOVR); Xil_ExceptionInit(); XScuGic_Enable(\u0026amp;xInterruptController, XUARTPS_0_INTR); /* 建立UART中斷處理任務 */ xTaskCreate( (TaskFunction_t)uart_int_task, (const char*)\u0026#34;uart_int_task\u0026#34;, (uint16_t)UART_INT_STK_SIZE, (void*)NULL, (UBaseType_t)UART_INT_TASK_PRIO, (TaskHandle_t*)\u0026amp;uart_int_task_handler ); /* 建立Hi列印任務 */ xTaskCreate( (TaskFunction_t)print_hi_task, (const char*)\u0026#34;print_hi_task\u0026#34;, (uint16_t)PRINT_HI_STK_SIZE, (void*)NULL, (UBaseType_t)PRINT_HI_TASK_PRIO, (TaskHandle_t*)\u0026amp;print_hi_Task_handler ); /* 建立Hello列印任務 */ xTaskCreate( (TaskFunction_t)print_hello_task, (const char*)\u0026#34;print_hello_task\u0026#34;, (uint16_t)PRINT_HELLO_STK_SIZE, (void*)NULL, (UBaseType_t)PRINT_HELLO_TASK_PRIO, (TaskHandle_t*)\u0026amp;print_hello_Task_handler ); vTaskDelete(StartTask_Handler); /* 刪除起始任務 */ taskEXIT_CRITICAL(); /* 退出臨界區 */ } 特色功能 #\r1. 動態任務控制 #\r可以透過 UART 指令動態控制任務的暫停和繼續 支援計數器重置功能 任務優先權可調整 2. 中斷處理機制 #\r使用佇列處理 UART 接收中斷 使用號誌處理 UART 傳送同步 支援高優先權任務搶佔 使用說明 #\rUART 指令列表 #\rstop_hi：暫停 Hi 任務 go_hi：繼續 Hi 任務 clear_go_loop：重置 Hi 計數器 stop_hello：暫停 Hello 任務 go_hello：繼續 Hello 任務 clear_hello_loop：重置 Hello 計數器 技術重點 #\rFreeRTOS 任務管理 中斷處理 任務間通訊（佇列、號誌） 臨界區保護 UART 通訊協定 注意事項 #\r在 Zynq-7000 上使用 FreeRTOS 加入 UART 中斷功能時，要特別注意以下幾點：\n中斷控制器初始化\nFreeRTOS BSP 裡的 portZynq7000.c 已經定義好全域中斷控制器 XScuGic xInterruptController PS 只有一個中斷控制器資源，如果自己重新初始化中斷控制器（直接使用 FreeRTOS BSP 裡的 portZynq7000.c 定義的中斷控制器就好），可能會導致任務無法正常執行 一定要使用 extern XScuGic xInterruptController 宣告這個全域變數 其它就用 Xilinx 的方法進行 config 與 connect 設定就可以了 初始化時序\n中斷初始化一定要在執行緒啟動前完成 不能在 main 函式中初始化中斷 要在 vTaskStartScheduler() 之前完成所有中斷設定 未來展望 #\r加入更多任務管理功能 優化中斷處理機制 增加更多通訊介面支援 加入任務監控功能 ","date":"11 February 2025","externalUrl":null,"permalink":"/posts/zynq_freertos_multitask/","section":"Posts","summary":"\u003ch1 class=\"relative group\"\u003e🛠️ 在 Xilinx SDK 2018.3 中使用 FreeRTOS 開發多工系統 💻 \r\n    \u003cdiv id=\"-%E5%9C%A8-xilinx-sdk-20183-%E4%B8%AD%E4%BD%BF%E7%94%A8-freertos-%E9%96%8B%E7%99%BC%E5%A4%9A%E5%B7%A5%E7%B3%BB%E7%B5%B1-\" class=\"anchor\"\u003e\u003c/div\u003e\r\n    \r\n    \u003cspan\r\n        class=\"absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100\"\u003e\r\n        \u003ca class=\"group-hover:text-primary-300 dark:group-hover:text-neutral-700\"\r\n            style=\"text-decoration-line: none !important;\" href=\"#-%E5%9C%A8-xilinx-sdk-20183-%E4%B8%AD%E4%BD%BF%E7%94%A8-freertos-%E9%96%8B%E7%99%BC%E5%A4%9A%E5%B7%A5%E7%B3%BB%E7%B5%B1-\" aria-label=\"Anchor\"\u003e#\u003c/a\u003e\r\n    \u003c/span\u003e        \r\n    \r\n\u003c/h1\u003e\r\n\r\n\r\n\u003ch2 class=\"relative group\"\u003e專案簡介 \r\n    \u003cdiv id=\"%E5%B0%88%E6%A1%88%E7%B0%A1%E4%BB%8B\" class=\"anchor\"\u003e\u003c/div\u003e\r\n    \r\n    \u003cspan\r\n        class=\"absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100\"\u003e\r\n        \u003ca class=\"group-hover:text-primary-300 dark:group-hover:text-neutral-700\"\r\n            style=\"text-decoration-line: none !important;\" href=\"#%E5%B0%88%E6%A1%88%E7%B0%A1%E4%BB%8B\" aria-label=\"Anchor\"\u003e#\u003c/a\u003e\r\n    \u003c/span\u003e        \r\n    \r\n\u003c/h2\u003e\r\n\u003cp\u003e這篇文章要跟大家分享如何在 Xilinx Software Development Kit (SDK) 2018.3 版本中，使用 FreeRTOS 來開發一個多工系統。我們會實作任務管理、UART 中斷處理以及任務間的通訊機制。\u003c/p\u003e","title":"🛠️ 在 Xilinx SDK 2018.3 中使用 FreeRTOS 開發多工系統 💻","type":"posts"},{"content":"\r🐢 ROS2 巡邏服務節點開發教學(使用 Parameters) #\r前言 #\r在本篇文章中，我們將基於之前的巡邏服務節點，加入 ROS2 的參數功能。透過參數服務，我們可以動態地修改和監控節點的行為，使系統更加靈活。這個專案展示了如何在 ROS2 中實現參數的設定和使用，以及如何結合服務端（Server）和客戶端（Client）的通信。\n專案架構 #\r1. 檔案結構 #\rpatrol_parameters/\r├── CMakeLists.txt # 構建配置文件\r├── package.xml # 包配置文件\r├── srv/\r│ └── Patrol.srv # 巡邏服務介面定義\r├── src/\r├── service_parameters.cpp # 參數服務端節點實現\r└── client_parameters.cpp # 參數客戶端節點實現 2. 完整程式碼實現 #\r2.1 參數客戶端程式碼 (client_parameters.cpp) #\r// ===== 包含必要的標頭檔 ===== #include \u0026#34;rclcpp/rclcpp.hpp\u0026#34; // ROS2 C++ 客戶端庫,提供ROS2基本功能 #include \u0026#34;patrol/srv/patrol.hpp\u0026#34; // 自定義的巡邏服務介面 #include \u0026#34;rclcpp/time.hpp\u0026#34; // ROS2 時間相關功能,用於處理時間 #include \u0026lt;random\u0026gt; // C++ 隨機數生成庫,用於生成隨機目標位置 #include \u0026#34;rcl_interfaces/msg/parameter.hpp\u0026#34; // ROS2 參數訊息,用於參數定義 #include \u0026#34;rcl_interfaces/msg/parameter_value.hpp\u0026#34; // ROS2 參數值訊息,用於設置參數值 #include \u0026#34;rcl_interfaces/msg/parameter_type.hpp\u0026#34; // ROS2 參數類型訊息,定義參數類型 #include \u0026#34;rcl_interfaces/srv/set_parameters.hpp\u0026#34; // ROS2 設置參數服務,用於動態修改參數 /** * @brief 客戶端節點類別 * * 此類別繼承自 rclcpp::Node,實現了一個ROS2客戶端節點 * 主要功能是發送巡邏請求和更新目標參數 */ class Client: public rclcpp::Node { private: rclcpp::Client\u0026lt;patrol::srv::Patrol\u0026gt;::SharedPtr client_; // 巡邏服務客戶端,用於發送巡邏請求 std::shared_ptr\u0026lt;patrol::srv::Patrol::Request\u0026gt; request_; // 服務請求物件,儲存請求內容 rclcpp::TimerBase::SharedPtr timer_; // 定時器,用於定期發送請求 public: Client(std::string nodeName); // 建構函數,初始化節點 ~Client() = default; // 預設解構函數 void cb(); // 定時回調函數,處理定時任務 std::shared_ptr\u0026lt;rcl_interfaces::srv::SetParameters::Response\u0026gt; call_set_parameters(rcl_interfaces::msg::Parameter \u0026amp;parameter); // 設置參數函數 void update_target_parameters(double x, double y); // 更新目標位置參數的函數 }; /** * @brief 客戶端節點建構函數 * @param nodeName 節點名稱 * * 初始化節點,創建服務客戶端和定時器 */ Client::Client(std::string nodeName): Node(nodeName) { // 創建巡邏服務客戶端,服務名為\u0026#34;patrol\u0026#34; this-\u0026gt;client_ = this-\u0026gt;create_client\u0026lt;patrol::srv::Patrol\u0026gt;(\u0026#34;patrol\u0026#34;); RCLCPP_INFO(this-\u0026gt;get_logger(),\u0026#34;Client has been created\u0026#34;); // 輸出創建成功日誌 // 創建定時器,每20秒觸發一次回調函數 this-\u0026gt;timer_ = this-\u0026gt;create_wall_timer(std::chrono::seconds(20), std::bind(\u0026amp;Client::cb, this)); } /** * @brief 更新目標參數函數 * @param x X軸目標座標 * @param y Y軸目標座標 * * 更新服務節點的目標位置參數 */ void Client::update_target_parameters(double x, double y) { // === 設置 X 座標參數 === auto param = rcl_interfaces::msg::Parameter(); param.name = \u0026#34;Target_X\u0026#34;; auto param_value = rcl_interfaces::msg::ParameterValue(); param_value.type = rcl_interfaces::msg::ParameterType::PARAMETER_DOUBLE; param_value.double_value = x; param.value = param_value; auto response = call_set_parameters(param); // 檢查X座標參數設置結果 if(response == nullptr) { RCLCPP_ERROR(this-\u0026gt;get_logger(), \u0026#34;Failed to update target parameters\u0026#34;); } else { for(auto result: response-\u0026gt;results) { if(result.successful) { RCLCPP_INFO(this-\u0026gt;get_logger(), \u0026#34;Target parameters updated successfully\u0026#34;); } else { RCLCPP_ERROR(this-\u0026gt;get_logger(), \u0026#34;Failed to update target parameters\u0026#34;); } } } // === 設置 Y 座標參數 === param.name = \u0026#34;Target_Y\u0026#34;; param_value.double_value = y; param.value = param_value; response = call_set_parameters(param); // 檢查Y座標參數設置結果 if(response == nullptr) { RCLCPP_ERROR(this-\u0026gt;get_logger(), \u0026#34;Failed to update target parameters\u0026#34;); } else { for(auto result: response-\u0026gt;results) { if(result.successful) { RCLCPP_INFO(this-\u0026gt;get_logger(), \u0026#34;Target parameters updated successfully\u0026#34;); } } } } /** * @brief 設置參數服務調用函數 * @param parameter 要設置的參數 * @return 參數設置響應 * * 調用服務節點的參數設置服務 */ std::shared_ptr\u0026lt;rcl_interfaces::srv::SetParameters::Response\u0026gt; Client::call_set_parameters(rcl_interfaces::msg::Parameter \u0026amp;parameter) { // 創建參數客戶端,連接到服務節點的參數服務 auto param_client = this-\u0026gt;create_client\u0026lt;rcl_interfaces::srv::SetParameters\u0026gt;(\u0026#34;/service_parameters_node/set_parameters\u0026#34;); // 等待服務可用,每秒檢查一次 while(!param_client-\u0026gt;wait_for_service(std::chrono::seconds(1))){ if(!rclcpp::ok()){ RCLCPP_ERROR(this-\u0026gt;get_logger(),\u0026#34;Interrupted while waiting for the service. Exiting.\u0026#34;); return nullptr; } RCLCPP_INFO(this-\u0026gt;get_logger(), \u0026#34;Service not available, waiting again...\u0026#34;); } // 發送參數設置請求 auto request = std::make_shared\u0026lt;rcl_interfaces::srv::SetParameters::Request\u0026gt;(); request-\u0026gt;parameters.push_back(parameter); auto future = param_client-\u0026gt;async_send_request(request); rclcpp::spin_until_future_complete(this-\u0026gt;get_node_base_interface(), future); auto response = future.get(); return response; } /** * @brief 定時回調函數 * * 定期生成隨機目標位置並發送巡邏請求 */ void Client::cb() { // 等待巡邏服務可用 while(!this-\u0026gt;client_-\u0026gt;wait_for_service(std::chrono::seconds(1))) { if(!rclcpp::ok()){ RCLCPP_ERROR(this-\u0026gt;get_logger(), \u0026#34;Interrupted while waiting for the service. Exiting.\u0026#34;); return; } RCLCPP_INFO(this-\u0026gt;get_logger(), \u0026#34;Service not available, waiting again...\u0026#34;); } this-\u0026gt;request_ = std::make_shared\u0026lt;patrol::srv::Patrol::Request\u0026gt;(); // === 生成隨機目標位置 === std::random_device rd; // 創建隨機數生成器 std::mt19937 gen(rd()); // 使用 Mersenne Twister 演算法 std::uniform_real_distribution\u0026lt;double\u0026gt; dis_float(1.0, 10.0); // 定義均勻分佈範圍 1.0-10.0 double random_float = dis_float(gen); // 設置請求的目標位置 this-\u0026gt;request_-\u0026gt;target_x = random_float = dis_float(gen); this-\u0026gt;request_-\u0026gt;target_y = random_float = dis_float(gen); RCLCPP_INFO(this-\u0026gt;get_logger(), \u0026#34;Requesting patrol to (%f, %f)\u0026#34;, this-\u0026gt;request_-\u0026gt;target_x, this-\u0026gt;request_-\u0026gt;target_y); // 發送異步請求並設置回調處理結果 auto result = this-\u0026gt;client_-\u0026gt;async_send_request(this-\u0026gt;request_, [this](rclcpp::Client\u0026lt;patrol::srv::Patrol\u0026gt;::SharedFuture future) -\u0026gt; void { auto response = future.get(); if(response-\u0026gt;result == patrol::srv::Patrol::Response::SUCCESS) { RCLCPP_INFO(this-\u0026gt;get_logger(), \u0026#34;Patrol to (%f, %f) successful\u0026#34;, this-\u0026gt;request_-\u0026gt;target_x, this-\u0026gt;request_-\u0026gt;target_y); } else { RCLCPP_ERROR(this-\u0026gt;get_logger(), \u0026#34;Patrol to (%f, %f) failed\u0026#34;, this-\u0026gt;request_-\u0026gt;target_x, this-\u0026gt;request_-\u0026gt;target_y); } }); } /** * @brief 主函數 * * 初始化ROS2系統,創建並運行客戶端節點 */ int main(int argc, char **argv) { rclcpp::init(argc, argv); // 初始化 ROS2 系統 auto client = std::make_shared\u0026lt;Client\u0026gt;(\u0026#34;client_parameters_node\u0026#34;); // 創建客戶端節點 client-\u0026gt;update_target_parameters(10.0, 10.0); // 設置初始目標參數 rclcpp::spin(client); // 運行節點,處理回調 rclcpp::shutdown(); // 關閉 ROS2 系統 return 0; } 2.2 參數服務端程式碼 (service_parameters.cpp) #\r// ===== 包含必要的標頭檔 ===== #include \u0026#34;rclcpp/rclcpp.hpp\u0026#34; // ROS2 C++ 客戶端庫 #include \u0026#34;patrol/srv/patrol.hpp\u0026#34; // 巡邏服務介面 #include \u0026#34;geometry_msgs/msg/pose.hpp\u0026#34; // 位置訊息 #include \u0026#34;turtlesim/msg/pose.hpp\u0026#34; // turtlesim 位置訊息 #include \u0026#34;geometry_msgs/msg/twist.hpp\u0026#34; // 速度訊息 #include \u0026#34;rcl_interfaces/msg/parameter_descriptor.hpp\u0026#34; // 參數描述符 #include \u0026#34;rcl_interfaces/msg/parameter_type.hpp\u0026#34; // 參數類型 /** * @brief 參數服務節點類別 * * 此類別繼承自 rclcpp::Node,實現了一個帶參數的ROS2服務節點 */ class ServiceParameters : public rclcpp::Node { private: // 成員變量 double targetX_ {1.0}; // 目標 X 座標 double targetY_ {1.0}; // 目標 Y 座標 // ROS2 通信組件 rclcpp::Service\u0026lt;patrol::srv::Patrol\u0026gt;::SharedPtr service_; // 巡邏服務 turtlesim::msg::Pose::SharedPtr turtlePose_; // 當前位置 rclcpp::Subscription\u0026lt;turtlesim::msg::Pose\u0026gt;::SharedPtr turtlePoseSub_; // 位置訂閱者 rclcpp::Publisher\u0026lt;geometry_msgs::msg::Twist\u0026gt;::SharedPtr publisher_; // 速度發布者 // 參數回調函數 OnSetParametersCallbackHandle::SharedPtr parameter_callback_handle_; public: // 建構函數 ServiceParameters(std::string nodeName) : Node(nodeName) { // 宣告並註冊參數 rcl_interfaces::msg::ParameterDescriptor descriptor; descriptor.description = \u0026#34;Target position parameter\u0026#34;; descriptor.read_only = false; this-\u0026gt;declare_parameter(\u0026#34;Target_X\u0026#34;, 1.0, descriptor); this-\u0026gt;declare_parameter(\u0026#34;Target_Y\u0026#34;, 1.0, descriptor); // 設置參數回調 parameter_callback_handle_ = this-\u0026gt;add_on_set_parameters_callback( std::bind(\u0026amp;ServiceParameters::parametersCallback, this, std::placeholders::_1)); // 創建位置訂閱者 turtlePoseSub_ = this-\u0026gt;create_subscription\u0026lt;turtlesim::msg::Pose\u0026gt;( \u0026#34;/turtle1/pose\u0026#34;, 10, [this](const turtlesim::msg::Pose::SharedPtr msg) { turtlePose_ = msg; move_to_target(turtlePose_-\u0026gt;x, turtlePose_-\u0026gt;y); } ); // 創建速度發布者 publisher_ = this-\u0026gt;create_publisher\u0026lt;geometry_msgs::msg::Twist\u0026gt;(\u0026#34;/turtle1/cmd_vel\u0026#34;, 10); // 創建服務 service_ = this-\u0026gt;create_service\u0026lt;patrol::srv::Patrol\u0026gt;( \u0026#34;patrol\u0026#34;, std::bind(\u0026amp;ServiceParameters::handle_patrol, this, std::placeholders::_1, std::placeholders::_2) ); } // 參數回調函數 rcl_interfaces::msg::SetParametersResult parametersCallback( const std::vector\u0026lt;rclcpp::Parameter\u0026gt; \u0026amp;parameters) { rcl_interfaces::msg::SetParametersResult result; result.successful = true; for(const auto \u0026amp;param : parameters) { if(param.get_name() == \u0026#34;Target_X\u0026#34;) { targetX_ = param.as_double(); RCLCPP_INFO(this-\u0026gt;get_logger(), \u0026#34;Target_X updated to: %f\u0026#34;, targetX_); } else if(param.get_name() == \u0026#34;Target_Y\u0026#34;) { targetY_ = param.as_double(); RCLCPP_INFO(this-\u0026gt;get_logger(), \u0026#34;Target_Y updated to: %f\u0026#34;, targetY_); } } return result; } // 服務回調函數 void handle_patrol( const std::shared_ptr\u0026lt;patrol::srv::Patrol::Request\u0026gt; request, const std::shared_ptr\u0026lt;patrol::srv::Patrol::Response\u0026gt; response) { if((request-\u0026gt;target_x \u0026gt; 0.0f \u0026amp;\u0026amp; request-\u0026gt;target_x \u0026lt; 12.0f) \u0026amp;\u0026amp; (request-\u0026gt;target_y \u0026gt; 0.0f \u0026amp;\u0026amp; request-\u0026gt;target_y \u0026lt; 12.0f)) { targetX_ = request-\u0026gt;target_x; targetY_ = request-\u0026gt;target_y; response-\u0026gt;result = patrol::srv::Patrol::Response::SUCCESS; } else { response-\u0026gt;result = patrol::srv::Patrol::Response::FAIL; } } // 移動控制函數 void move_to_target(double currentX, double currentY) { auto twist = geometry_msgs::msg::Twist(); double dx = targetX_ - currentX; double dy = targetY_ - currentY; double distance = std::sqrt(dx * dx + dy * dy); double target_angle = std::atan2(dy, dx); double angle_diff = target_angle - turtlePose_-\u0026gt;theta; if (distance \u0026gt; 0.1) { if(fabs(angle_diff) \u0026gt; 0.2) { twist.angular.z = 1.0 * angle_diff; } else { twist.linear.x = 0.5 * distance; } RCLCPP_INFO(this-\u0026gt;get_logger(), \u0026#34;Moving to target: (%f, %f), current: (%f, %f)\u0026#34;, targetX_, targetY_, currentX, currentY); publisher_-\u0026gt;publish(twist); } } }; // 主函數 int main(int argc, char **argv) { rclcpp::init(argc, argv); auto node = std::make_shared\u0026lt;ServiceParameters\u0026gt;(\u0026#34;service_parameters_node\u0026#34;); rclcpp::spin(node); rclcpp::shutdown(); return 0; } 3. 參數說明 #\r3.1 動態參數 #\r在本專案中，我們實現了以下動態參數：\n目標位置參數 Target_X：目標 X 座標 Target_Y：目標 Y 座標 這些參數可以在運行時動態修改，使系統更具彈性。\n3.2 參數更新機制 #\rvoid Client::update_target_parameters(double x, double y) { // 創建並設定 X 座標參數 auto param = rcl_interfaces::msg::Parameter(); param.name = \u0026#34;Target_X\u0026#34;; auto param_value = rcl_interfaces::msg::ParameterValue(); param_value.type = rcl_interfaces::msg::ParameterType::PARAMETER_DOUBLE; param_value.double_value = x; param.value = param_value; // ... [更多實現細節] } 4. 配置文件說明 #\r4.1 CMakeLists.txt #\r# 指定 CMake 最低版本要求 cmake_minimum_required(VERSION 3.8) # 定義專案名稱 project(patrol_parameters) # 如果使用 GCC 或 Clang 編譯器，添加編譯警告選項 if(CMAKE_COMPILER_IS_GNUCXX OR CMAKE_CXX_COMPILER_ID MATCHES \u0026#34;Clang\u0026#34;) add_compile_options(-Wall -Wextra -Wpedantic) endif() # 尋找並載入所需的依賴套件 find_package(ament_cmake REQUIRED) # ROS 2 CMake 工具 find_package(rclcpp REQUIRED) # ROS 2 C++ 客戶端程式庫 find_package(std_msgs REQUIRED) # 標準訊息類型 find_package(rosidl_default_generators REQUIRED)# 服務介面生成器 find_package(turtlesim REQUIRED) # 烏龜模擬器套件 find_package(geometry_msgs REQUIRED) # 幾何訊息類型 find_package(patrol REQUIRED) # 巡邏服務介面 find_package(rcl_interfaces REQUIRED) # ROS2 參數介面 # 創建可執行檔 add_executable(service_parameters_node src/service_parameters.cpp) add_executable(client_parameters_node src/client_parameters.cpp) # 為可執行檔添加依賴 ament_target_dependencies(service_parameters_node rclcpp # ROS 2 C++ 客戶端程式庫 std_msgs # 標準訊息類型 geometry_msgs # 幾何訊息類型 turtlesim # 烏龜模擬器套件 patrol # 巡邏服務介面 rcl_interfaces # ROS2 參數介面 ) ament_target_dependencies(client_parameters_node rclcpp # ROS 2 C++ 客戶端程式庫 std_msgs # 標準訊息類型 geometry_msgs # 幾何訊息類型 turtlesim # 烏龜模擬器套件 patrol # 巡邏服務介面 rcl_interfaces # ROS2 參數介面 ) # 安裝可執行檔到指定目錄 install(TARGETS service_parameters_node client_parameters_node DESTINATION lib/${PROJECT_NAME} ) # 完成 ament 套件的配置 ament_package() 4.2 package.xml #\r\u0026lt;?xml version=\u0026#34;1.0\u0026#34;?\u0026gt; \u0026lt;!-- 指定 XML 模式定義（XSD）檔案的位置，用於驗證此檔案的格式 --\u0026gt; \u0026lt;?xml-model href=\u0026#34;http://download.ros.org/schema/package_format3.xsd\u0026#34; schematypens=\u0026#34;http://www.w3.org/2001/XMLSchema\u0026#34;?\u0026gt; \u0026lt;!-- ROS 2 套件配置檔案，使用格式版本 3 --\u0026gt; \u0026lt;package format=\u0026#34;3\u0026#34;\u0026gt; \u0026lt;!-- 套件基本資訊 --\u0026gt; \u0026lt;name\u0026gt;patrol_parameters\u0026lt;/name\u0026gt; \u0026lt;!-- 套件名稱 --\u0026gt; \u0026lt;version\u0026gt;0.0.0\u0026lt;/version\u0026gt; \u0026lt;!-- 套件版本 --\u0026gt; \u0026lt;description\u0026gt;ROS2 巡邏服務節點（帶參數）\u0026lt;/description\u0026gt; \u0026lt;!-- 套件描述 --\u0026gt; \u0026lt;maintainer email=\u0026#34;tienyao@todo.todo\u0026#34;\u0026gt;tienyao\u0026lt;/maintainer\u0026gt; \u0026lt;!-- 維護者資訊 --\u0026gt; \u0026lt;license\u0026gt;TODO: License declaration\u0026lt;/license\u0026gt; \u0026lt;!-- 授權聲明 --\u0026gt; \u0026lt;!-- 建構工具依賴 --\u0026gt; \u0026lt;buildtool_depend\u0026gt;ament_cmake\u0026lt;/buildtool_depend\u0026gt; \u0026lt;!-- 使用 ament_cmake 作為建構工具 --\u0026gt; \u0026lt;!-- 建構時依賴 --\u0026gt; \u0026lt;build_depend\u0026gt;rosidl_default_generators\u0026lt;/build_depend\u0026gt;\u0026lt;!-- 用於生成介面檔案 --\u0026gt; \u0026lt;!-- 執行時依賴 --\u0026gt; \u0026lt;exec_depend\u0026gt;rosidl_default_runtime\u0026lt;/exec_depend\u0026gt; \u0026lt;!-- 執行時需要的介面運行庫 --\u0026gt; \u0026lt;!-- 建構和執行都需要的依賴 --\u0026gt; \u0026lt;depend\u0026gt;rclcpp\u0026lt;/depend\u0026gt; \u0026lt;!-- ROS 2 C++ 客戶端程式庫 --\u0026gt; \u0026lt;depend\u0026gt;std_msgs\u0026lt;/depend\u0026gt; \u0026lt;!-- 標準訊息類型 --\u0026gt; \u0026lt;depend\u0026gt;turtlesim\u0026lt;/depend\u0026gt; \u0026lt;!-- 烏龜模擬器套件 --\u0026gt; \u0026lt;depend\u0026gt;geometry_msgs\u0026lt;/depend\u0026gt; \u0026lt;!-- 幾何訊息類型 --\u0026gt; \u0026lt;depend\u0026gt;patrol\u0026lt;/depend\u0026gt; \u0026lt;!-- 巡邏服務介面 --\u0026gt; \u0026lt;depend\u0026gt;rcl_interfaces\u0026lt;/depend\u0026gt; \u0026lt;!-- ROS2 參數介面 --\u0026gt; \u0026lt;!-- 測試相關依賴 --\u0026gt; \u0026lt;test_depend\u0026gt;ament_lint_auto\u0026lt;/test_depend\u0026gt; \u0026lt;!-- 自動化程式碼檢查工具 --\u0026gt; \u0026lt;test_depend\u0026gt;ament_lint_common\u0026lt;/test_depend\u0026gt; \u0026lt;!-- 常用程式碼檢查規則 --\u0026gt; \u0026lt;!-- ROS 2 套件特定資訊 --\u0026gt; \u0026lt;export\u0026gt; \u0026lt;build_type\u0026gt;ament_cmake\u0026lt;/build_type\u0026gt; \u0026lt;!-- 指定使用 ament_cmake 建構系統 --\u0026gt; \u0026lt;/export\u0026gt; \u0026lt;/package\u0026gt; 執行方式 #\r編譯專案 cd ros2_ws colcon build --packages-select patrol_parameters 執行節點 # 終端機 1：啟動 turtlesim ros2 run turtlesim turtlesim_node # 終端機 2：啟動參數服務端 ros2 run patrol_parameters service_parameters_node # 終端機 3：啟動參數客戶端 ros2 run patrol_parameters client_parameters_node 使用 ROS2 指令查看和設定參數 #\r列出所有參數 ros2 param list 查看特定參數值 ros2 param get /service_parameters_node Target_X ros2 param get /service_parameters_node Target_Y 手動設定參數 ros2 param set /service_parameters_node Target_X 5.0 ros2 param set /service_parameters_node Target_Y 5.0 技術要點說明 #\r參數服務機制\n使用 ROS2 參數服務進行動態配置 支援參數的即時更新和監控 提供參數變更的回調機制 非同步通信\n使用非同步方式發送參數更新請求 處理參數更新的回應和錯誤情況 確保系統的穩定性和可靠性 錯誤處理\n檢查參數更新的結果 提供詳細的錯誤日誌 確保系統的健壯性 參考資源 #\rROS2 Parameters 教程 ROS2 Services 教程 結語 #\r透過這個專案，我們學習了如何在 ROS2 中使用參數服務來實現動態配置。結合參數和服務的機制，使得系統更加靈活且易於管理。完整的程式碼實現和詳細的注解，有助於理解 ROS2 的參數機制和實作方法。\n","date":"11 February 2025","externalUrl":null,"permalink":"/posts/ros2_patrol_parameter/","section":"Posts","summary":"\u003ch1 class=\"relative group\"\u003e🐢 ROS2 巡邏服務節點開發教學(使用 Parameters) \r\n    \u003cdiv id=\"-ros2-%E5%B7%A1%E9%82%8F%E6%9C%8D%E5%8B%99%E7%AF%80%E9%BB%9E%E9%96%8B%E7%99%BC%E6%95%99%E5%AD%B8%E4%BD%BF%E7%94%A8-parameters\" class=\"anchor\"\u003e\u003c/div\u003e\r\n    \r\n    \u003cspan\r\n        class=\"absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100\"\u003e\r\n        \u003ca class=\"group-hover:text-primary-300 dark:group-hover:text-neutral-700\"\r\n            style=\"text-decoration-line: none !important;\" href=\"#-ros2-%E5%B7%A1%E9%82%8F%E6%9C%8D%E5%8B%99%E7%AF%80%E9%BB%9E%E9%96%8B%E7%99%BC%E6%95%99%E5%AD%B8%E4%BD%BF%E7%94%A8-parameters\" aria-label=\"Anchor\"\u003e#\u003c/a\u003e\r\n    \u003c/span\u003e        \r\n    \r\n\u003c/h1\u003e\r\n\r\n\r\n\u003ch2 class=\"relative group\"\u003e前言 \r\n    \u003cdiv id=\"%E5%89%8D%E8%A8%80\" class=\"anchor\"\u003e\u003c/div\u003e\r\n    \r\n    \u003cspan\r\n        class=\"absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100\"\u003e\r\n        \u003ca class=\"group-hover:text-primary-300 dark:group-hover:text-neutral-700\"\r\n            style=\"text-decoration-line: none !important;\" href=\"#%E5%89%8D%E8%A8%80\" aria-label=\"Anchor\"\u003e#\u003c/a\u003e\r\n    \u003c/span\u003e        \r\n    \r\n\u003c/h2\u003e\r\n\u003cp\u003e在本篇文章中，我們將基於之前的巡邏服務節點，加入 ROS2 的參數功能。透過參數服務，我們可以動態地修改和監控節點的行為，使系統更加靈活。這個專案展示了如何在 ROS2 中實現參數的設定和使用，以及如何結合服務端（Server）和客戶端（Client）的通信。\u003c/p\u003e","title":"🐢 ROS2 巡邏服務節點開發教學(使用 Parameters)","type":"posts"},{"content":"","date":"11 February 2025","externalUrl":null,"permalink":"/tags/parameters/","section":"Tags","summary":"","title":"Parameters","type":"tags"},{"content":"\r🐢 ROS2 巡邏服務節點開發教學(使用 Service 和 Client) #\r前言 #\r在本篇文章中，我們將實作一個 ROS2 的巡邏服務節點，透過 Service 和 Topic 的結合來控制 turtlesim 中的烏龜移動到指定位置。這個專案展示了如何在 ROS2 中實現服務端（Server）和客戶端（Client）的通信，以及基本的運動控制。\n專案架構 #\r1. 檔案結構 #\rpatrol/\r├── CMakeLists.txt # 構建配置文件\r├── package.xml # 包配置文件\r├── src/\r│ ├── service.cpp # 服務端節點實現\r│ └── client.cpp # 客戶端節點實現\r└── srv/\r└── Patrol.srv # 服務介面定義 2. 服務介面定義 #\r# Patrol.srv\rfloat64 target_x # 目標 X 座標\rfloat64 target_y # 目標 Y 座標\r---\rint8 SUCCESS = 1 # 成功狀態碼\rint8 FAIL = 0 # 失敗狀態碼\rint8 result # 執行結果 3. 完整程式碼實現 #\r3.1 服務端程式碼 (service.cpp) #\r// 包含必要的標頭文件 #include \u0026#34;rclcpp/rclcpp.hpp\u0026#34; // ROS2 C++ 客戶端庫 #include \u0026#34;patrol/srv/patrol.hpp\u0026#34; // 生成的服務介面 #include \u0026#34;geometry_msgs/msg/pose.hpp\u0026#34; // 位置訊息 #include \u0026#34;turtlesim/msg/pose.hpp\u0026#34; // turtlesim 位置訊息 #include \u0026#34;geometry_msgs/msg/twist.hpp\u0026#34; // 速度訊息 // 巡邏服務節點類別，繼承自 rclcpp::Node class PatrolService: public rclcpp::Node { private: // 成員變量 double targetX_ {1.0}; // 目標 X 座標，預設值為 1.0 double targetY_ {1.0}; // 目標 Y 座標，預設值為 1.0 // ROS2 通信組件 rclcpp::Service\u0026lt;patrol::srv::Patrol\u0026gt;::SharedPtr service_; // 巡邏服務 turtlesim::msg::Pose::SharedPtr turtlePose_; // 儲存烏龜當前位置 rclcpp::Subscription\u0026lt;turtlesim::msg::Pose\u0026gt;::SharedPtr turtlePoseSub_; // 訂閱烏龜位置 rclcpp::Publisher\u0026lt;geometry_msgs::msg::Twist\u0026gt;::SharedPtr publisher_; // 發布速度命令 public: // 建構函數，初始化節點 PatrolService(std::string nodeName); // 解構函數，使用預設實作 ~PatrolService() = default; // 處理巡邏服務請求的回調函數 void handle_patrol(const std::shared_ptr\u0026lt;patrol::srv::Patrol::Request\u0026gt; request, const std::shared_ptr\u0026lt;patrol::srv::Patrol::Response\u0026gt; response); // 控制烏龜移動到目標位置的函數 void move_to_target(double targetX, double targetY); }; // 建構函數實現 PatrolService::PatrolService(std::string nodeName): Node(nodeName) { // 創建位置訂閱者，訂閱烏龜的位置資訊 turtlePoseSub_ = this-\u0026gt;create_subscription\u0026lt;turtlesim::msg::Pose\u0026gt;( \u0026#34;/turtle1/pose\u0026#34;, // 話題名稱 10, // QoS 設定 [this](const turtlesim::msg::Pose::SharedPtr msg) { // 回調函數 turtlePose_ = msg; // 更新烏龜位置 move_to_target(turtlePose_-\u0026gt;x, turtlePose_-\u0026gt;y); // 執行移動控制 } ); // 創建速度發布者，用於發送移動命令 publisher_ = this-\u0026gt;create_publisher\u0026lt;geometry_msgs::msg::Twist\u0026gt;(\u0026#34;/turtle1/cmd_vel\u0026#34;, 10); // 創建巡邏服務 service_ = this-\u0026gt;create_service\u0026lt;patrol::srv::Patrol\u0026gt;( \u0026#34;patrol\u0026#34;, // 服務名稱 std::bind(\u0026amp;PatrolService::handle_patrol, this, std::placeholders::_1, std::placeholders::_2) // 服務回調函數 ); } // 服務回調函數實現 void PatrolService::handle_patrol( const std::shared_ptr\u0026lt;patrol::srv::Patrol::Request\u0026gt; request, const std::shared_ptr\u0026lt;patrol::srv::Patrol::Response\u0026gt; response) { // 檢查目標座標是否在有效範圍內（0-12之間） if((request-\u0026gt;target_x \u0026gt; 0.0f \u0026amp;\u0026amp; request-\u0026gt;target_x \u0026lt; 12.0f) \u0026amp;\u0026amp; (request-\u0026gt;target_y \u0026gt; 0.0f \u0026amp;\u0026amp; request-\u0026gt;target_y \u0026lt; 12.0f)) { // 更新目標位置 targetX_ = request-\u0026gt;target_x; targetY_ = request-\u0026gt;target_y; response-\u0026gt;result = patrol::srv::Patrol::Response::SUCCESS; // 設置成功狀態 } else { // 座標無效，設置失敗狀態 response-\u0026gt;result = patrol::srv::Patrol::Response::FAIL; } } // 移動控制函數實現 void PatrolService::move_to_target(double currentX, double currentY) { // 創建速度訊息物件 auto twist = geometry_msgs::msg::Twist(); // 計算當前位置到目標位置的差值 double dx = targetX_ - currentX; double dy = targetY_ - currentY; // 計算距離 double distance = std::sqrt(dx * dx + dy * dy); // 計算目標角度（使用 atan2 確保角度在正確的象限） double target_angle = std::atan2(dy, dx); // 計算角度差 double angle_diff = target_angle - turtlePose_-\u0026gt;theta; // 如果距離大於閾值（0.1），則繼續移動 if (distance \u0026gt; 0.1) { // 如果角度差大於閾值，優先調整方向 if(fabs(angle_diff) \u0026gt; 0.2) { twist.angular.z = 1.0 * angle_diff; // 角速度與角度差成正比 } else { twist.linear.x = 0.5 * distance; // 線速度與距離成正比 } // 輸出當前位置資訊，用於除錯 RCLCPP_INFO(this-\u0026gt;get_logger(), \u0026#34;currentX: %f, currentY: %f\u0026#34;, currentX, currentY); // 發布速度命令 publisher_-\u0026gt;publish(twist); } } // 主函數 int main(int argc, char **argv) { rclcpp::init(argc, argv); // 初始化 ROS2 auto node = std::make_shared\u0026lt;PatrolService\u0026gt;(\u0026#34;patrol_service_node\u0026#34;); // 創建服務節點 rclcpp::spin(node); // 運行節點 rclcpp::shutdown(); // 關閉 ROS2 return 0; } 3.2 客戶端程式碼 (client.cpp) #\r#include \u0026#34;rclcpp/rclcpp.hpp\u0026#34; // ROS2 C++ 客戶端庫 #include \u0026#34;patrol/srv/patrol.hpp\u0026#34; // 生成的服務介面 #include \u0026#34;rclcpp/time.hpp\u0026#34; // 時間相關功能 #include \u0026lt;random\u0026gt; // 隨機數生成 // 巡邏客戶端類別，繼承自 rclcpp::Node class Client: public rclcpp::Node { private: // ROS2 通信組件 rclcpp::Client\u0026lt;patrol::srv::Patrol\u0026gt;::SharedPtr client_; // 服務客戶端 std::shared_ptr\u0026lt;patrol::srv::Patrol::Request\u0026gt; request_; // 請求物件 rclcpp::TimerBase::SharedPtr timer_; // 定時器 public: // 建構函數，初始化節點 Client(std::string nodeName): Node(nodeName) { // 創建服務客戶端 this-\u0026gt;client_ = this-\u0026gt;create_client\u0026lt;patrol::srv::Patrol\u0026gt;(\u0026#34;patrol\u0026#34;); RCLCPP_INFO(this-\u0026gt;get_logger(), \u0026#34;Client has been created\u0026#34;); // 創建定時器，每5秒發送一次請求 this-\u0026gt;timer_ = this-\u0026gt;create_wall_timer( std::chrono::seconds(5), std::bind(\u0026amp;Client::cb, this) ); } // 解構函數，使用預設實作 ~Client() = default; // 定時器回調函數 void cb() { // 等待服務可用 while(!this-\u0026gt;client_-\u0026gt;wait_for_service(std::chrono::seconds(1))) { if(!rclcpp::ok()){ RCLCPP_ERROR(this-\u0026gt;get_logger(), \u0026#34;Interrupted while waiting for the service. Exiting.\u0026#34;); return; } RCLCPP_INFO(this-\u0026gt;get_logger(), \u0026#34;Service not available, waiting again...\u0026#34;); } // 創建請求物件 this-\u0026gt;request_ = std::make_shared\u0026lt;patrol::srv::Patrol::Request\u0026gt;(); // 生成隨機目標位置 std::random_device rd; std::mt19937 gen(rd()); std::uniform_real_distribution\u0026lt;double\u0026gt; dis_float(1.0, 10.0); // 設置隨機目標位置 this-\u0026gt;request_-\u0026gt;target_x = dis_float(gen); this-\u0026gt;request_-\u0026gt;target_y = dis_float(gen); // 輸出請求資訊 RCLCPP_INFO(this-\u0026gt;get_logger(), \u0026#34;Requesting patrol to (%f, %f)\u0026#34;, this-\u0026gt;request_-\u0026gt;target_x, this-\u0026gt;request_-\u0026gt;target_y); // 發送非同步請求 auto result = this-\u0026gt;client_-\u0026gt;async_send_request( this-\u0026gt;request_, [this](rclcpp::Client\u0026lt;patrol::srv::Patrol\u0026gt;::SharedFuture future) { auto response = future.get(); if(response-\u0026gt;result == patrol::srv::Patrol::Response::SUCCESS) { RCLCPP_INFO(this-\u0026gt;get_logger(), \u0026#34;Patrol to (%f, %f) successful\u0026#34;, this-\u0026gt;request_-\u0026gt;target_x, this-\u0026gt;request_-\u0026gt;target_y); } else { RCLCPP_ERROR(this-\u0026gt;get_logger(), \u0026#34;Patrol to (%f, %f) failed\u0026#34;, this-\u0026gt;request_-\u0026gt;target_x, this-\u0026gt;request_-\u0026gt;target_y); } } ); } }; // 主函數 int main(int argc, char **argv) { rclcpp::init(argc, argv); // 初始化 ROS2 auto client = std::make_shared\u0026lt;Client\u0026gt;(\u0026#34;patrol_client_node\u0026#34;); // 創建客戶端節點 rclcpp::spin(client); // 運行節點 rclcpp::shutdown(); // 關閉 ROS2 return 0; } 4. 配置文件說明 #\r4.1 CMakeLists.txt #\r# 指定 CMake 最低版本要求 cmake_minimum_required(VERSION 3.8) # 定義專案名稱 project(patrol) # 如果使用 GCC 或 Clang 編譯器，添加編譯警告選項 if(CMAKE_COMPILER_IS_GNUCXX OR CMAKE_CXX_COMPILER_ID MATCHES \u0026#34;Clang\u0026#34;) add_compile_options(-Wall -Wextra -Wpedantic) endif() # 尋找並載入所需的依賴套件 find_package(ament_cmake REQUIRED) # ROS 2 CMake 工具 find_package(rclcpp REQUIRED) # ROS 2 C++ 客戶端程式庫 find_package(std_msgs REQUIRED) # 標準訊息類型 find_package(rosidl_default_generators REQUIRED)# 服務介面生成器 find_package(turtlesim REQUIRED) # 烏龜模擬器套件 find_package(geometry_msgs REQUIRED) # 幾何訊息類型 # 生成服務介面 rosidl_generate_interfaces(${PROJECT_NAME} \u0026#34;srv/Patrol.srv\u0026#34; ) # 創建可執行檔 add_executable(service_node src/service.cpp) # 為可執行檔添加依賴 ament_target_dependencies(service_node rclcpp # ROS 2 C++ 客戶端程式庫 std_msgs # 標準訊息類型 geometry_msgs # 幾何訊息類型 turtlesim # 烏龜模擬器套件 ) # 安裝可執行檔到指定目錄 install(TARGETS service_node DESTINATION lib/${PROJECT_NAME} ) # 完成 ament 套件的配置 ament_package() 4.2 package.xml #\r\u0026lt;?xml version=\u0026#34;1.0\u0026#34;?\u0026gt; \u0026lt;!-- 指定 XML 模式定義（XSD）檔案的位置，用於驗證此檔案的格式 --\u0026gt; \u0026lt;?xml-model href=\u0026#34;http://download.ros.org/schema/package_format3.xsd\u0026#34; schematypens=\u0026#34;http://www.w3.org/2001/XMLSchema\u0026#34;?\u0026gt; \u0026lt;!-- ROS 2 套件配置檔案，使用格式版本 3 --\u0026gt; \u0026lt;package format=\u0026#34;3\u0026#34;\u0026gt; \u0026lt;!-- 套件基本資訊 --\u0026gt; \u0026lt;name\u0026gt;patrol\u0026lt;/name\u0026gt; \u0026lt;!-- 套件名稱 --\u0026gt; \u0026lt;version\u0026gt;0.0.0\u0026lt;/version\u0026gt; \u0026lt;!-- 套件版本 --\u0026gt; \u0026lt;description\u0026gt;TODO: Package description\u0026lt;/description\u0026gt; \u0026lt;!-- 套件描述 --\u0026gt; \u0026lt;maintainer email=\u0026#34;tienyao@todo.todo\u0026#34;\u0026gt;tienyao\u0026lt;/maintainer\u0026gt; \u0026lt;!-- 維護者資訊 --\u0026gt; \u0026lt;license\u0026gt;TODO: License declaration\u0026lt;/license\u0026gt; \u0026lt;!-- 授權聲明 --\u0026gt; \u0026lt;!-- 建構工具依賴 --\u0026gt; \u0026lt;buildtool_depend\u0026gt;ament_cmake\u0026lt;/buildtool_depend\u0026gt; \u0026lt;!-- 使用 ament_cmake 作為建構工具 --\u0026gt; \u0026lt;!-- 建構時依賴 --\u0026gt; \u0026lt;build_depend\u0026gt;rosidl_default_generators\u0026lt;/build_depend\u0026gt;\u0026lt;!-- 用於生成介面檔案 --\u0026gt; \u0026lt;!-- 執行時依賴 --\u0026gt; \u0026lt;exec_depend\u0026gt;rosidl_default_runtime\u0026lt;/exec_depend\u0026gt; \u0026lt;!-- 執行時需要的介面運行庫 --\u0026gt; \u0026lt;!-- 建構和執行都需要的依賴 --\u0026gt; \u0026lt;depend\u0026gt;rclcpp\u0026lt;/depend\u0026gt; \u0026lt;!-- ROS 2 C++ 客戶端程式庫 --\u0026gt; \u0026lt;depend\u0026gt;std_msgs\u0026lt;/depend\u0026gt; \u0026lt;!-- 標準訊息類型 --\u0026gt; \u0026lt;depend\u0026gt;turtlesim\u0026lt;/depend\u0026gt; \u0026lt;!-- 烏龜模擬器套件 --\u0026gt; \u0026lt;depend\u0026gt;geometry_msgs\u0026lt;/depend\u0026gt; \u0026lt;!-- 幾何訊息類型 --\u0026gt; \u0026lt;!-- 聲明此套件是一個介面套件 --\u0026gt; \u0026lt;member_of_group\u0026gt;rosidl_interface_packages\u0026lt;/member_of_group\u0026gt; \u0026lt;!-- 測試相關依賴 --\u0026gt; \u0026lt;test_depend\u0026gt;ament_lint_auto\u0026lt;/test_depend\u0026gt; \u0026lt;!-- 自動化程式碼檢查工具 --\u0026gt; \u0026lt;test_depend\u0026gt;ament_lint_common\u0026lt;/test_depend\u0026gt; \u0026lt;!-- 常用程式碼檢查規則 --\u0026gt; \u0026lt;!-- ROS 2 套件特定資訊 --\u0026gt; \u0026lt;export\u0026gt; \u0026lt;build_type\u0026gt;ament_cmake\u0026lt;/build_type\u0026gt; \u0026lt;!-- 指定使用 ament_cmake 建構系統 --\u0026gt; \u0026lt;/export\u0026gt; \u0026lt;/package\u0026gt; 執行方式 #\r編譯專案 cd ros2_ws colcon build --packages-select patrol 執行節點 # 終端機 1：啟動 turtlesim ros2 run turtlesim turtlesim_node # 終端機 2：啟動巡邏服務端 ros2 run patrol service_node # 終端機 3：啟動巡邏客戶端 ros2 run patrol client_node 結語 #\r透過這個專案，我們學習了如何在 ROS2 中結合 Service 和 Client 來實現機器人的隨機運動控制。這種結合不同通信機制的方式，能夠更靈活地處理各種控制需求。完整的程式碼實現和詳細的注解，有助於理解 ROS2 的核心概念和實作方法。\n","date":"11 February 2025","externalUrl":null,"permalink":"/posts/ros2_node_srvice_client/","section":"Posts","summary":"\u003ch1 class=\"relative group\"\u003e🐢 ROS2 巡邏服務節點開發教學(使用 Service 和 Client) \r\n    \u003cdiv id=\"-ros2-%E5%B7%A1%E9%82%8F%E6%9C%8D%E5%8B%99%E7%AF%80%E9%BB%9E%E9%96%8B%E7%99%BC%E6%95%99%E5%AD%B8%E4%BD%BF%E7%94%A8-service-%E5%92%8C-client\" class=\"anchor\"\u003e\u003c/div\u003e\r\n    \r\n    \u003cspan\r\n        class=\"absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100\"\u003e\r\n        \u003ca class=\"group-hover:text-primary-300 dark:group-hover:text-neutral-700\"\r\n            style=\"text-decoration-line: none !important;\" href=\"#-ros2-%E5%B7%A1%E9%82%8F%E6%9C%8D%E5%8B%99%E7%AF%80%E9%BB%9E%E9%96%8B%E7%99%BC%E6%95%99%E5%AD%B8%E4%BD%BF%E7%94%A8-service-%E5%92%8C-client\" aria-label=\"Anchor\"\u003e#\u003c/a\u003e\r\n    \u003c/span\u003e        \r\n    \r\n\u003c/h1\u003e\r\n\r\n\r\n\u003ch2 class=\"relative group\"\u003e前言 \r\n    \u003cdiv id=\"%E5%89%8D%E8%A8%80\" class=\"anchor\"\u003e\u003c/div\u003e\r\n    \r\n    \u003cspan\r\n        class=\"absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100\"\u003e\r\n        \u003ca class=\"group-hover:text-primary-300 dark:group-hover:text-neutral-700\"\r\n            style=\"text-decoration-line: none !important;\" href=\"#%E5%89%8D%E8%A8%80\" aria-label=\"Anchor\"\u003e#\u003c/a\u003e\r\n    \u003c/span\u003e        \r\n    \r\n\u003c/h2\u003e\r\n\u003cp\u003e在本篇文章中，我們將實作一個 ROS2 的巡邏服務節點，透過 Service 和 Topic 的結合來控制 turtlesim 中的烏龜移動到指定位置。這個專案展示了如何在 ROS2 中實現服務端（Server）和客戶端（Client）的通信，以及基本的運動控制。\u003c/p\u003e","title":"🐢 ROS2 巡邏服務節點開發教學(使用 Service 和 Client)","type":"posts"},{"content":"","date":"11 February 2025","externalUrl":null,"permalink":"/tags/client/","section":"Tags","summary":"","title":"Client","type":"tags"},{"content":"","date":"11 February 2025","externalUrl":null,"permalink":"/tags/service/","section":"Tags","summary":"","title":"Service","type":"tags"},{"content":"\r🔢 數位除法器設計與實現 - 基於FPGA的移位除法算法 #\r前言 #\r在數位電路設計中，除法運算是一個重要但相對複雜的算術操作。本文將介紹一個基於FPGA的32位元除法器設計，採用移位除法算法實現。這個設計不僅具有良好的可擴展性，還提供了完整的測試驗證平台。\n一、設計目標 #\r實現32位元無號數除法運算 支援可參數化的資料位寬 提供完整的控制機制 確保運算結果的準確性 二、設計架構 #\r2.1 模組說明 #\rdiv_go_tick: 啟動信號處理模組\n功能：產生單一時鐘週期的觸發脈衝 避免多週期觸發問題 division: 除法器核心模組\n功能：執行移位除法運算 提供商數和移位計數輸出 三、完整程式碼 #\r3.1 訊號邊緣檢測模組 #\r// ********************************************************************************* // 訊號邊緣檢測模組 // 功能：檢測輸入訊號的上升邊緣，產生一個時鐘週期的脈衝 // 應用：用於除法器的啟動控制 // ********************************************************************************* module div_go_tick ( input clk, // 時鐘輸入 input nRst, // 低電位有效的重置信號 input iSignal, // 輸入訊號 output oSignal // 輸出脈衝信號 ); reg [1:0] rvSignal_d, rvSignal_q; always @(posedge clk or negedge nRst) begin if(!nRst) rvSignal_q \u0026lt;= 2\u0026#39;b00; else rvSignal_q \u0026lt;= rvSignal_d; end always @(*) begin rvSignal_d = {rvSignal_q[0], iSignal}; end assign oSignal = (rvSignal_q == 2\u0026#39;b01) ? 1\u0026#39;b1 : 1\u0026#39;b0; endmodule 3.2 可參數化的除法器模組 #\rmodule division#( parameter DATA_WIDTH = 32 // 資料位寬參數，預設32位元 ) ( input clk, // 時脈輸入 input nRst, // 低電位有效的重置信號 input [DATA_WIDTH-1:0] ivDivisor, // 除數輸入 input [DATA_WIDTH-1:0] ivDividend, // 被除數輸入 output [DATA_WIDTH-1:0] ovQuotient, // 商數輸出 output [7:0] ovShift, // 移位計數輸出 input iGoTick, // 開始運算觸發信號 output oDone // 運算完成信號 ); // 常數定義 localparam DATA_WIDTH_ = DATA_WIDTH - 1; // 內部暫存器宣告 reg [DATA_WIDTH-1:0] rvDivisor_d, rvDivisor_q; reg [DATA_WIDTH-1:0] rvQuotientShift_d, rvQuotientShift_q; reg [DATA_WIDTH-1:0] rvRemainder_d, rvRemainder_q; wire [DATA_WIDTH-1:0] wvRemainder; reg [DATA_WIDTH-1:0] rvQuotient_d, rvQuotient_q; reg [7:0] rvShift_d, rvShift_q; // 控制信號暫存器 reg rFlag_d, rFlag_q; reg [7:0] rvProcessCnt_d, rvProcessCnt_q; wire addProcessCnt, endProcessCnt; reg [7:0] rvShiftCnt_d, rvShiftCnt_q; reg [DATA_WIDTH-1:0] rvDivisorShift_d, rvDivisorShift_q; reg rProcessEn_d, rProcessEn_q; wire [DATA_WIDTH-1:0] wvCompare; reg rDone_d, rDone_q; //============================================================================= // 第一階段：初始對齊 // 通過移位操作找到正確的起始位置 //============================================================================= // 比較邏輯：被除數減去移位後的除數 assign wvCompare = ivDividend - rvDivisorShift_q; // 除數移位暫存器 always @(posedge clk or negedge nRst) begin if(!nRst) rvDivisorShift_q \u0026lt;= 8\u0026#39;h0; else rvDivisorShift_q \u0026lt;= rvDivisorShift_d; end // 除數移位控制邏輯 always @(*) begin if(endProcessCnt) rvDivisorShift_d = 8\u0026#39;h0; else if(iGoTick) rvDivisorShift_d = ivDivisor; else if(wvCompare[DATA_WIDTH-1] == 1\u0026#39;b0) // 如果比較結果為正 rvDivisorShift_d = rvDivisorShift_q \u0026lt;\u0026lt; 1; // 繼續左移 else rvDivisorShift_d = rvDivisorShift_q; end // 移位計數器邏輯 always @(posedge clk or negedge nRst) begin if(!nRst) rvShiftCnt_q \u0026lt;= 8\u0026#39;h0; else rvShiftCnt_q \u0026lt;= rvShiftCnt_d; end // 移位計數控制 always @(*) begin if(iGoTick || !rFlag_q) rvShiftCnt_d = 8\u0026#39;h0; else if(wvCompare[DATA_WIDTH-1] == 1\u0026#39;b0) rvShiftCnt_d = rvShiftCnt_q + 1\u0026#39;b1; else rvShiftCnt_d = rvShiftCnt_q; end //============================================================================= // 處理控制邏輯 //============================================================================= // 處理啟用控制 always @(posedge clk or negedge nRst) begin if(!nRst) rProcessEn_q \u0026lt;= 1\u0026#39;b0; else rProcessEn_q \u0026lt;= rProcessEn_d; end always @(*) begin if(iGoTick || endProcessCnt) rProcessEn_d = 1\u0026#39;b0; else if(wvCompare[DATA_WIDTH-1] == 1\u0026#39;b1) // 當比較結果為負時開始處理 rProcessEn_d = 1\u0026#39;b1; else rProcessEn_d = rProcessEn_q; end // 運算狀態標誌控制 always @(posedge clk or negedge nRst) begin if(!nRst) rFlag_q \u0026lt;= 1\u0026#39;b0; else rFlag_q \u0026lt;= rFlag_d; end always @(*) begin if(endProcessCnt) rFlag_d = 1\u0026#39;b0; else if(iGoTick) rFlag_d = 1\u0026#39;b1; else rFlag_d = rFlag_q; end //============================================================================= // 第二階段：執行除法運算 //============================================================================= // 餘數計算 assign wvRemainder = rvRemainder_q - rvDivisor_q; // 處理計數器控制 assign addProcessCnt = rProcessEn_q; assign endProcessCnt = addProcessCnt \u0026amp;\u0026amp; (rvProcessCnt_q == DATA_WIDTH); // 處理計數器邏輯 always @(posedge clk or negedge nRst) begin if(!nRst) rvProcessCnt_q \u0026lt;= 8\u0026#39;h0; else rvProcessCnt_q \u0026lt;= rvProcessCnt_d; end always @(*) begin if(endProcessCnt) rvProcessCnt_d = 8\u0026#39;h0; else if(addProcessCnt) rvProcessCnt_d = rvProcessCnt_q + 1\u0026#39;b1; else rvProcessCnt_d = rvProcessCnt_q; end // 最終輸出賦值 assign ovQuotient = rvQuotient_q; assign ovShift = rvShift_q; assign oDone = rDone_q; endmodule 3.3 測試平台 #\r// ********************************************************************************* // 測試平台 // ********************************************************************************* `timescale 1ns/1ps module division_tb; localparam DATA_WIDTH = 32; // 設定資料位寬為32位元 // 時鐘和控制信號 reg clk; // 系統時鐘 reg nRst; // 低電位有效的重置信號 reg [DATA_WIDTH-1:0] divisor1; // 除數輸入 reg [DATA_WIDTH-1:0] dividend1; // 被除數輸入 wire [DATA_WIDTH-1:0] quotient1; // 商數輸出 wire [7:0] shift1; // 移位計數輸出 reg go; // 啟動信號 wire goTick; // 邊緣檢測後的啟動脈衝 // 邊緣檢測模組實例化 div_go_tick div_go_tick_inst ( .clk (clk), .nRst (nRst), .iSignal (go), // 輸入啟動信號 .oSignal (goTick) // 輸出脈衝信號 ); // 除法器模組實例化 division #( .DATA_WIDTH(DATA_WIDTH) ) DUT ( .clk (clk), .nRst (nRst), .ivDivisor (divisor1), .ivDividend (dividend1), .ovQuotient (quotient1), .ovShift (shift1), .iGoTick (goTick) ); // 時鐘產生器：週期為20ns (50MHz) initial clk = 1\u0026#39;b0; always #10 clk = ~clk; // 系統重置任務 task SYSTEM_RESET; begin nRst = 1\u0026#39;b0; // 啟動重置 repeat(100) @(posedge clk); // 等待100個時鐘週期 nRst = 1\u0026#39;b1; // 釋放重置 end endtask // 測試程序 initial begin // 初始化和系統重置 SYSTEM_RESET; go = 0; #1000; // 測試案例1: 300 ÷ 300 = 1 divisor1 = 300; dividend1 = 300; #100; go = 1; #100; go = 0; // 測試案例2: 13 ÷ 3 = 4.333... #1000; divisor1 = 3; dividend1 = 13; #100; go = 1; #100; go = 0; // 測試案例3: 280 ÷ 256 = 1.09375 #1000; divisor1 = 256; dividend1 = 280; #100; go = 1; #100; go = 0; // 測試案例4: 83 ÷ 19 = 4.368421... #1000; divisor1 = 19; dividend1 = 83; #100; go = 1; #100; go = 0; // 等待運算完成 #300000; // 結束模擬 $stop; end endmodule 四、波形分析 #\r4.1 實際波形結果 #\r波形說明：\n啟動控制信號\niSignal 觸發後產生 goTick 脈衝 單一時鐘週期的控制信號 除法運算過程\n初始對齊階段 移位除法運算階段 結果輸出階段 關鍵時序點\n運算開始時間點 商數產生時間點 完成信號產生時間點 五、結論 #\r本設計實現了一個穩定可靠的除法器，具有：\n良好的可擴展性 準確的運算結果 完整的控制機制 清晰的時序關係 六、未來優化方向 #\r增加管線級數提高運算效率 添加除數為零檢查 支援有號數運算 優化關鍵路徑降低延遲 ","date":"11 February 2025","externalUrl":null,"permalink":"/posts/fpga_divider/","section":"Posts","summary":"\u003ch1 class=\"relative group\"\u003e🔢 數位除法器設計與實現 - 基於FPGA的移位除法算法 \r\n    \u003cdiv id=\"-%E6%95%B8%E4%BD%8D%E9%99%A4%E6%B3%95%E5%99%A8%E8%A8%AD%E8%A8%88%E8%88%87%E5%AF%A6%E7%8F%BE---%E5%9F%BA%E6%96%BCfpga%E7%9A%84%E7%A7%BB%E4%BD%8D%E9%99%A4%E6%B3%95%E7%AE%97%E6%B3%95\" class=\"anchor\"\u003e\u003c/div\u003e\r\n    \r\n    \u003cspan\r\n        class=\"absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100\"\u003e\r\n        \u003ca class=\"group-hover:text-primary-300 dark:group-hover:text-neutral-700\"\r\n            style=\"text-decoration-line: none !important;\" href=\"#-%E6%95%B8%E4%BD%8D%E9%99%A4%E6%B3%95%E5%99%A8%E8%A8%AD%E8%A8%88%E8%88%87%E5%AF%A6%E7%8F%BE---%E5%9F%BA%E6%96%BCfpga%E7%9A%84%E7%A7%BB%E4%BD%8D%E9%99%A4%E6%B3%95%E7%AE%97%E6%B3%95\" aria-label=\"Anchor\"\u003e#\u003c/a\u003e\r\n    \u003c/span\u003e        \r\n    \r\n\u003c/h1\u003e\r\n\r\n\r\n\u003ch2 class=\"relative group\"\u003e前言 \r\n    \u003cdiv id=\"%E5%89%8D%E8%A8%80\" class=\"anchor\"\u003e\u003c/div\u003e\r\n    \r\n    \u003cspan\r\n        class=\"absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100\"\u003e\r\n        \u003ca class=\"group-hover:text-primary-300 dark:group-hover:text-neutral-700\"\r\n            style=\"text-decoration-line: none !important;\" href=\"#%E5%89%8D%E8%A8%80\" aria-label=\"Anchor\"\u003e#\u003c/a\u003e\r\n    \u003c/span\u003e        \r\n    \r\n\u003c/h2\u003e\r\n\u003cp\u003e在數位電路設計中，除法運算是一個重要但相對複雜的算術操作。本文將介紹一個基於FPGA的32位元除法器設計，採用移位除法算法實現。這個設計不僅具有良好的可擴展性，還提供了完整的測試驗證平台。\u003c/p\u003e","title":"🔢 數位除法器設計與實現 - 基於FPGA的移位除法算法","type":"posts"},{"content":"","date":"11 February 2025","externalUrl":null,"permalink":"/tags/fpga/","section":"Tags","summary":"","title":"FPGA","type":"tags"},{"content":"","date":"11 February 2025","externalUrl":null,"permalink":"/tags/verilog/","section":"Tags","summary":"","title":"Verilog","type":"tags"},{"content":"","date":"11 February 2025","externalUrl":null,"permalink":"/categories/verilog/","section":"Categories","summary":"","title":"Verilog","type":"categories"},{"content":"\r🔧 Verilog HDL 訊號命名原則 #\r前言 #\r在數位電路設計中，良好的訊號命名原則與 coding style 同等重要。特別是在大型設計專案中，清晰的命名方式不僅能讓代碼更容易維護，也能幫助團隊成員快速理解訊號特性並進行除錯。本文將介紹常用的 Verilog HDL 訊號命名規則。\n專案架構 #\r1. FPGA 外部輸入輸出命名 #\rFPGA 的外部接口（top module）使用全大寫字母，並用底線區分單字：\ninput CLOCK_50 // 50MHz 系統時脈 output LED_STATUS // LED 狀態輸出 input KEY_N // 按鍵輸入（低態動作） 2. 模組內部訊號命名 #\r2.1 子模組輸入輸出命名 #\r輸入訊號：前綴 i（除系統時脈及重置輸入外）\ninput clk // 系統時脈輸入 input nRst // 重置輸入(低態動作) input [7:0] iData // 資料輸入 輸出訊號：前綴 o\noutput oValid // 有效訊號輸出 output [15:0] oResult // 結果輸出 2.2 訊號類型標示 #\r暫存器類型：前綴 r\nreg rState // 狀態暫存器 reg [7:0] rCounter // 計數器暫存器 線網類型：前綴 w\nwire wReady // 就緒訊號 wire [15:0] wSum // 總和訊號 2.3 向量類型訊號 #\r輸入向量：前綴 iv\ninput [7:0] ivData // 8位元資料輸入 輸出向量：前綴 ov\noutput [15:0] ovResult // 16位元結果輸出 暫存器向量：前綴 rv\nreg [31:0] rvBuffer // 32位元緩衝暫存器 線網向量：前綴 wv\nwire [7:0] wvSum // 8位元總和線網 2.4 特殊訊號標示 #\rD 觸發器相關： reg rData_d // D 觸發器輸入端 reg rData_q // D 觸發器輸出端 實際應用範例 #\r訊號邊緣檢測器 #\rmodule tick_gen ( input clk, // 系統時脈 input nRst, // 重置訊號（低態動作） input iSignal, // 輸入訊號 output oSignalTick // 訊號上升邊緣脈衝 ); reg [1:0] rvSignal_d, rvSignal_q; // 訊號延遲鏈 // 同步時序邏輯 always @(posedge clk or negedge nRst) begin if(!nRst) rvSignal_q \u0026lt;= 2\u0026#39;h0; else rvSignal_q \u0026lt;= rvSignal_d; end // 組合邏輯 always @(*) begin rvSignal_d = {rvSignal_q[0], iSignal}; end // 檢測上升邊緣（01序列） assign oSignalTick = (rvSignal_q == 2\u0026#39;b01) ? 1\u0026#39;b1 : 1\u0026#39;b0; endmodule 這個範例展示了：\n系統訊號（clk, nRst）不加前綴 一般輸入加 i 前綴 一般輸出加 o 前綴 向量型暫存器加 rv 前綴 D 觸發器相關訊號加 _d 和 _q 後綴 命名規範建議 #\r1. 一致性原則 #\r在同一專案中保持命名風格一致 遵循團隊既定的命名規範 2. 清晰性原則 #\r選擇具描述性的名稱 避免過於簡略或難以理解的縮寫 結語 #\r良好的訊號命名規範不僅能提高代碼的可讀性，也能減少開發過程中的錯誤。在實際專案中，建議團隊成員共同制定並遵循統一的命名規範，以提高開發效率和代碼品質。\n","date":"11 February 2025","externalUrl":null,"permalink":"/posts/verilog_signal_name/","section":"Posts","summary":"\u003ch1 class=\"relative group\"\u003e🔧 Verilog HDL 訊號命名原則 \r\n    \u003cdiv id=\"-verilog-hdl-%E8%A8%8A%E8%99%9F%E5%91%BD%E5%90%8D%E5%8E%9F%E5%89%87\" class=\"anchor\"\u003e\u003c/div\u003e\r\n    \r\n    \u003cspan\r\n        class=\"absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100\"\u003e\r\n        \u003ca class=\"group-hover:text-primary-300 dark:group-hover:text-neutral-700\"\r\n            style=\"text-decoration-line: none !important;\" href=\"#-verilog-hdl-%E8%A8%8A%E8%99%9F%E5%91%BD%E5%90%8D%E5%8E%9F%E5%89%87\" aria-label=\"Anchor\"\u003e#\u003c/a\u003e\r\n    \u003c/span\u003e        \r\n    \r\n\u003c/h1\u003e\r\n\r\n\r\n\u003ch2 class=\"relative group\"\u003e前言 \r\n    \u003cdiv id=\"%E5%89%8D%E8%A8%80\" class=\"anchor\"\u003e\u003c/div\u003e\r\n    \r\n    \u003cspan\r\n        class=\"absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100\"\u003e\r\n        \u003ca class=\"group-hover:text-primary-300 dark:group-hover:text-neutral-700\"\r\n            style=\"text-decoration-line: none !important;\" href=\"#%E5%89%8D%E8%A8%80\" aria-label=\"Anchor\"\u003e#\u003c/a\u003e\r\n    \u003c/span\u003e        \r\n    \r\n\u003c/h2\u003e\r\n\u003cp\u003e在數位電路設計中，良好的訊號命名原則與 coding style 同等重要。特別是在大型設計專案中，清晰的命名方式不僅能讓代碼更容易維護，也能幫助團隊成員快速理解訊號特性並進行除錯。本文將介紹常用的 Verilog HDL 訊號命名規則。\u003c/p\u003e","title":"🔧 Verilog HDL 訊號命名原則","type":"posts"},{"content":"\r🔧 數字電路毛刺濾波器設計與實現 #\r前言 #\r在數位電路設計中，信號毛刺（Glitch）是一個常見的問題，常見於按鍵去彈跳、外部信號輸入處理、需要穩定信號的控制系統、數位電路中的雜訊處理等。本文將介紹一個使用Verilog實現的毛刺濾波器設計，該濾波器可以有效過濾掉輸入信號中的短暫毛刺，提高系統的穩定性。\n專案架構 #\rRTL代碼實現 #\r以下是完整的Verilog RTL代碼：\nmodule glitch_filter ( input clk, // 系統時脈輸入 input nRst, // 低電位有效的重置信號 input iSignal, // 需要進行濾波的輸入信號 output oSignal // 經過濾波處理後的輸出信號 ); // 內部信號定義 reg [31:0] rvShiftSignal_d, rvShiftSignal_q; // 32位移位暫存器，用於儲存信號歷史 reg rSignal_d, rSignal_q; // 輸出信號的組合邏輯和時序邏輯暫存器 // 第一個時序邏輯區塊：移位暫存器的時序控制 always @(posedge clk or negedge nRst) begin if(!nRst) rvShiftSignal_q \u0026lt;= 32\u0026#39;hFFFFFFFF; // 重置時設定為全1狀態 else rvShiftSignal_q \u0026lt;= rvShiftSignal_d; // 正常工作時更新移位暫存器 end // 第一個組合邏輯區塊：移位操作 always @(*) begin rvShiftSignal_d = {rvShiftSignal_q[30:0], iSignal}; // 每個時脈週期將輸入信號移入最低位 end // 第二個時序邏輯區塊：輸出信號的時序控制 always @(posedge clk or negedge nRst) begin if(!nRst) rSignal_q \u0026lt;= 1\u0026#39;b1; // 重置時輸出信號設定為1 else rSignal_q \u0026lt;= rSignal_d; // 正常工作時更新輸出信號 end // 第二個組合邏輯區塊：輸出信號的邏輯判斷 always @(*) begin if(rvShiftSignal_q == 32\u0026#39;hFFFFFFFF) // 如果移位暫存器中全是1 rSignal_d = 1\u0026#39;b1; // 輸出設定為1 else if(rvShiftSignal_q == 32\u0026#39;h0) // 如果移位暫存器中全是0 rSignal_d = 1\u0026#39;b0; // 輸出設定為0 else rSignal_d = rSignal_q; // 其他情況保持原狀態 end assign oSignal = rSignal_q; // 將內部信號連接到輸出端 endmodule 技術要點說明 #\r1. 移位暫存器機制 #\r使用32位移位暫存器記錄輸入信號的歷史狀態 每個時脈週期，新的輸入信號被移入暫存器的最低位 這樣可以觀察信號在32個時脈週期內的變化 2. 濾波邏輯設計 #\r只有當移位暫存器中的所有位元都為1時，輸出才會變為1 只有當移位暫存器中的所有位元都為0時，輸出才會變為0 其他情況下保持原有輸出狀態不變 3. 重置機制實現 #\r當重置信號（nRst）為低電位時： 移位暫存器被設定為全1（32\u0026rsquo;hFFFFFFFF） 輸出信號被設定為1 應用場景 #\r該毛刺濾波器適用於以下場景：\n按鍵去彈跳 外部信號輸入處理 需要穩定信號的控制系統 數位電路中的雜訊處理 改進建議 #\r1. 可配置的濾波寬度 #\rmodule glitch_filter #( parameter WIDTH = 32 // 可配置的移位暫存器寬度 )( input clk, input nRst, input iSignal, output oSignal ); reg [WIDTH-1:0] rvShiftSignal_d, rvShiftSignal_q; // ... 其餘代碼相同 endmodule 注意事項 #\r濾波器的延遲時間與移位暫存器的位元數相關，本設計中為32個時脈週期 需要根據實際應用場景調整移位暫存器的位元數 時脈頻率的選擇需要考慮實際信號的特性 模擬結果 #\r波形模擬 #\r上圖為使用ModelSim進行的波形模擬結果，從上到下依序為：\nclk：系統時脈信號 nRst：重置信號 iSignal：輸入信號（包含毛刺） oSignal：濾波後的輸出信號 模擬情境說明 #\r毛刺濾除測試\n輸入信號(iSignal)包含多個短暫的毛刺（小於32個時脈週期） 輸出信號(oSignal)保持穩定，成功濾除這些毛刺 實測結果顯示，寬度小於32個時脈週期的毛刺都被有效濾除 正常信號響應\n當輸入信號保持穩定超過32個時脈週期 輸出信號才會跟隨變化 驗證了設計的穩定性要求 重置功能驗證\n重置信號(nRst)觸發時 輸出立即回到預設狀態（高電位） 移位暫存器正確清除為全1 關鍵性能指標 #\r延遲特性\n信號變化延遲：32個時脈週期 重置響應時間：1個時脈週期 資源使用\n使用32位元移位暫存器 簡單的組合邏輯電路 整體資源使用率低 結語 #\r這個毛刺濾波器設計簡單但效果顯著，通過移位暫存器和狀態機制實現了對輸入信號的有效濾波。在實際應用中，可以根據具體需求調整參數，使其更好地適應不同的應用場景。完整的程式碼實現和詳細的註解，有助於理解數字電路設計中的濾波器實現方法。\n","date":"11 February 2025","externalUrl":null,"permalink":"/posts/digital_filter/","section":"Posts","summary":"\u003ch1 class=\"relative group\"\u003e🔧 數字電路毛刺濾波器設計與實現 \r\n    \u003cdiv id=\"-%E6%95%B8%E5%AD%97%E9%9B%BB%E8%B7%AF%E6%AF%9B%E5%88%BA%E6%BF%BE%E6%B3%A2%E5%99%A8%E8%A8%AD%E8%A8%88%E8%88%87%E5%AF%A6%E7%8F%BE\" class=\"anchor\"\u003e\u003c/div\u003e\r\n    \r\n    \u003cspan\r\n        class=\"absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100\"\u003e\r\n        \u003ca class=\"group-hover:text-primary-300 dark:group-hover:text-neutral-700\"\r\n            style=\"text-decoration-line: none !important;\" href=\"#-%E6%95%B8%E5%AD%97%E9%9B%BB%E8%B7%AF%E6%AF%9B%E5%88%BA%E6%BF%BE%E6%B3%A2%E5%99%A8%E8%A8%AD%E8%A8%88%E8%88%87%E5%AF%A6%E7%8F%BE\" aria-label=\"Anchor\"\u003e#\u003c/a\u003e\r\n    \u003c/span\u003e        \r\n    \r\n\u003c/h1\u003e\r\n\r\n\r\n\u003ch2 class=\"relative group\"\u003e前言 \r\n    \u003cdiv id=\"%E5%89%8D%E8%A8%80\" class=\"anchor\"\u003e\u003c/div\u003e\r\n    \r\n    \u003cspan\r\n        class=\"absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100\"\u003e\r\n        \u003ca class=\"group-hover:text-primary-300 dark:group-hover:text-neutral-700\"\r\n            style=\"text-decoration-line: none !important;\" href=\"#%E5%89%8D%E8%A8%80\" aria-label=\"Anchor\"\u003e#\u003c/a\u003e\r\n    \u003c/span\u003e        \r\n    \r\n\u003c/h2\u003e\r\n\u003cp\u003e在數位電路設計中，信號毛刺（Glitch）是一個常見的問題，常見於按鍵去彈跳、外部信號輸入處理、需要穩定信號的控制系統、數位電路中的雜訊處理等。本文將介紹一個使用Verilog實現的毛刺濾波器設計，該濾波器可以有效過濾掉輸入信號中的短暫毛刺，提高系統的穩定性。\u003c/p\u003e","title":"🔧 數字電路毛刺濾波器設計與實現","type":"posts"},{"content":"","date":"11 February 2025","externalUrl":null,"permalink":"/tags/digital-filter/","section":"Tags","summary":"","title":"Digital Filter","type":"tags"},{"content":"\r🐢 ROS2 巡邏服務節點開發教學(使用 Service) #\r前言 #\r在本篇文章中，我們將實作一個 ROS2 的巡邏服務節點，透過 Service 和 Topic 的結合來控制 turtlesim 中的烏龜移動到指定位置。這個專案展示了如何在 ROS2 中實現服務端和客戶端的通信，以及基本的運動控制。\n專案架構 #\r1. 檔案結構 #\rpatrol/\r├── CMakeLists.txt # 構建配置文件\r├── package.xml # 包配置文件\r├── src/\r│ └── service.cpp # 服務節點實現\r└── srv/\r└── Patrol.srv # 服務介面定義 2. 服務介面定義 #\r# Patrol.srv\rfloat64 target_x # 目標 X 座標\rfloat64 target_y # 目標 Y 座標\r---\rint8 SUCCESS = 1 # 成功狀態碼\rint8 FAIL = 0 # 失敗狀態碼\rint8 result # 執行結果 3. 完整程式碼實現 #\r// 包含必要的標頭文件 #include \u0026#34;rclcpp/rclcpp.hpp\u0026#34; // ROS2 C++ 客戶端庫 #include \u0026#34;patrol/srv/patrol.hpp\u0026#34; // 生成的服務介面 #include \u0026#34;geometry_msgs/msg/pose.hpp\u0026#34; // 位置訊息 #include \u0026#34;turtlesim/msg/pose.hpp\u0026#34; // turtlesim 位置訊息 #include \u0026#34;geometry_msgs/msg/twist.hpp\u0026#34; // 速度訊息 // 巡邏服務節點類別，繼承自 rclcpp::Node class PatrolService: public rclcpp::Node { private: // 成員變量 double targetX_ {1.0}; // 目標 X 座標 double targetY_ {1.0}; // 目標 Y 座標 // ROS2 通信組件 rclcpp::Service\u0026lt;patrol::srv::Patrol\u0026gt;::SharedPtr service_; // 服務 turtlesim::msg::Pose::SharedPtr turtlePose_; // 當前位置 rclcpp::Subscription\u0026lt;turtlesim::msg::Pose\u0026gt;::SharedPtr turtlePoseSub_; // 位置訂閱者 rclcpp::Publisher\u0026lt;geometry_msgs::msg::Twist\u0026gt;::SharedPtr publisher_; // 速度發布者 public: // 建構函數 PatrolService(std::string nodeName); // 解構函數 ~PatrolService() = default; // 服務回調函數 void handle_patrol(const std::shared_ptr\u0026lt;patrol::srv::Patrol::Request\u0026gt; request, const std::shared_ptr\u0026lt;patrol::srv::Patrol::Response\u0026gt; response); // 移動控制函數 void move_to_target(double targetX, double targetY); }; // 建構函數實現 PatrolService::PatrolService(std::string nodeName): Node(nodeName) { // 創建位置訂閱者 turtlePoseSub_ = this-\u0026gt;create_subscription\u0026lt;turtlesim::msg::Pose\u0026gt;( \u0026#34;/turtle1/pose\u0026#34;, 10, [this](const turtlesim::msg::Pose::SharedPtr msg) { turtlePose_ = msg; move_to_target(turtlePose_-\u0026gt;x, turtlePose_-\u0026gt;y); } ); // 創建速度發布者 publisher_ = this-\u0026gt;create_publisher\u0026lt;geometry_msgs::msg::Twist\u0026gt;(\u0026#34;/turtle1/cmd_vel\u0026#34;, 10); // 創建服務 service_ = this-\u0026gt;create_service\u0026lt;patrol::srv::Patrol\u0026gt;( \u0026#34;patrol\u0026#34;, std::bind(\u0026amp;PatrolService::handle_patrol, this, std::placeholders::_1, std::placeholders::_2) ); } // 服務回調函數實現 void PatrolService::handle_patrol( const std::shared_ptr\u0026lt;patrol::srv::Patrol::Request\u0026gt; request, const std::shared_ptr\u0026lt;patrol::srv::Patrol::Response\u0026gt; response) { // 檢查目標座標是否在有效範圍內（0-12之間） if((request-\u0026gt;target_x \u0026gt; 0.0f \u0026amp;\u0026amp; request-\u0026gt;target_x \u0026lt; 12.0f) \u0026amp;\u0026amp; (request-\u0026gt;target_y \u0026gt; 0.0f \u0026amp;\u0026amp; request-\u0026gt;target_y \u0026lt; 12.0f)) { // 更新目標位置 targetX_ = request-\u0026gt;target_x; targetY_ = request-\u0026gt;target_y; response-\u0026gt;result = patrol::srv::Patrol::Response::SUCCESS; } else { // 座標無效 response-\u0026gt;result = patrol::srv::Patrol::Response::FAIL; } } // 移動控制函數實現 void PatrolService::move_to_target(double currentX, double currentY) { // 創建速度訊息 auto twist = geometry_msgs::msg::Twist(); // 計算距離和角度 double dx = targetX_ - currentX; double dy = targetY_ - currentY; double distance = std::sqrt(dx * dx + dy * dy); double target_angle = std::atan2(dy, dx); // 如果距離大於閾值，則移動 if (distance \u0026gt; 0.1) { // 計算角度差 double angle_diff = target_angle - turtlePose_-\u0026gt;theta; // 角度歸一化 if (angle_diff \u0026gt; M_PI) angle_diff -= 2 * M_PI; if (angle_diff \u0026lt; -M_PI) angle_diff += 2 * M_PI; // 設置角速度和線速度 twist.angular.z = 1.0 * angle_diff; twist.linear.x = 0.5 * distance; // 輸出當前位置資訊 RCLCPP_INFO(this-\u0026gt;get_logger(), \u0026#34;currentX: %f, currentY: %f\u0026#34;, currentX, currentY); // 發布速度命令 publisher_-\u0026gt;publish(twist); } } // 主函數 int main(int argc, char **argv) { // 初始化 ROS2 rclcpp::init(argc, argv); // 創建服務節點 auto node = std::make_shared\u0026lt;PatrolService\u0026gt;(\u0026#34;patrol_service_node\u0026#34;); // 運行節點 rclcpp::spin(node); // 關閉 ROS2 rclcpp::shutdown(); return 0; } 4. 配置文件說明 #\r4.1 CMakeLists.txt #\r# 指定 CMake 最低版本要求 cmake_minimum_required(VERSION 3.8) # 定義專案名稱 project(patrol) # 如果使用 GCC 或 Clang 編譯器，添加編譯警告選項 if(CMAKE_COMPILER_IS_GNUCXX OR CMAKE_CXX_COMPILER_ID MATCHES \u0026#34;Clang\u0026#34;) add_compile_options(-Wall -Wextra -Wpedantic) endif() # 尋找並載入所需的依賴套件 find_package(ament_cmake REQUIRED) # ROS 2 CMake 工具 find_package(rclcpp REQUIRED) # ROS 2 C++ 客戶端程式庫 find_package(std_msgs REQUIRED) # 標準訊息類型 find_package(rosidl_default_generators REQUIRED)# 服務介面生成器 find_package(turtlesim REQUIRED) # 烏龜模擬器套件 find_package(geometry_msgs REQUIRED) # 幾何訊息類型 # 生成服務介面 rosidl_generate_interfaces(${PROJECT_NAME} \u0026#34;srv/Patrol.srv\u0026#34; ) # 創建可執行檔 add_executable(service_node src/service.cpp) # 為可執行檔添加依賴 ament_target_dependencies(service_node rclcpp # ROS 2 C++ 客戶端程式庫 std_msgs # 標準訊息類型 geometry_msgs # 幾何訊息類型 turtlesim # 烏龜模擬器套件 ) # 安裝可執行檔到指定目錄 install(TARGETS service_node DESTINATION lib/${PROJECT_NAME} ) # 完成 ament 套件的配置 ament_package() 4.2 package.xml #\r\u0026lt;?xml version=\u0026#34;1.0\u0026#34;?\u0026gt; \u0026lt;!-- 指定 XML 模式定義（XSD）檔案的位置，用於驗證此檔案的格式 --\u0026gt; \u0026lt;?xml-model href=\u0026#34;http://download.ros.org/schema/package_format3.xsd\u0026#34; schematypens=\u0026#34;http://www.w3.org/2001/XMLSchema\u0026#34;?\u0026gt; \u0026lt;!-- ROS 2 套件配置檔案，使用格式版本 3 --\u0026gt; \u0026lt;package format=\u0026#34;3\u0026#34;\u0026gt; \u0026lt;!-- 套件基本資訊 --\u0026gt; \u0026lt;name\u0026gt;patrol\u0026lt;/name\u0026gt; \u0026lt;!-- 套件名稱 --\u0026gt; \u0026lt;version\u0026gt;0.0.0\u0026lt;/version\u0026gt; \u0026lt;!-- 套件版本 --\u0026gt; \u0026lt;description\u0026gt;TODO: Package description\u0026lt;/description\u0026gt; \u0026lt;!-- 套件描述 --\u0026gt; \u0026lt;maintainer email=\u0026#34;tienyao@todo.todo\u0026#34;\u0026gt;tienyao\u0026lt;/maintainer\u0026gt; \u0026lt;!-- 維護者資訊 --\u0026gt; \u0026lt;license\u0026gt;TODO: License declaration\u0026lt;/license\u0026gt; \u0026lt;!-- 授權聲明 --\u0026gt; \u0026lt;!-- 建構工具依賴 --\u0026gt; \u0026lt;buildtool_depend\u0026gt;ament_cmake\u0026lt;/buildtool_depend\u0026gt; \u0026lt;!-- 使用 ament_cmake 作為建構工具 --\u0026gt; \u0026lt;!-- 建構時依賴 --\u0026gt; \u0026lt;build_depend\u0026gt;rosidl_default_generators\u0026lt;/build_depend\u0026gt;\u0026lt;!-- 用於生成介面檔案 --\u0026gt; \u0026lt;!-- 執行時依賴 --\u0026gt; \u0026lt;exec_depend\u0026gt;rosidl_default_runtime\u0026lt;/exec_depend\u0026gt; \u0026lt;!-- 執行時需要的介面運行庫 --\u0026gt; \u0026lt;!-- 建構和執行都需要的依賴 --\u0026gt; \u0026lt;depend\u0026gt;rclcpp\u0026lt;/depend\u0026gt; \u0026lt;!-- ROS 2 C++ 客戶端程式庫 --\u0026gt; \u0026lt;depend\u0026gt;std_msgs\u0026lt;/depend\u0026gt; \u0026lt;!-- 標準訊息類型 --\u0026gt; \u0026lt;depend\u0026gt;turtlesim\u0026lt;/depend\u0026gt; \u0026lt;!-- 烏龜模擬器套件 --\u0026gt; \u0026lt;depend\u0026gt;geometry_msgs\u0026lt;/depend\u0026gt; \u0026lt;!-- 幾何訊息類型 --\u0026gt; \u0026lt;!-- 聲明此套件是一個介面套件 --\u0026gt; \u0026lt;member_of_group\u0026gt;rosidl_interface_packages\u0026lt;/member_of_group\u0026gt; \u0026lt;!-- 測試相關依賴 --\u0026gt; \u0026lt;test_depend\u0026gt;ament_lint_auto\u0026lt;/test_depend\u0026gt; \u0026lt;!-- 自動化程式碼檢查工具 --\u0026gt; \u0026lt;test_depend\u0026gt;ament_lint_common\u0026lt;/test_depend\u0026gt; \u0026lt;!-- 常用程式碼檢查規則 --\u0026gt; \u0026lt;!-- ROS 2 套件特定資訊 --\u0026gt; \u0026lt;export\u0026gt; \u0026lt;build_type\u0026gt;ament_cmake\u0026lt;/build_type\u0026gt; \u0026lt;!-- 指定使用 ament_cmake 建構系統 --\u0026gt; \u0026lt;/export\u0026gt; \u0026lt;/package\u0026gt; 執行方式 #\r編譯專案 cd ros2_ws colcon build --packages-select patrol 執行節點 # 終端機 1：啟動 turtlesim ros2 run turtlesim turtlesim_node # 終端機 2：啟動巡邏服務 ros2 run patrol patrol_service # 終端機 3：發送服務請求 ros2 service call /patrol patrol/srv/Patrol \u0026#34;{target_x: 5.0, target_y: 5.0}\u0026#34; 使用 RQT 測試 #\rRQT 是 ROS 的圖形化工具，可以用來監控和測試節點。以下是使用 RQT 測試巡邏服務的步驟：\n啟動 RQT rqt 使用 Service Caller\n在菜單中選擇 Plugins -\u0026gt; Services -\u0026gt; Service Caller 在 Service 下拉選單中選擇 /patrol 填入測試數據： { \u0026#34;target_x\u0026#34;: 5.0, \u0026#34;target_y\u0026#34;: 5.0 } 點擊 \u0026ldquo;Call\u0026rdquo; 按鈕發送請求 使用 Plot 工具監控位置\n選擇 Plugins -\u0026gt; Visualization -\u0026gt; Plot 添加以下話題進行監控： /turtle1/pose/x：烏龜的 X 座標 /turtle1/pose/y：烏龜的 Y 座標 /turtle1/pose/theta：烏龜的角度 使用 Topic Monitor\n選擇 Plugins -\u0026gt; Topics -\u0026gt; Topic Monitor 可以監控以下話題： /turtle1/cmd_vel：發布的速度命令 /turtle1/pose：烏龜的當前位置 RQT 監控截圖示例 #\rRQT 的優勢 #\r圖形化介面，操作直觀 即時數據可視化 方便進行服務測試 支援多種監控工具 技術要點說明 #\r服務通信機制\n使用 Service 處理一次性請求 通過 Topic 實現連續的位置和速度更新 結合同步（Service）和異步（Topic）通信 運動控制\n使用比例控制實現平滑移動 考慮角度連續性，避免突變 距離和角度的實時計算 錯誤處理\n檢查座標範圍有效性 回傳適當的執行結果 移動閾值控制 改進建議 #\rPID 控制優化 // 添加積分和微分項 class PatrolService { private: double angle_integral = 0.0; double last_angle_error = 0.0; void move_to_target() { double angle_error = target_angle - current_angle; angle_integral += angle_error; double angle_derivative = angle_error - last_angle_error; twist.angular.z = Kp * angle_error + Ki * angle_integral + Kd * angle_derivative; last_angle_error = angle_error; } }; 超時處理 class PatrolService { private: rclcpp::Time start_time_; const double timeout_duration_ = 10.0; // 10 秒超時 bool move_timeout() { return (this-\u0026gt;now() - start_time_).seconds() \u0026gt; timeout_duration_; } void handle_patrol() { start_time_ = this-\u0026gt;now(); if (move_timeout()) { response-\u0026gt;result = patrol::srv::Patrol::Response::FAIL; return; } } }; 參考資源 #\rROS2 Service 教程 turtlesim 文檔 結語 #\r透過這個專案，我們學習了如何在 ROS2 中結合 Service 和 Topic 來實現機器人的運動控制。這種結合不同通信機制的方式，能夠更靈活地處理各種控制需求。完整的程式碼實現和詳細的注解，有助於理解 ROS2 的核心概念和實作方法。\n","date":"11 February 2025","externalUrl":null,"permalink":"/posts/ros2_service_node/","section":"Posts","summary":"\u003ch1 class=\"relative group\"\u003e🐢 ROS2 巡邏服務節點開發教學(使用 Service) \r\n    \u003cdiv id=\"-ros2-%E5%B7%A1%E9%82%8F%E6%9C%8D%E5%8B%99%E7%AF%80%E9%BB%9E%E9%96%8B%E7%99%BC%E6%95%99%E5%AD%B8%E4%BD%BF%E7%94%A8-service\" class=\"anchor\"\u003e\u003c/div\u003e\r\n    \r\n    \u003cspan\r\n        class=\"absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100\"\u003e\r\n        \u003ca class=\"group-hover:text-primary-300 dark:group-hover:text-neutral-700\"\r\n            style=\"text-decoration-line: none !important;\" href=\"#-ros2-%E5%B7%A1%E9%82%8F%E6%9C%8D%E5%8B%99%E7%AF%80%E9%BB%9E%E9%96%8B%E7%99%BC%E6%95%99%E5%AD%B8%E4%BD%BF%E7%94%A8-service\" aria-label=\"Anchor\"\u003e#\u003c/a\u003e\r\n    \u003c/span\u003e        \r\n    \r\n\u003c/h1\u003e\r\n\r\n\r\n\u003ch2 class=\"relative group\"\u003e前言 \r\n    \u003cdiv id=\"%E5%89%8D%E8%A8%80\" class=\"anchor\"\u003e\u003c/div\u003e\r\n    \r\n    \u003cspan\r\n        class=\"absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100\"\u003e\r\n        \u003ca class=\"group-hover:text-primary-300 dark:group-hover:text-neutral-700\"\r\n            style=\"text-decoration-line: none !important;\" href=\"#%E5%89%8D%E8%A8%80\" aria-label=\"Anchor\"\u003e#\u003c/a\u003e\r\n    \u003c/span\u003e        \r\n    \r\n\u003c/h2\u003e\r\n\u003cp\u003e在本篇文章中，我們將實作一個 ROS2 的巡邏服務節點，透過 Service 和 Topic 的結合來控制 turtlesim 中的烏龜移動到指定位置。這個專案展示了如何在 ROS2 中實現服務端和客戶端的通信，以及基本的運動控制。\u003c/p\u003e","title":"🐢 ROS2 巡邏服務節點開發教學(使用 Service)","type":"posts"},{"content":"\r🚀 ROS2 Launch 檔案建立 #\r1. Launch 檔案簡介 #\rLaunch 檔案允許您同時啟動多個 ROS2 節點，簡化了操作流程。\n2. 基本結構 #\r2.1 檔案位置 #\ryour_package/ ├── launch/ │ └── multi_turtles.launch.py └── setup.py 2.2 基本範例 #\r# 導入必要的套件 import launch # 導入 launch 核心功能 import launch_ros # 導入 ROS2 相關的 launch 功能 def generate_launch_description(): # 創建第一個烏龜節點 action_node_turtle0 = launch_ros.actions.Node( package=\u0026#39;turtlesim\u0026#39;, # 套件名稱 executable=\u0026#39;turtlesim_node\u0026#39;, # 可執行檔名稱 output=\u0026#39;both\u0026#39;, # 輸出方式：同時輸出到終端和日誌 ) # 創建第二個烏龜節點 action_node_turtle1 = launch_ros.actions.Node( package=\u0026#39;turtlesim\u0026#39;, # 套件名稱 executable=\u0026#39;turtlesim_node\u0026#39;, # 可執行檔名稱 output=\u0026#39;both\u0026#39;, # 輸出方式：同時輸出到終端和日誌 ) # 創建第三個烏龜節點 action_node_turtle2 = launch_ros.actions.Node( package=\u0026#39;turtlesim\u0026#39;, # 套件名稱 executable=\u0026#39;turtlesim_node\u0026#39;, # 可執行檔名稱 output=\u0026#39;both\u0026#39;, # 輸出方式：同時輸出到終端和日誌 ) # 創建 launch 描述對象，包含所有節點 launch_description = launch.LaunchDescription([ action_node_turtle0, # 添加第一個烏龜節點 action_node_turtle1, # 添加第二個烏龜節點 action_node_turtle2, # 添加第三個烏龜節點 ]) # 返回 launch 描述對象 return launch_description 2.3 CMakeLists.txt 配置 #\r主要配置包括：\n專案名稱和版本要求 依賴套件配置 可執行檔編譯設定 安裝路徑配置 特別注意以下安裝配置：\n# 安裝可執行檔 install(TARGETS service_parameters_node client_parameters_node DESTINATION lib/${PROJECT_NAME} ) # 安裝啟動文件 install(DIRECTORY launch DESTINATION share/${PROJECT_NAME} ) # 完成 ament 套件配置 ament_package() 這些配置確保了：\n可執行檔被正確安裝到指定目錄 啟動文件（launch files）被安裝到共享目錄 套件配置正確完成 3. 參數說明 #\r3.1 Node 參數 #\rpackage: 套件名稱 executable: 可執行檔名稱 output: 輸出方式（\u0026lsquo;screen\u0026rsquo;, \u0026rsquo;log\u0026rsquo;, \u0026lsquo;both\u0026rsquo;） name: 節點名稱（可選） namespace: 命名空間（可選） 3.2 常用配置 #\r# 設定節點名稱和命名空間 Node( package=\u0026#39;turtlesim\u0026#39;, # 套件名稱 executable=\u0026#39;turtlesim_node\u0026#39;, # 可執行檔名稱 name=\u0026#39;turtle1\u0026#39;, # 節點名稱 namespace=\u0026#39;group1\u0026#39; # 命名空間 ) # 添加參數配置 Node( package=\u0026#39;turtlesim\u0026#39;, # 套件名稱 executable=\u0026#39;turtlesim_node\u0026#39;, # 可執行檔名稱 parameters=[{\u0026#39;background_r\u0026#39;: 255}, {\u0026#39;background_g\u0026#39;: 150}, {\u0026#39;background_b\u0026#39;: 50}] # 設定背景顏色參數 ) 4. 使用方法 #\r4.1 執行 Launch 檔案 #\r# 編譯專案 colcon build # 執行 launch 檔案 ros2 launch your_package multi_turtles.launch.py 5. 進階功能 #\r5.1 條件式啟動 #\r# 導入必要的條件和配置類別 from launch.conditions import IfCondition from launch.substitutions import LaunchConfiguration # 根據條件啟動節點 Node( package=\u0026#39;turtlesim\u0026#39;, # 套件名稱 executable=\u0026#39;turtlesim_node\u0026#39;, # 可執行檔名稱 condition=IfCondition(LaunchConfiguration(\u0026#39;start_turtle\u0026#39;)) # 條件判斷 ) 5.2 群組管理 #\r# 導入必要的類別 from launch import LaunchDescription from launch_ros.actions import Node from launch.actions import GroupAction # 創建節點群組 group = GroupAction([ Node(package=\u0026#39;turtlesim\u0026#39;, executable=\u0026#39;turtlesim_node\u0026#39;), # 烏龜模擬器節點 Node(package=\u0026#39;turtlesim\u0026#39;, executable=\u0026#39;turtle_teleop_key\u0026#39;) # 鍵盤控制節點 ]) 💡 提示：\n使用 ros2 launch --show 查看 launch 檔案的配置 可以在 launch 檔案中包含其他 launch 檔案 善用命名空間避免節點名稱衝突 ","date":"11 February 2025","externalUrl":null,"permalink":"/posts/c_array/","section":"Posts","summary":"\u003ch1 class=\"relative group\"\u003e🚀 ROS2 Launch 檔案建立 \r\n    \u003cdiv id=\"-ros2-launch-%E6%AA%94%E6%A1%88%E5%BB%BA%E7%AB%8B\" class=\"anchor\"\u003e\u003c/div\u003e\r\n    \r\n    \u003cspan\r\n        class=\"absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100\"\u003e\r\n        \u003ca class=\"group-hover:text-primary-300 dark:group-hover:text-neutral-700\"\r\n            style=\"text-decoration-line: none !important;\" href=\"#-ros2-launch-%E6%AA%94%E6%A1%88%E5%BB%BA%E7%AB%8B\" aria-label=\"Anchor\"\u003e#\u003c/a\u003e\r\n    \u003c/span\u003e        \r\n    \r\n\u003c/h1\u003e\r\n\r\n\r\n\u003ch2 class=\"relative group\"\u003e1. Launch 檔案簡介 \r\n    \u003cdiv id=\"1-launch-%E6%AA%94%E6%A1%88%E7%B0%A1%E4%BB%8B\" class=\"anchor\"\u003e\u003c/div\u003e\r\n    \r\n    \u003cspan\r\n        class=\"absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100\"\u003e\r\n        \u003ca class=\"group-hover:text-primary-300 dark:group-hover:text-neutral-700\"\r\n            style=\"text-decoration-line: none !important;\" href=\"#1-launch-%E6%AA%94%E6%A1%88%E7%B0%A1%E4%BB%8B\" aria-label=\"Anchor\"\u003e#\u003c/a\u003e\r\n    \u003c/span\u003e        \r\n    \r\n\u003c/h2\u003e\r\n\u003cp\u003eLaunch 檔案允許您同時啟動多個 ROS2 節點，簡化了操作流程。\u003c/p\u003e","title":"🚀 ROS2 Launch 檔案建立","type":"posts"},{"content":"","date":"11 February 2025","externalUrl":null,"permalink":"/tags/array/","section":"Tags","summary":"","title":"Array","type":"tags"},{"content":"","date":"11 February 2025","externalUrl":null,"permalink":"/tags/c/","section":"Tags","summary":"","title":"C","type":"tags"},{"content":"","date":"11 February 2025","externalUrl":null,"permalink":"/categories/c/","section":"Categories","summary":"","title":"C","type":"categories"},{"content":"\r🚀 ROS2 Launch 檔案建立 #\r1. Launch 檔案簡介 #\rLaunch 檔案允許您同時啟動多個 ROS2 節點，簡化了操作流程。\n2. 基本結構 #\r2.1 檔案位置 #\ryour_package/ ├── launch/ │ └── multi_turtles.launch.py └── setup.py 2.2 基本範例 #\r# 導入必要的套件 import launch # 導入 launch 核心功能 import launch_ros # 導入 ROS2 相關的 launch 功能 def generate_launch_description(): # 創建第一個烏龜節點 action_node_turtle0 = launch_ros.actions.Node( package=\u0026#39;turtlesim\u0026#39;, # 套件名稱 executable=\u0026#39;turtlesim_node\u0026#39;, # 可執行檔名稱 output=\u0026#39;both\u0026#39;, # 輸出方式：同時輸出到終端和日誌 ) # 創建第二個烏龜節點 action_node_turtle1 = launch_ros.actions.Node( package=\u0026#39;turtlesim\u0026#39;, # 套件名稱 executable=\u0026#39;turtlesim_node\u0026#39;, # 可執行檔名稱 output=\u0026#39;both\u0026#39;, # 輸出方式：同時輸出到終端和日誌 ) # 創建第三個烏龜節點 action_node_turtle2 = launch_ros.actions.Node( package=\u0026#39;turtlesim\u0026#39;, # 套件名稱 executable=\u0026#39;turtlesim_node\u0026#39;, # 可執行檔名稱 output=\u0026#39;both\u0026#39;, # 輸出方式：同時輸出到終端和日誌 ) # 創建 launch 描述對象，包含所有節點 launch_description = launch.LaunchDescription([ action_node_turtle0, # 添加第一個烏龜節點 action_node_turtle1, # 添加第二個烏龜節點 action_node_turtle2, # 添加第三個烏龜節點 ]) # 返回 launch 描述對象 return launch_description 2.3 CMakeLists.txt 配置 #\r主要配置包括：\n專案名稱和版本要求 依賴套件配置 可執行檔編譯設定 安裝路徑配置 特別注意以下安裝配置：\n# 安裝可執行檔 install(TARGETS service_parameters_node client_parameters_node DESTINATION lib/${PROJECT_NAME} ) # 安裝啟動文件 install(DIRECTORY launch DESTINATION share/${PROJECT_NAME} ) # 完成 ament 套件配置 ament_package() 這些配置確保了：\n可執行檔被正確安裝到指定目錄 啟動文件（launch files）被安裝到共享目錄 套件配置正確完成 3. 參數說明 #\r3.1 Node 參數 #\rpackage: 套件名稱 executable: 可執行檔名稱 output: 輸出方式（\u0026lsquo;screen\u0026rsquo;, \u0026rsquo;log\u0026rsquo;, \u0026lsquo;both\u0026rsquo;） name: 節點名稱（可選） namespace: 命名空間（可選） 3.2 常用配置 #\r# 設定節點名稱和命名空間 Node( package=\u0026#39;turtlesim\u0026#39;, # 套件名稱 executable=\u0026#39;turtlesim_node\u0026#39;, # 可執行檔名稱 name=\u0026#39;turtle1\u0026#39;, # 節點名稱 namespace=\u0026#39;group1\u0026#39; # 命名空間 ) # 添加參數配置 Node( package=\u0026#39;turtlesim\u0026#39;, # 套件名稱 executable=\u0026#39;turtlesim_node\u0026#39;, # 可執行檔名稱 parameters=[{\u0026#39;background_r\u0026#39;: 255}, {\u0026#39;background_g\u0026#39;: 150}, {\u0026#39;background_b\u0026#39;: 50}] # 設定背景顏色參數 ) 4. 使用方法 #\r4.1 執行 Launch 檔案 #\r# 編譯專案 colcon build # 執行 launch 檔案 ros2 launch your_package multi_turtles.launch.py 5. 進階功能 #\r5.1 條件式啟動 #\r# 導入必要的條件和配置類別 from launch.conditions import IfCondition from launch.substitutions import LaunchConfiguration # 根據條件啟動節點 Node( package=\u0026#39;turtlesim\u0026#39;, # 套件名稱 executable=\u0026#39;turtlesim_node\u0026#39;, # 可執行檔名稱 condition=IfCondition(LaunchConfiguration(\u0026#39;start_turtle\u0026#39;)) # 條件判斷 ) 5.2 群組管理 #\r# 導入必要的類別 from launch import LaunchDescription from launch_ros.actions import Node from launch.actions import GroupAction # 創建節點群組 group = GroupAction([ Node(package=\u0026#39;turtlesim\u0026#39;, executable=\u0026#39;turtlesim_node\u0026#39;), # 烏龜模擬器節點 Node(package=\u0026#39;turtlesim\u0026#39;, executable=\u0026#39;turtle_teleop_key\u0026#39;) # 鍵盤控制節點 ]) 💡 提示：\n使用 ros2 launch --show 查看 launch 檔案的配置 可以在 launch 檔案中包含其他 launch 檔案 善用命名空間避免節點名稱衝突 ","date":"11 February 2025","externalUrl":null,"permalink":"/posts/ros2_launch_file_create/","section":"Posts","summary":"\u003ch1 class=\"relative group\"\u003e🚀 ROS2 Launch 檔案建立 \r\n    \u003cdiv id=\"-ros2-launch-%E6%AA%94%E6%A1%88%E5%BB%BA%E7%AB%8B\" class=\"anchor\"\u003e\u003c/div\u003e\r\n    \r\n    \u003cspan\r\n        class=\"absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100\"\u003e\r\n        \u003ca class=\"group-hover:text-primary-300 dark:group-hover:text-neutral-700\"\r\n            style=\"text-decoration-line: none !important;\" href=\"#-ros2-launch-%E6%AA%94%E6%A1%88%E5%BB%BA%E7%AB%8B\" aria-label=\"Anchor\"\u003e#\u003c/a\u003e\r\n    \u003c/span\u003e        \r\n    \r\n\u003c/h1\u003e\r\n\r\n\r\n\u003ch2 class=\"relative group\"\u003e1. Launch 檔案簡介 \r\n    \u003cdiv id=\"1-launch-%E6%AA%94%E6%A1%88%E7%B0%A1%E4%BB%8B\" class=\"anchor\"\u003e\u003c/div\u003e\r\n    \r\n    \u003cspan\r\n        class=\"absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100\"\u003e\r\n        \u003ca class=\"group-hover:text-primary-300 dark:group-hover:text-neutral-700\"\r\n            style=\"text-decoration-line: none !important;\" href=\"#1-launch-%E6%AA%94%E6%A1%88%E7%B0%A1%E4%BB%8B\" aria-label=\"Anchor\"\u003e#\u003c/a\u003e\r\n    \u003c/span\u003e        \r\n    \r\n\u003c/h2\u003e\r\n\u003cp\u003eLaunch 檔案允許您同時啟動多個 ROS2 節點，簡化了操作流程。\u003c/p\u003e","title":"🚀 ROS2 Launch 檔案建立","type":"posts"},{"content":"","date":"11 February 2025","externalUrl":null,"permalink":"/tags/launch/","section":"Tags","summary":"","title":"Launch","type":"tags"},{"content":"\r🔍 ROS2 GDB 除錯方法 #\r1. 設定 CMake 除錯模式 #\r在 CMakeLists.txt 中添加以下設定：\nSET(CMAKE_BUILD_TYPE \u0026#34;Debug\u0026#34;) SET(CMAKE_CXX_FLAGS_DEBUG \u0026#34;$ENV{CXXFLAGS} -O0 -Wall -g -ggdb\u0026#34;) SET(CMAKE_CXX_FLAGS_RELEASE \u0026#34;$ENV{CXXFLAGS} -O3 -Wall\u0026#34;) 設定說明 #\rCMAKE_BUILD_TYPE \u0026quot;Debug\u0026quot;: 設定為除錯模式 -O0: 關閉編譯優化，方便除錯 -Wall: 開啟所有警告訊息 -g -ggdb: 生成除錯資訊 2. 使用 GDB 除錯 #\r2.1 啟動 GDB #\r# 切換到套件目錄 cd path/to/your_package # 啟動 GDB gdb your_package 2.2 開始除錯 #\r在 GDB 提示符下輸入：\n# 執行程式 (gdb) r 3. 常用 GDB 指令 #\r基本控制 #\rr (run): 執行程式 c (continue): 繼續執行 n (next): 下一步 s (step): 進入函式 q (quit): 退出 GDB 💡 提示：\n確保先編譯專案再進行除錯 可以使用 bt 查看呼叫堆疊 使用 help 獲取更多 GDB 指令說明 ","date":"11 February 2025","externalUrl":null,"permalink":"/posts/ros2_gdb_debug/","section":"Posts","summary":"\u003ch1 class=\"relative group\"\u003e🔍 ROS2 GDB 除錯方法 \r\n    \u003cdiv id=\"-ros2-gdb-%E9%99%A4%E9%8C%AF%E6%96%B9%E6%B3%95\" class=\"anchor\"\u003e\u003c/div\u003e\r\n    \r\n    \u003cspan\r\n        class=\"absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100\"\u003e\r\n        \u003ca class=\"group-hover:text-primary-300 dark:group-hover:text-neutral-700\"\r\n            style=\"text-decoration-line: none !important;\" href=\"#-ros2-gdb-%E9%99%A4%E9%8C%AF%E6%96%B9%E6%B3%95\" aria-label=\"Anchor\"\u003e#\u003c/a\u003e\r\n    \u003c/span\u003e        \r\n    \r\n\u003c/h1\u003e\r\n\r\n\r\n\u003ch2 class=\"relative group\"\u003e1. 設定 CMake 除錯模式 \r\n    \u003cdiv id=\"1-%E8%A8%AD%E5%AE%9A-cmake-%E9%99%A4%E9%8C%AF%E6%A8%A1%E5%BC%8F\" class=\"anchor\"\u003e\u003c/div\u003e\r\n    \r\n    \u003cspan\r\n        class=\"absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100\"\u003e\r\n        \u003ca class=\"group-hover:text-primary-300 dark:group-hover:text-neutral-700\"\r\n            style=\"text-decoration-line: none !important;\" href=\"#1-%E8%A8%AD%E5%AE%9A-cmake-%E9%99%A4%E9%8C%AF%E6%A8%A1%E5%BC%8F\" aria-label=\"Anchor\"\u003e#\u003c/a\u003e\r\n    \u003c/span\u003e        \r\n    \r\n\u003c/h2\u003e\r\n\u003cp\u003e在 \u003ccode\u003eCMakeLists.txt\u003c/code\u003e 中添加以下設定：\u003c/p\u003e","title":"🔍 ROS2 GDB 除錯方法 ","type":"posts"},{"content":"","date":"11 February 2025","externalUrl":null,"permalink":"/tags/gdb/","section":"Tags","summary":"","title":"GDB","type":"tags"},{"content":"\r🤖 ROS2 創建節點 #\r1. 建立工作空間 #\rmkdir -p ~/ros2_ws/src cd ~/ros2_ws/src 2. 創建套件 #\rros2 pkg create --build-type ament_cmake hello_pkg 3. 編寫節點程式碼 #\r建立 C++ 源文件 #\r在 ~/ros2_ws/src/hello_pkg/src 目錄下創建 hello_node.cpp：\n#include \u0026#34;rclcpp/rclcpp.hpp\u0026#34; #include \u0026lt;chrono\u0026gt; class HelloNode : public rclcpp::Node { public: HelloNode() : Node(\u0026#34;hello_node\u0026#34;) { timer_ = this-\u0026gt;create_wall_timer( std::chrono::seconds(1), std::bind(\u0026amp;HelloNode::hello, this) ); } private: void hello() { RCLCPP_INFO(this-\u0026gt;get_logger(), \u0026#34;hello world\u0026#34;); } rclcpp::TimerBase::SharedPtr timer_; }; int main(int argc, char **argv) { rclcpp::init(argc, argv); auto node = std::make_shared\u0026lt;HelloNode\u0026gt;(); rclcpp::spin(node); rclcpp::shutdown(); return 0; } 程式碼說明 #\rHelloNode 類繼承自 rclcpp::Node 建構函式中創建一個計時器，每秒執行一次 hello() 函式輸出 \u0026ldquo;hello world\u0026rdquo; 訊息 main() 函式初始化 ROS2 並運行節點 4. 修改 CMakeLists.txt #\r在 ~/ros2_ws/src/hello_pkg/CMakeLists.txt 加入：\ncmake_minimum_required(VERSION 3.8) project(hello_pkg) # 設定 C++ 標準 if(NOT CMAKE_CXX_STANDARD) set(CMAKE_CXX_STANDARD 14) endif() # 尋找相依套件 find_package(ament_cmake REQUIRED) find_package(rclcpp REQUIRED) # 添加可執行文件 add_executable(hello_node src/hello_node.cpp) ament_target_dependencies(hello_node rclcpp) # 安裝設定 install(TARGETS hello_node DESTINATION lib/${PROJECT_NAME} ) ament_package() 5. 編譯與執行 #\r編譯套件 #\rcd ~/ros2_ws colcon build --packages-select hello_pkg 設定環境變數 #\rsource ~/ros2_ws/install/setup.bash 執行節點 #\rros2 run hello_pkg hello_node 程式執行結果 #\r你將看到每秒輸出一次：\n[INFO] [hello_node]: hello world 常見問題解決 #\r編譯錯誤\n檢查 CMakeLists.txt 設定 確認所有相依套件已安裝 執行錯誤\n確認環境變數已正確設定 檢查節點名稱是否正確 進階主題 #\r使用參數 發布/訂閱話題 服務客戶端/伺服器 自定義訊息類型 💡 提示：\n使用 ros2 node list 查看運行中的節點 使用 ros2 node info /hello_node 查看節點資訊 善用 rclcpp 的日誌功能進行除錯 ","date":"10 February 2025","externalUrl":null,"permalink":"/posts/create_ros_node/","section":"Posts","summary":"\u003ch1 class=\"relative group\"\u003e🤖 ROS2 創建節點 \r\n    \u003cdiv id=\"-ros2-%E5%89%B5%E5%BB%BA%E7%AF%80%E9%BB%9E\" class=\"anchor\"\u003e\u003c/div\u003e\r\n    \r\n    \u003cspan\r\n        class=\"absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100\"\u003e\r\n        \u003ca class=\"group-hover:text-primary-300 dark:group-hover:text-neutral-700\"\r\n            style=\"text-decoration-line: none !important;\" href=\"#-ros2-%E5%89%B5%E5%BB%BA%E7%AF%80%E9%BB%9E\" aria-label=\"Anchor\"\u003e#\u003c/a\u003e\r\n    \u003c/span\u003e        \r\n    \r\n\u003c/h1\u003e\r\n\r\n\r\n\u003ch2 class=\"relative group\"\u003e1. 建立工作空間 \r\n    \u003cdiv id=\"1-%E5%BB%BA%E7%AB%8B%E5%B7%A5%E4%BD%9C%E7%A9%BA%E9%96%93\" class=\"anchor\"\u003e\u003c/div\u003e\r\n    \r\n    \u003cspan\r\n        class=\"absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100\"\u003e\r\n        \u003ca class=\"group-hover:text-primary-300 dark:group-hover:text-neutral-700\"\r\n            style=\"text-decoration-line: none !important;\" href=\"#1-%E5%BB%BA%E7%AB%8B%E5%B7%A5%E4%BD%9C%E7%A9%BA%E9%96%93\" aria-label=\"Anchor\"\u003e#\u003c/a\u003e\r\n    \u003c/span\u003e        \r\n    \r\n\u003c/h2\u003e\r\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003emkdir -p ~/ros2_ws/src\n\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003e\u003cspan class=\"nb\"\u003ecd\u003c/span\u003e ~/ros2_ws/src\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n\r\n\u003ch2 class=\"relative group\"\u003e2. 創建套件 \r\n    \u003cdiv id=\"2-%E5%89%B5%E5%BB%BA%E5%A5%97%E4%BB%B6\" class=\"anchor\"\u003e\u003c/div\u003e\r\n    \r\n    \u003cspan\r\n        class=\"absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100\"\u003e\r\n        \u003ca class=\"group-hover:text-primary-300 dark:group-hover:text-neutral-700\"\r\n            style=\"text-decoration-line: none !important;\" href=\"#2-%E5%89%B5%E5%BB%BA%E5%A5%97%E4%BB%B6\" aria-label=\"Anchor\"\u003e#\u003c/a\u003e\r\n    \u003c/span\u003e        \r\n    \r\n\u003c/h2\u003e\r\n\u003cdiv class=\"highlight\"\u003e\u003cpre tabindex=\"0\" class=\"chroma\"\u003e\u003ccode class=\"language-bash\" data-lang=\"bash\"\u003e\u003cspan class=\"line\"\u003e\u003cspan class=\"cl\"\u003eros2 pkg create --build-type ament_cmake hello_pkg\n\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\r\n\r\n\u003ch2 class=\"relative group\"\u003e3. 編寫節點程式碼 \r\n    \u003cdiv id=\"3-%E7%B7%A8%E5%AF%AB%E7%AF%80%E9%BB%9E%E7%A8%8B%E5%BC%8F%E7%A2%BC\" class=\"anchor\"\u003e\u003c/div\u003e\r\n    \r\n    \u003cspan\r\n        class=\"absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100\"\u003e\r\n        \u003ca class=\"group-hover:text-primary-300 dark:group-hover:text-neutral-700\"\r\n            style=\"text-decoration-line: none !important;\" href=\"#3-%E7%B7%A8%E5%AF%AB%E7%AF%80%E9%BB%9E%E7%A8%8B%E5%BC%8F%E7%A2%BC\" aria-label=\"Anchor\"\u003e#\u003c/a\u003e\r\n    \u003c/span\u003e        \r\n    \r\n\u003c/h2\u003e\r\n\r\n\r\n\u003ch3 class=\"relative group\"\u003e建立 C++ 源文件 \r\n    \u003cdiv id=\"%E5%BB%BA%E7%AB%8B-c-%E6%BA%90%E6%96%87%E4%BB%B6\" class=\"anchor\"\u003e\u003c/div\u003e\r\n    \r\n    \u003cspan\r\n        class=\"absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100\"\u003e\r\n        \u003ca class=\"group-hover:text-primary-300 dark:group-hover:text-neutral-700\"\r\n            style=\"text-decoration-line: none !important;\" href=\"#%E5%BB%BA%E7%AB%8B-c-%E6%BA%90%E6%96%87%E4%BB%B6\" aria-label=\"Anchor\"\u003e#\u003c/a\u003e\r\n    \u003c/span\u003e        \r\n    \r\n\u003c/h3\u003e\r\n\u003cp\u003e在 \u003ccode\u003e~/ros2_ws/src/hello_pkg/src\u003c/code\u003e 目錄下創建 \u003ccode\u003ehello_node.cpp\u003c/code\u003e：\u003c/p\u003e","title":"🤖 ROS2 創建節點","type":"posts"},{"content":"\r🐢 ROS2 啟動小海龜 #\r1. 安裝 ROS2 Humble #\r安裝步驟 #\r首先請依照官方文件安裝 ROS2 Humble： ROS2 Humble / Ubuntu (deb packages)\n設定環境變數：\nsource /opt/ros/humble/setup.bash 💡 建議將此命令加入 ~/.bashrc：\necho \u0026#34;source /opt/ros/humble/setup.bash\u0026#34; \u0026gt;\u0026gt; ~/.bashrc 2. 啟動小海龜模擬器 #\r執行模擬器 #\r在終端機輸入以下指令：\nros2 run turtlesim turtlesim_node 指令說明 #\rros2 run：使用 ros2 運行程序 turtlesim：程序包的名稱 turtlesim_node：可執行文件名稱 3. 控制小海龜 #\r啟動控制程序 #\r開啟新的終端機 執行 source 指令： source /opt/ros/humble/setup.bash 輸入以下指令啟動鍵盤控制： ros2 run turtlesim turtle_teleop_key 控制說明 #\r使用方向鍵控制海龜移動 Up：向前移動 Down：向後移動 Left：向左轉 Right：向右轉 常見問題與解決方案 #\r1. 找不到 ROS2 命令 #\r解決方案：\n確認 ROS2 安裝是否成功 檢查環境變數是否正確設定 重新 source 環境設定檔 2. 無法啟動小海龜 #\r解決方案：\n確認 turtlesim 套件是否安裝 檢查系統資源使用狀況 查看錯誤訊息 相關資源 #\rROS2 官方文件 Turtlesim 教學 ROS2 指令參考 🔔 注意事項：\n每次開啟新終端機都需要重新 source 環境變數 確保系統符合 ROS2 的最低需求 建議使用 Ubuntu 22.04 LTS ","date":"10 February 2025","externalUrl":null,"permalink":"/posts/turtle_launch/","section":"Posts","summary":"\u003ch1 class=\"relative group\"\u003e🐢 ROS2 啟動小海龜 \r\n    \u003cdiv id=\"-ros2-%E5%95%9F%E5%8B%95%E5%B0%8F%E6%B5%B7%E9%BE%9C\" class=\"anchor\"\u003e\u003c/div\u003e\r\n    \r\n    \u003cspan\r\n        class=\"absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100\"\u003e\r\n        \u003ca class=\"group-hover:text-primary-300 dark:group-hover:text-neutral-700\"\r\n            style=\"text-decoration-line: none !important;\" href=\"#-ros2-%E5%95%9F%E5%8B%95%E5%B0%8F%E6%B5%B7%E9%BE%9C\" aria-label=\"Anchor\"\u003e#\u003c/a\u003e\r\n    \u003c/span\u003e        \r\n    \r\n\u003c/h1\u003e\r\n\r\n\r\n\u003ch2 class=\"relative group\"\u003e1. 安裝 ROS2 Humble \r\n    \u003cdiv id=\"1-%E5%AE%89%E8%A3%9D-ros2-humble\" class=\"anchor\"\u003e\u003c/div\u003e\r\n    \r\n    \u003cspan\r\n        class=\"absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100\"\u003e\r\n        \u003ca class=\"group-hover:text-primary-300 dark:group-hover:text-neutral-700\"\r\n            style=\"text-decoration-line: none !important;\" href=\"#1-%E5%AE%89%E8%A3%9D-ros2-humble\" aria-label=\"Anchor\"\u003e#\u003c/a\u003e\r\n    \u003c/span\u003e        \r\n    \r\n\u003c/h2\u003e\r\n\r\n\r\n\u003ch3 class=\"relative group\"\u003e安裝步驟 \r\n    \u003cdiv id=\"%E5%AE%89%E8%A3%9D%E6%AD%A5%E9%A9%9F\" class=\"anchor\"\u003e\u003c/div\u003e\r\n    \r\n    \u003cspan\r\n        class=\"absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100\"\u003e\r\n        \u003ca class=\"group-hover:text-primary-300 dark:group-hover:text-neutral-700\"\r\n            style=\"text-decoration-line: none !important;\" href=\"#%E5%AE%89%E8%A3%9D%E6%AD%A5%E9%A9%9F\" aria-label=\"Anchor\"\u003e#\u003c/a\u003e\r\n    \u003c/span\u003e        \r\n    \r\n\u003c/h3\u003e\r\n\u003col\u003e\n\u003cli\u003e\n\u003cp\u003e首先請依照官方文件安裝 ROS2 Humble：\n\u003ca href=\"https://docs.ros.org/en/humble/Installation/Ubuntu-Install-Debs.html\"title=\"前往humble安裝流程\" target=\"_blank\"\u003eROS2 Humble / Ubuntu (deb packages)\u003c/a\u003e\u003c/p\u003e","title":"🐢 ROS2 啟動小海龜","type":"posts"},{"content":"👨‍💻 工程師一個，對 FPGA/SoC FPGA/Verilog/C++/C/ROS 都有興趣 👨‍💻 An engineer with interests in FPGA/SoC FPGA/Verilog/C++/C/ROS\n這個世界有太多值得學習項目，因為學不完了所以這裡記錄我學習過的痕跡，忘記就來這裡看看。\n📝 記錄日常學習心得\n❓ 問題解決紀錄\n📈 學習成果追蹤\n📂 資源整理\n🔍 知識庫存\n","date":"10 February 2025","externalUrl":null,"permalink":"/about/","section":"TienYao@Tech","summary":"\u003cp\u003e👨‍💻 工程師一個，對 FPGA/SoC FPGA/Verilog/C++/C/ROS 都有興趣\n👨‍💻 An engineer with interests in FPGA/SoC FPGA/Verilog/C++/C/ROS\u003c/p\u003e\n\u003cp\u003e這個世界有太多值得學習項目，因為學不完了所以這裡記錄我學習過的痕跡，忘記就來這裡看看。\u003c/p\u003e","title":"About","type":"page"},{"content":"","externalUrl":null,"permalink":"/series/","section":"Series","summary":"","title":"Series","type":"series"},{"content":"","externalUrl":null,"permalink":"/tienyao/","section":"Tienyao","summary":"","title":"Tienyao","type":"tienyao"}]